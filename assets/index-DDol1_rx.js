(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();function kc(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const Ve={},ui=[],un=()=>{},bf=()=>!1,va=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Ac=t=>t.startsWith("onUpdate:"),ot=Object.assign,xc=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Xw=Object.prototype.hasOwnProperty,Oe=(t,e)=>Xw.call(t,e),he=Array.isArray,di=t=>Mr(t)==="[object Map]",_a=t=>Mr(t)==="[object Set]",id=t=>Mr(t)==="[object Date]",be=t=>typeof t=="function",Je=t=>typeof t=="string",mn=t=>typeof t=="symbol",Ue=t=>t!==null&&typeof t=="object",Cf=t=>(Ue(t)||be(t))&&be(t.then)&&be(t.catch),Ef=Object.prototype.toString,Mr=t=>Ef.call(t),Jw=t=>Mr(t).slice(8,-1),Sf=t=>Mr(t)==="[object Object]",ya=t=>Je(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,tr=kc(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ba=t=>{const e=Object.create(null);return(n=>e[n]||(e[n]=t(n)))},Zw=/-\w/g,us=ba(t=>t.replace(Zw,e=>e.slice(1).toUpperCase())),ev=/\B([A-Z])/g,ys=ba(t=>t.replace(ev,"-$1").toLowerCase()),If=ba(t=>t.charAt(0).toUpperCase()+t.slice(1)),cl=ba(t=>t?`on${If(t)}`:""),ts=(t,e)=>!Object.is(t,e),wo=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},Tf=(t,e,n,s=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:s,value:n})},Ca=t=>{const e=parseFloat(t);return isNaN(e)?t:e},tv=t=>{const e=Je(t)?Number(t):NaN;return isNaN(e)?t:e};let rd;const Ea=()=>rd||(rd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function dn(t){if(he(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],i=Je(s)?rv(s):dn(s);if(i)for(const r in i)e[r]=i[r]}return e}else if(Je(t)||Ue(t))return t}const nv=/;(?![^(]*\))/g,sv=/:([^]+)/,iv=/\/\*[^]*?\*\//g;function rv(t){const e={};return t.replace(iv,"").split(nv).forEach(n=>{if(n){const s=n.split(sv);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function _e(t){let e="";if(Je(t))e=t;else if(he(t))for(let n=0;n<t.length;n++){const s=_e(t[n]);s&&(e+=s+" ")}else if(Ue(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const ov="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",av=kc(ov);function kf(t){return!!t||t===""}function lv(t,e){if(t.length!==e.length)return!1;let n=!0;for(let s=0;n&&s<t.length;s++)n=Sa(t[s],e[s]);return n}function Sa(t,e){if(t===e)return!0;let n=id(t),s=id(e);if(n||s)return n&&s?t.getTime()===e.getTime():!1;if(n=mn(t),s=mn(e),n||s)return t===e;if(n=he(t),s=he(e),n||s)return n&&s?lv(t,e):!1;if(n=Ue(t),s=Ue(e),n||s){if(!n||!s)return!1;const i=Object.keys(t).length,r=Object.keys(e).length;if(i!==r)return!1;for(const o in t){const a=t.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!Sa(t[o],e[o]))return!1}}return String(t)===String(e)}function cv(t,e){return t.findIndex(n=>Sa(n,e))}const Af=t=>!!(t&&t.__v_isRef===!0),ne=t=>Je(t)?t:t==null?"":he(t)||Ue(t)&&(t.toString===Ef||!be(t.toString))?Af(t)?ne(t.value):JSON.stringify(t,xf,2):String(t),xf=(t,e)=>Af(e)?xf(t,e.value):di(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[s,i],r)=>(n[ul(s,r)+" =>"]=i,n),{})}:_a(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>ul(n))}:mn(e)?ul(e):Ue(e)&&!he(e)&&!Sf(e)?String(e):e,ul=(t,e="")=>{var n;return mn(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};let ht;class Pf{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=ht,!e&&ht&&(this.index=(ht.scopes||(ht.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=ht;try{return ht=this,e()}finally{ht=n}}}on(){++this._on===1&&(this.prevScope=ht,ht=this)}off(){this._on>0&&--this._on===0&&(ht=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(this.effects.length=0,n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function Rf(t){return new Pf(t)}function Nf(){return ht}function uv(t,e=!1){ht&&ht.cleanups.push(t)}let je;const dl=new WeakSet;class Of{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,ht&&ht.active&&ht.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,dl.has(this)&&(dl.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Mf(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,od(this),Lf(this);const e=je,n=Qt;je=this,Qt=!0;try{return this.fn()}finally{$f(this),je=e,Qt=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Nc(e);this.deps=this.depsTail=void 0,od(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?dl.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Bl(this)&&this.run()}get dirty(){return Bl(this)}}let Df=0,nr,sr;function Mf(t,e=!1){if(t.flags|=8,e){t.next=sr,sr=t;return}t.next=nr,nr=t}function Pc(){Df++}function Rc(){if(--Df>0)return;if(sr){let e=sr;for(sr=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;nr;){let e=nr;for(nr=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(s){t||(t=s)}e=n}}if(t)throw t}function Lf(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function $f(t){let e,n=t.depsTail,s=n;for(;s;){const i=s.prevDep;s.version===-1?(s===n&&(n=i),Nc(s),dv(s)):e=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=i}t.deps=e,t.depsTail=n}function Bl(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(Ff(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function Ff(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===wr)||(t.globalVersion=wr,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!Bl(t))))return;t.flags|=2;const e=t.dep,n=je,s=Qt;je=t,Qt=!0;try{Lf(t);const i=t.fn(t._value);(e.version===0||ts(i,t._value))&&(t.flags|=128,t._value=i,e.version++)}catch(i){throw e.version++,i}finally{je=n,Qt=s,$f(t),t.flags&=-3}}function Nc(t,e=!1){const{dep:n,prevSub:s,nextSub:i}=t;if(s&&(s.nextSub=i,t.prevSub=void 0),i&&(i.prevSub=s,t.nextSub=void 0),n.subs===t&&(n.subs=s,!s&&n.computed)){n.computed.flags&=-5;for(let r=n.computed.deps;r;r=r.nextDep)Nc(r,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function dv(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let Qt=!0;const Bf=[];function Pn(){Bf.push(Qt),Qt=!1}function Rn(){const t=Bf.pop();Qt=t===void 0?!0:t}function od(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=je;je=void 0;try{e()}finally{je=n}}}let wr=0;class hv{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Oc{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!je||!Qt||je===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==je)n=this.activeLink=new hv(je,this),je.deps?(n.prevDep=je.depsTail,je.depsTail.nextDep=n,je.depsTail=n):je.deps=je.depsTail=n,Uf(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const s=n.nextDep;s.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=s),n.prevDep=je.depsTail,n.nextDep=void 0,je.depsTail.nextDep=n,je.depsTail=n,je.deps===n&&(je.deps=s)}return n}trigger(e){this.version++,wr++,this.notify(e)}notify(e){Pc();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{Rc()}}}function Uf(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let s=e.deps;s;s=s.nextDep)Uf(s)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const ko=new WeakMap,Ds=Symbol(""),Ul=Symbol(""),vr=Symbol("");function ft(t,e,n){if(Qt&&je){let s=ko.get(t);s||ko.set(t,s=new Map);let i=s.get(n);i||(s.set(n,i=new Oc),i.map=s,i.key=n),i.track()}}function bn(t,e,n,s,i,r){const o=ko.get(t);if(!o){wr++;return}const a=l=>{l&&l.trigger()};if(Pc(),e==="clear")o.forEach(a);else{const l=he(t),c=l&&ya(n);if(l&&n==="length"){const u=Number(s);o.forEach((d,h)=>{(h==="length"||h===vr||!mn(h)&&h>=u)&&a(d)})}else switch((n!==void 0||o.has(void 0))&&a(o.get(n)),c&&a(o.get(vr)),e){case"add":l?c&&a(o.get("length")):(a(o.get(Ds)),di(t)&&a(o.get(Ul)));break;case"delete":l||(a(o.get(Ds)),di(t)&&a(o.get(Ul)));break;case"set":di(t)&&a(o.get(Ds));break}}Rc()}function fv(t,e){const n=ko.get(t);return n&&n.get(e)}function ni(t){const e=Te(t);return e===t?e:(ft(e,"iterate",vr),Nt(t)?e:e.map(Zt))}function Ia(t){return ft(t=Te(t),"iterate",vr),t}function Hn(t,e){return Nn(t)?Tn(t)?Ci(Zt(e)):Ci(e):Zt(e)}const pv={__proto__:null,[Symbol.iterator](){return hl(this,Symbol.iterator,t=>Hn(this,t))},concat(...t){return ni(this).concat(...t.map(e=>he(e)?ni(e):e))},entries(){return hl(this,"entries",t=>(t[1]=Hn(this,t[1]),t))},every(t,e){return vn(this,"every",t,e,void 0,arguments)},filter(t,e){return vn(this,"filter",t,e,n=>n.map(s=>Hn(this,s)),arguments)},find(t,e){return vn(this,"find",t,e,n=>Hn(this,n),arguments)},findIndex(t,e){return vn(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return vn(this,"findLast",t,e,n=>Hn(this,n),arguments)},findLastIndex(t,e){return vn(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return vn(this,"forEach",t,e,void 0,arguments)},includes(...t){return fl(this,"includes",t)},indexOf(...t){return fl(this,"indexOf",t)},join(t){return ni(this).join(t)},lastIndexOf(...t){return fl(this,"lastIndexOf",t)},map(t,e){return vn(this,"map",t,e,void 0,arguments)},pop(){return Gi(this,"pop")},push(...t){return Gi(this,"push",t)},reduce(t,...e){return ad(this,"reduce",t,e)},reduceRight(t,...e){return ad(this,"reduceRight",t,e)},shift(){return Gi(this,"shift")},some(t,e){return vn(this,"some",t,e,void 0,arguments)},splice(...t){return Gi(this,"splice",t)},toReversed(){return ni(this).toReversed()},toSorted(t){return ni(this).toSorted(t)},toSpliced(...t){return ni(this).toSpliced(...t)},unshift(...t){return Gi(this,"unshift",t)},values(){return hl(this,"values",t=>Hn(this,t))}};function hl(t,e,n){const s=Ia(t),i=s[e]();return s!==t&&!Nt(t)&&(i._next=i.next,i.next=()=>{const r=i._next();return r.done||(r.value=n(r.value)),r}),i}const mv=Array.prototype;function vn(t,e,n,s,i,r){const o=Ia(t),a=o!==t&&!Nt(t),l=o[e];if(l!==mv[e]){const d=l.apply(t,r);return a?Zt(d):d}let c=n;o!==t&&(a?c=function(d,h){return n.call(this,Hn(t,d),h,t)}:n.length>2&&(c=function(d,h){return n.call(this,d,h,t)}));const u=l.call(o,c,s);return a&&i?i(u):u}function ad(t,e,n,s){const i=Ia(t);let r=n;return i!==t&&(Nt(t)?n.length>3&&(r=function(o,a,l){return n.call(this,o,a,l,t)}):r=function(o,a,l){return n.call(this,o,Hn(t,a),l,t)}),i[e](r,...s)}function fl(t,e,n){const s=Te(t);ft(s,"iterate",vr);const i=s[e](...n);return(i===-1||i===!1)&&Ta(n[0])?(n[0]=Te(n[0]),s[e](...n)):i}function Gi(t,e,n=[]){Pn(),Pc();const s=Te(t)[e].apply(t,n);return Rc(),Rn(),s}const gv=kc("__proto__,__v_isRef,__isVue"),Vf=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(mn));function wv(t){mn(t)||(t=String(t));const e=Te(this);return ft(e,"has",t),e.hasOwnProperty(t)}class Hf{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,s){if(n==="__v_skip")return e.__v_skip;const i=this._isReadonly,r=this._isShallow;if(n==="__v_isReactive")return!i;if(n==="__v_isReadonly")return i;if(n==="__v_isShallow")return r;if(n==="__v_raw")return s===(i?r?kv:qf:r?zf:jf).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(s)?e:void 0;const o=he(e);if(!i){let l;if(o&&(l=pv[n]))return l;if(n==="hasOwnProperty")return wv}const a=Reflect.get(e,n,Xe(e)?e:s);if((mn(n)?Vf.has(n):gv(n))||(i||ft(e,"get",n),r))return a;if(Xe(a)){const l=o&&ya(n)?a:a.value;return i&&Ue(l)?Hl(l):l}return Ue(a)?i?Hl(a):Lr(a):a}}class Wf extends Hf{constructor(e=!1){super(!1,e)}set(e,n,s,i){let r=e[n];const o=he(e)&&ya(n);if(!this._isShallow){const c=Nn(r);if(!Nt(s)&&!Nn(s)&&(r=Te(r),s=Te(s)),!o&&Xe(r)&&!Xe(s))return c||(r.value=s),!0}const a=o?Number(n)<e.length:Oe(e,n),l=Reflect.set(e,n,s,Xe(e)?e:i);return e===Te(i)&&(a?ts(s,r)&&bn(e,"set",n,s):bn(e,"add",n,s)),l}deleteProperty(e,n){const s=Oe(e,n);e[n];const i=Reflect.deleteProperty(e,n);return i&&s&&bn(e,"delete",n,void 0),i}has(e,n){const s=Reflect.has(e,n);return(!mn(n)||!Vf.has(n))&&ft(e,"has",n),s}ownKeys(e){return ft(e,"iterate",he(e)?"length":Ds),Reflect.ownKeys(e)}}class vv extends Hf{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const _v=new Wf,yv=new vv,bv=new Wf(!0);const Vl=t=>t,ro=t=>Reflect.getPrototypeOf(t);function Cv(t,e,n){return function(...s){const i=this.__v_raw,r=Te(i),o=di(r),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,c=i[t](...s),u=n?Vl:e?Ci:Zt;return!e&&ft(r,"iterate",l?Ul:Ds),{next(){const{value:d,done:h}=c.next();return h?{value:d,done:h}:{value:a?[u(d[0]),u(d[1])]:u(d),done:h}},[Symbol.iterator](){return this}}}}function oo(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Ev(t,e){const n={get(i){const r=this.__v_raw,o=Te(r),a=Te(i);t||(ts(i,a)&&ft(o,"get",i),ft(o,"get",a));const{has:l}=ro(o),c=e?Vl:t?Ci:Zt;if(l.call(o,i))return c(r.get(i));if(l.call(o,a))return c(r.get(a));r!==o&&r.get(i)},get size(){const i=this.__v_raw;return!t&&ft(Te(i),"iterate",Ds),i.size},has(i){const r=this.__v_raw,o=Te(r),a=Te(i);return t||(ts(i,a)&&ft(o,"has",i),ft(o,"has",a)),i===a?r.has(i):r.has(i)||r.has(a)},forEach(i,r){const o=this,a=o.__v_raw,l=Te(a),c=e?Vl:t?Ci:Zt;return!t&&ft(l,"iterate",Ds),a.forEach((u,d)=>i.call(r,c(u),c(d),o))}};return ot(n,t?{add:oo("add"),set:oo("set"),delete:oo("delete"),clear:oo("clear")}:{add(i){!e&&!Nt(i)&&!Nn(i)&&(i=Te(i));const r=Te(this);return ro(r).has.call(r,i)||(r.add(i),bn(r,"add",i,i)),this},set(i,r){!e&&!Nt(r)&&!Nn(r)&&(r=Te(r));const o=Te(this),{has:a,get:l}=ro(o);let c=a.call(o,i);c||(i=Te(i),c=a.call(o,i));const u=l.call(o,i);return o.set(i,r),c?ts(r,u)&&bn(o,"set",i,r):bn(o,"add",i,r),this},delete(i){const r=Te(this),{has:o,get:a}=ro(r);let l=o.call(r,i);l||(i=Te(i),l=o.call(r,i)),a&&a.call(r,i);const c=r.delete(i);return l&&bn(r,"delete",i,void 0),c},clear(){const i=Te(this),r=i.size!==0,o=i.clear();return r&&bn(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{n[i]=Cv(i,t,e)}),n}function Dc(t,e){const n=Ev(t,e);return(s,i,r)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?s:Reflect.get(Oe(n,i)&&i in s?n:s,i,r)}const Sv={get:Dc(!1,!1)},Iv={get:Dc(!1,!0)},Tv={get:Dc(!0,!1)};const jf=new WeakMap,zf=new WeakMap,qf=new WeakMap,kv=new WeakMap;function Av(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function xv(t){return t.__v_skip||!Object.isExtensible(t)?0:Av(Jw(t))}function Lr(t){return Nn(t)?t:Mc(t,!1,_v,Sv,jf)}function Pv(t){return Mc(t,!1,bv,Iv,zf)}function Hl(t){return Mc(t,!0,yv,Tv,qf)}function Mc(t,e,n,s,i){if(!Ue(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const r=xv(t);if(r===0)return t;const o=i.get(t);if(o)return o;const a=new Proxy(t,r===2?s:n);return i.set(t,a),a}function Tn(t){return Nn(t)?Tn(t.__v_raw):!!(t&&t.__v_isReactive)}function Nn(t){return!!(t&&t.__v_isReadonly)}function Nt(t){return!!(t&&t.__v_isShallow)}function Ta(t){return t?!!t.__v_raw:!1}function Te(t){const e=t&&t.__v_raw;return e?Te(e):t}function Lc(t){return!Oe(t,"__v_skip")&&Object.isExtensible(t)&&Tf(t,"__v_skip",!0),t}const Zt=t=>Ue(t)?Lr(t):t,Ci=t=>Ue(t)?Hl(t):t;function Xe(t){return t?t.__v_isRef===!0:!1}function j(t){return Rv(t,!1)}function Rv(t,e){return Xe(t)?t:new Nv(t,e)}class Nv{constructor(e,n){this.dep=new Oc,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:Te(e),this._value=n?e:Zt(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,s=this.__v_isShallow||Nt(e)||Nn(e);e=s?e:Te(e),ts(e,n)&&(this._rawValue=e,this._value=s?e:Zt(e),this.dep.trigger())}}function ie(t){return Xe(t)?t.value:t}const Ov={get:(t,e,n)=>e==="__v_raw"?t:ie(Reflect.get(t,e,n)),set:(t,e,n,s)=>{const i=t[e];return Xe(i)&&!Xe(n)?(i.value=n,!0):Reflect.set(t,e,n,s)}};function Kf(t){return Tn(t)?t:new Proxy(t,Ov)}function Dv(t){const e=he(t)?new Array(t.length):{};for(const n in t)e[n]=Lv(t,n);return e}class Mv{constructor(e,n,s){this._object=e,this._key=n,this._defaultValue=s,this.__v_isRef=!0,this._value=void 0,this._raw=Te(e);let i=!0,r=e;if(!he(e)||!ya(String(n)))do i=!Ta(r)||Nt(r);while(i&&(r=r.__v_raw));this._shallow=i}get value(){let e=this._object[this._key];return this._shallow&&(e=ie(e)),this._value=e===void 0?this._defaultValue:e}set value(e){if(this._shallow&&Xe(this._raw[this._key])){const n=this._object[this._key];if(Xe(n)){n.value=e;return}}this._object[this._key]=e}get dep(){return fv(this._raw,this._key)}}function Lv(t,e,n){return new Mv(t,e,n)}class $v{constructor(e,n,s){this.fn=e,this.setter=n,this._value=void 0,this.dep=new Oc(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=wr-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&je!==this)return Mf(this,!0),!0}get value(){const e=this.dep.track();return Ff(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Fv(t,e,n=!1){let s,i;return be(t)?s=t:(s=t.get,i=t.set),new $v(s,i,n)}const ao={},Ao=new WeakMap;let As;function Bv(t,e=!1,n=As){if(n){let s=Ao.get(n);s||Ao.set(n,s=[]),s.push(t)}}function Uv(t,e,n=Ve){const{immediate:s,deep:i,once:r,scheduler:o,augmentJob:a,call:l}=n,c=V=>i?V:Nt(V)||i===!1||i===0?Cn(V,1):Cn(V);let u,d,h,p,m=!1,w=!1;if(Xe(t)?(d=()=>t.value,m=Nt(t)):Tn(t)?(d=()=>c(t),m=!0):he(t)?(w=!0,m=t.some(V=>Tn(V)||Nt(V)),d=()=>t.map(V=>{if(Xe(V))return V.value;if(Tn(V))return c(V);if(be(V))return l?l(V,2):V()})):be(t)?e?d=l?()=>l(t,2):t:d=()=>{if(h){Pn();try{h()}finally{Rn()}}const V=As;As=u;try{return l?l(t,3,[p]):t(p)}finally{As=V}}:d=un,e&&i){const V=d,Z=i===!0?1/0:i;d=()=>Cn(V(),Z)}const C=Nf(),A=()=>{u.stop(),C&&C.active&&xc(C.effects,u)};if(r&&e){const V=e;e=(...Z)=>{V(...Z),A()}}let W=w?new Array(t.length).fill(ao):ao;const B=V=>{if(!(!(u.flags&1)||!u.dirty&&!V))if(e){const Z=u.run();if(i||m||(w?Z.some((re,z)=>ts(re,W[z])):ts(Z,W))){h&&h();const re=As;As=u;try{const z=[Z,W===ao?void 0:w&&W[0]===ao?[]:W,p];W=Z,l?l(e,3,z):e(...z)}finally{As=re}}}else u.run()};return a&&a(B),u=new Of(d),u.scheduler=o?()=>o(B,!1):B,p=V=>Bv(V,!1,u),h=u.onStop=()=>{const V=Ao.get(u);if(V){if(l)l(V,4);else for(const Z of V)Z();Ao.delete(u)}},e?s?B(!0):W=u.run():o?o(B.bind(null,!0),!0):u.run(),A.pause=u.pause.bind(u),A.resume=u.resume.bind(u),A.stop=A,A}function Cn(t,e=1/0,n){if(e<=0||!Ue(t)||t.__v_skip||(n=n||new Map,(n.get(t)||0)>=e))return t;if(n.set(t,e),e--,Xe(t))Cn(t.value,e,n);else if(he(t))for(let s=0;s<t.length;s++)Cn(t[s],e,n);else if(_a(t)||di(t))t.forEach(s=>{Cn(s,e,n)});else if(Sf(t)){for(const s in t)Cn(t[s],e,n);for(const s of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,s)&&Cn(t[s],e,n)}return t}function $r(t,e,n,s){try{return s?t(...s):t()}catch(i){ka(i,e,n)}}function en(t,e,n,s){if(be(t)){const i=$r(t,e,n,s);return i&&Cf(i)&&i.catch(r=>{ka(r,e,n)}),i}if(he(t)){const i=[];for(let r=0;r<t.length;r++)i.push(en(t[r],e,n,s));return i}}function ka(t,e,n,s=!0){const i=e?e.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Ve;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const u=a.ec;if(u){for(let d=0;d<u.length;d++)if(u[d](t,l,c)===!1)return}a=a.parent}if(r){Pn(),$r(r,null,10,[t,l,c]),Rn();return}}Vv(t,n,i,s,o)}function Vv(t,e,n,s=!0,i=!1){if(i)throw t;console.error(t)}const vt=[];let an=-1;const hi=[];let Wn=null,ri=0;const Gf=Promise.resolve();let xo=null;function ns(t){const e=xo||Gf;return t?e.then(this?t.bind(this):t):e}function Hv(t){let e=an+1,n=vt.length;for(;e<n;){const s=e+n>>>1,i=vt[s],r=_r(i);r<t||r===t&&i.flags&2?e=s+1:n=s}return e}function $c(t){if(!(t.flags&1)){const e=_r(t),n=vt[vt.length-1];!n||!(t.flags&2)&&e>=_r(n)?vt.push(t):vt.splice(Hv(e),0,t),t.flags|=1,Yf()}}function Yf(){xo||(xo=Gf.then(Xf))}function Wv(t){he(t)?hi.push(...t):Wn&&t.id===-1?Wn.splice(ri+1,0,t):t.flags&1||(hi.push(t),t.flags|=1),Yf()}function ld(t,e,n=an+1){for(;n<vt.length;n++){const s=vt[n];if(s&&s.flags&2){if(t&&s.id!==t.uid)continue;vt.splice(n,1),n--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function Qf(t){if(hi.length){const e=[...new Set(hi)].sort((n,s)=>_r(n)-_r(s));if(hi.length=0,Wn){Wn.push(...e);return}for(Wn=e,ri=0;ri<Wn.length;ri++){const n=Wn[ri];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Wn=null,ri=0}}const _r=t=>t.id==null?t.flags&2?-1:1/0:t.id;function Xf(t){try{for(an=0;an<vt.length;an++){const e=vt[an];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),$r(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;an<vt.length;an++){const e=vt[an];e&&(e.flags&=-2)}an=-1,vt.length=0,Qf(),xo=null,(vt.length||hi.length)&&Xf()}}let Ut=null,Jf=null;function Po(t){const e=Ut;return Ut=t,Jf=t&&t.type.__scopeId||null,e}function Fr(t,e=Ut,n){if(!e||t._n)return t;const s=(...i)=>{s._d&&Oo(-1);const r=Po(e);let o;try{o=t(...i)}finally{Po(r),s._d&&Oo(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function kn(t,e){if(Ut===null)return t;const n=Da(Ut),s=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[r,o,a,l=Ve]=e[i];r&&(be(r)&&(r={mounted:r,updated:r}),r.deep&&Cn(o),s.push({dir:r,instance:n,value:o,oldValue:void 0,arg:a,modifiers:l}))}return t}function Es(t,e,n,s){const i=t.dirs,r=e&&e.dirs;for(let o=0;o<i.length;o++){const a=i[o];r&&(a.oldValue=r[o].value);let l=a.dir[s];l&&(Pn(),en(l,n,8,[t.el,a,t,e]),Rn())}}function Wl(t,e){if(yt){let n=yt.provides;const s=yt.parent&&yt.parent.provides;s===n&&(n=yt.provides=Object.create(s)),n[t]=e}}function Ms(t,e,n=!1){const s=Oa();if(s||Ls){let i=Ls?Ls._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(i&&t in i)return i[t];if(arguments.length>1)return n&&be(e)?e.call(s&&s.proxy):e}}function jv(){return!!(Oa()||Ls)}const zv=Symbol.for("v-scx"),qv=()=>Ms(zv);function Ot(t,e,n){return Zf(t,e,n)}function Zf(t,e,n=Ve){const{immediate:s,deep:i,flush:r,once:o}=n,a=ot({},n),l=e&&s||!e&&r!=="post";let c;if(Cr){if(r==="sync"){const p=qv();c=p.__watcherHandles||(p.__watcherHandles=[])}else if(!l){const p=()=>{};return p.stop=un,p.resume=un,p.pause=un,p}}const u=yt;a.call=(p,m,w)=>en(p,u,m,w);let d=!1;r==="post"?a.scheduler=p=>{wt(p,u&&u.suspense)}:r!=="sync"&&(d=!0,a.scheduler=(p,m)=>{m?p():$c(p)}),a.augmentJob=p=>{e&&(p.flags|=4),d&&(p.flags|=2,u&&(p.id=u.uid,p.i=u))};const h=Uv(t,e,a);return Cr&&(c?c.push(h):l&&h()),h}function Kv(t,e,n){const s=this.proxy,i=Je(t)?t.includes(".")?ep(s,t):()=>s[t]:t.bind(s,s);let r;be(e)?r=e:(r=e.handler,n=e);const o=Br(this),a=Zf(i,r.bind(s),n);return o(),a}function ep(t,e){const n=e.split(".");return()=>{let s=t;for(let i=0;i<n.length&&s;i++)s=s[n[i]];return s}}const tp=Symbol("_vte"),np=t=>t.__isTeleport,ir=t=>t&&(t.disabled||t.disabled===""),cd=t=>t&&(t.defer||t.defer===""),ud=t=>typeof SVGElement<"u"&&t instanceof SVGElement,dd=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,jl=(t,e)=>{const n=t&&t.to;return Je(n)?e?e(n):null:n},sp={name:"Teleport",__isTeleport:!0,process(t,e,n,s,i,r,o,a,l,c){const{mc:u,pc:d,pbc:h,o:{insert:p,querySelector:m,createText:w,createComment:C}}=c,A=ir(e.props);let{shapeFlag:W,children:B,dynamicChildren:V}=e;if(t==null){const Z=e.el=w(""),re=e.anchor=w("");p(Z,n,s),p(re,n,s);const z=(v,T)=>{W&16&&u(B,v,T,i,r,o,a,l)},R=()=>{const v=e.target=jl(e.props,m),T=ip(v,e,w,p);v&&(o!=="svg"&&ud(v)?o="svg":o!=="mathml"&&dd(v)&&(o="mathml"),i&&i.isCE&&(i.ce._teleportTargets||(i.ce._teleportTargets=new Set)).add(v),A||(z(v,T),vo(e,!1)))};A&&(z(n,re),vo(e,!0)),cd(e.props)?(e.el.__isMounted=!1,wt(()=>{R(),delete e.el.__isMounted},r)):R()}else{if(cd(e.props)&&t.el.__isMounted===!1){wt(()=>{sp.process(t,e,n,s,i,r,o,a,l,c)},r);return}e.el=t.el,e.targetStart=t.targetStart;const Z=e.anchor=t.anchor,re=e.target=t.target,z=e.targetAnchor=t.targetAnchor,R=ir(t.props),v=R?n:re,T=R?Z:z;if(o==="svg"||ud(re)?o="svg":(o==="mathml"||dd(re))&&(o="mathml"),V?(h(t.dynamicChildren,V,v,i,r,o,a),Hc(t,e,!0)):l||d(t,e,v,T,i,r,o,a,!1),A)R?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):lo(e,n,Z,c,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const x=e.target=jl(e.props,m);x&&lo(e,x,null,c,0)}else R&&lo(e,re,z,c,1);vo(e,A)}},remove(t,e,n,{um:s,o:{remove:i}},r){const{shapeFlag:o,children:a,anchor:l,targetStart:c,targetAnchor:u,target:d,props:h}=t;if(d&&(i(c),i(u)),r&&i(l),o&16){const p=r||!ir(h);for(let m=0;m<a.length;m++){const w=a[m];s(w,e,n,p,!!w.dynamicChildren)}}},move:lo,hydrate:Gv};function lo(t,e,n,{o:{insert:s},m:i},r=2){r===0&&s(t.targetAnchor,e,n);const{el:o,anchor:a,shapeFlag:l,children:c,props:u}=t,d=r===2;if(d&&s(o,e,n),(!d||ir(u))&&l&16)for(let h=0;h<c.length;h++)i(c[h],e,n,2);d&&s(a,e,n)}function Gv(t,e,n,s,i,r,{o:{nextSibling:o,parentNode:a,querySelector:l,insert:c,createText:u}},d){function h(w,C,A,W){C.anchor=d(o(w),C,a(w),n,s,i,r),C.targetStart=A,C.targetAnchor=W}const p=e.target=jl(e.props,l),m=ir(e.props);if(p){const w=p._lpa||p.firstChild;if(e.shapeFlag&16)if(m)h(t,e,w,w&&o(w));else{e.anchor=o(t);let C=w;for(;C;){if(C&&C.nodeType===8){if(C.data==="teleport start anchor")e.targetStart=C;else if(C.data==="teleport anchor"){e.targetAnchor=C,p._lpa=e.targetAnchor&&o(e.targetAnchor);break}}C=o(C)}e.targetAnchor||ip(p,e,u,c),d(w&&o(w),e,p,n,s,i,r)}vo(e,m)}else m&&e.shapeFlag&16&&h(t,e,t,o(t));return e.anchor&&o(e.anchor)}const Fc=sp;function vo(t,e){const n=t.ctx;if(n&&n.ut){let s,i;for(e?(s=t.el,i=t.anchor):(s=t.targetStart,i=t.targetAnchor);s&&s!==i;)s.nodeType===1&&s.setAttribute("data-v-owner",n.uid),s=s.nextSibling;n.ut()}}function ip(t,e,n,s){const i=e.targetStart=n(""),r=e.targetAnchor=n("");return i[tp]=r,t&&(s(i,t),s(r,t)),r}const yn=Symbol("_leaveCb"),co=Symbol("_enterCb");function rp(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return wn(()=>{t.isMounted=!0}),Pa(()=>{t.isUnmounting=!0}),t}const Bt=[Function,Array],op={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Bt,onEnter:Bt,onAfterEnter:Bt,onEnterCancelled:Bt,onBeforeLeave:Bt,onLeave:Bt,onAfterLeave:Bt,onLeaveCancelled:Bt,onBeforeAppear:Bt,onAppear:Bt,onAfterAppear:Bt,onAppearCancelled:Bt},ap=t=>{const e=t.subTree;return e.component?ap(e.component):e},Yv={name:"BaseTransition",props:op,setup(t,{slots:e}){const n=Oa(),s=rp();return()=>{const i=e.default&&Bc(e.default(),!0);if(!i||!i.length)return;const r=lp(i),o=Te(t),{mode:a}=o;if(s.isLeaving)return pl(r);const l=hd(r);if(!l)return pl(r);let c=yr(l,o,s,n,d=>c=d);l.type!==_t&&Bs(l,c);let u=n.subTree&&hd(n.subTree);if(u&&u.type!==_t&&!Rs(u,l)&&ap(n).type!==_t){let d=yr(u,o,s,n);if(Bs(u,d),a==="out-in"&&l.type!==_t)return s.isLeaving=!0,d.afterLeave=()=>{s.isLeaving=!1,n.job.flags&8||n.update(),delete d.afterLeave,u=void 0},pl(r);a==="in-out"&&l.type!==_t?d.delayLeave=(h,p,m)=>{const w=cp(s,u);w[String(u.key)]=u,h[yn]=()=>{p(),h[yn]=void 0,delete c.delayedLeave,u=void 0},c.delayedLeave=()=>{m(),delete c.delayedLeave,u=void 0}}:u=void 0}else u&&(u=void 0);return r}}};function lp(t){let e=t[0];if(t.length>1){for(const n of t)if(n.type!==_t){e=n;break}}return e}const Qv=Yv;function cp(t,e){const{leavingVNodes:n}=t;let s=n.get(e.type);return s||(s=Object.create(null),n.set(e.type,s)),s}function yr(t,e,n,s,i){const{appear:r,mode:o,persisted:a=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:u,onEnterCancelled:d,onBeforeLeave:h,onLeave:p,onAfterLeave:m,onLeaveCancelled:w,onBeforeAppear:C,onAppear:A,onAfterAppear:W,onAppearCancelled:B}=e,V=String(t.key),Z=cp(n,t),re=(v,T)=>{v&&en(v,s,9,T)},z=(v,T)=>{const x=T[1];re(v,T),he(v)?v.every(b=>b.length<=1)&&x():v.length<=1&&x()},R={mode:o,persisted:a,beforeEnter(v){let T=l;if(!n.isMounted)if(r)T=C||l;else return;v[yn]&&v[yn](!0);const x=Z[V];x&&Rs(t,x)&&x.el[yn]&&x.el[yn](),re(T,[v])},enter(v){let T=c,x=u,b=d;if(!n.isMounted)if(r)T=A||c,x=W||u,b=B||d;else return;let F=!1;const D=v[co]=G=>{F||(F=!0,G?re(b,[v]):re(x,[v]),R.delayedLeave&&R.delayedLeave(),v[co]=void 0)};T?z(T,[v,D]):D()},leave(v,T){const x=String(t.key);if(v[co]&&v[co](!0),n.isUnmounting)return T();re(h,[v]);let b=!1;const F=v[yn]=D=>{b||(b=!0,T(),D?re(w,[v]):re(m,[v]),v[yn]=void 0,Z[x]===t&&delete Z[x])};Z[x]=t,p?z(p,[v,F]):F()},clone(v){const T=yr(v,e,n,s,i);return i&&i(T),T}};return R}function pl(t){if(Aa(t))return t=ds(t),t.children=null,t}function hd(t){if(!Aa(t))return np(t.type)&&t.children?lp(t.children):t;if(t.component)return t.component.subTree;const{shapeFlag:e,children:n}=t;if(n){if(e&16)return n[0];if(e&32&&be(n.default))return n.default()}}function Bs(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Bs(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Bc(t,e=!1,n){let s=[],i=0;for(let r=0;r<t.length;r++){let o=t[r];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:r);o.type===Le?(o.patchFlag&128&&i++,s=s.concat(Bc(o.children,e,a))):(e||o.type!==_t)&&s.push(a!=null?ds(o,{key:a}):o)}if(i>1)for(let r=0;r<s.length;r++)s[r].patchFlag=-2;return s}function up(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}const Ro=new WeakMap;function rr(t,e,n,s,i=!1){if(he(t)){t.forEach((m,w)=>rr(m,e&&(he(e)?e[w]:e),n,s,i));return}if(or(s)&&!i){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&rr(t,e,n,s.component.subTree);return}const r=s.shapeFlag&4?Da(s.component):s.el,o=i?null:r,{i:a,r:l}=t,c=e&&e.r,u=a.refs===Ve?a.refs={}:a.refs,d=a.setupState,h=Te(d),p=d===Ve?bf:m=>Oe(h,m);if(c!=null&&c!==l){if(fd(e),Je(c))u[c]=null,p(c)&&(d[c]=null);else if(Xe(c)){c.value=null;const m=e;m.k&&(u[m.k]=null)}}if(be(l))$r(l,a,12,[o,u]);else{const m=Je(l),w=Xe(l);if(m||w){const C=()=>{if(t.f){const A=m?p(l)?d[l]:u[l]:l.value;if(i)he(A)&&xc(A,r);else if(he(A))A.includes(r)||A.push(r);else if(m)u[l]=[r],p(l)&&(d[l]=u[l]);else{const W=[r];l.value=W,t.k&&(u[t.k]=W)}}else m?(u[l]=o,p(l)&&(d[l]=o)):w&&(l.value=o,t.k&&(u[t.k]=o))};if(o){const A=()=>{C(),Ro.delete(t)};A.id=-1,Ro.set(t,A),wt(A,n)}else fd(t),C()}}}function fd(t){const e=Ro.get(t);e&&(e.flags|=8,Ro.delete(t))}Ea().requestIdleCallback;Ea().cancelIdleCallback;const or=t=>!!t.type.__asyncLoader,Aa=t=>t.type.__isKeepAlive;function Xv(t,e){dp(t,"a",e)}function Jv(t,e){dp(t,"da",e)}function dp(t,e,n=yt){const s=t.__wdc||(t.__wdc=()=>{let i=n;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(xa(e,s,n),n){let i=n.parent;for(;i&&i.parent;)Aa(i.parent.vnode)&&Zv(s,e,n,i),i=i.parent}}function Zv(t,e,n,s){const i=xa(e,t,s,!0);Ys(()=>{xc(s[e],i)},n)}function xa(t,e,n=yt,s=!1){if(n){const i=n[t]||(n[t]=[]),r=e.__weh||(e.__weh=(...o)=>{Pn();const a=Br(n),l=en(e,n,t,o);return a(),Rn(),l});return s?i.unshift(r):i.push(r),r}}const $n=t=>(e,n=yt)=>{(!Cr||t==="sp")&&xa(t,(...s)=>e(...s),n)},e_=$n("bm"),wn=$n("m"),t_=$n("bu"),hp=$n("u"),Pa=$n("bum"),Ys=$n("um"),n_=$n("sp"),s_=$n("rtg"),i_=$n("rtc");function r_(t,e=yt){xa("ec",t,e)}const o_=Symbol.for("v-ndc");function Xt(t,e,n,s){let i;const r=n,o=he(t);if(o||Je(t)){const a=o&&Tn(t);let l=!1,c=!1;a&&(l=!Nt(t),c=Nn(t),t=Ia(t)),i=new Array(t.length);for(let u=0,d=t.length;u<d;u++)i[u]=e(l?c?Ci(Zt(t[u])):Zt(t[u]):t[u],u,void 0,r)}else if(typeof t=="number"){i=new Array(t);for(let a=0;a<t;a++)i[a]=e(a+1,a,void 0,r)}else if(Ue(t))if(t[Symbol.iterator])i=Array.from(t,(a,l)=>e(a,l,void 0,r));else{const a=Object.keys(t);i=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const u=a[l];i[l]=e(t[u],u,l,r)}}else i=[];return i}const zl=t=>t?Pp(t)?Da(t):zl(t.parent):null,ar=ot(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>zl(t.parent),$root:t=>zl(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>pp(t),$forceUpdate:t=>t.f||(t.f=()=>{$c(t.update)}),$nextTick:t=>t.n||(t.n=ns.bind(t.proxy)),$watch:t=>Kv.bind(t)}),ml=(t,e)=>t!==Ve&&!t.__isScriptSetup&&Oe(t,e),a_={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:s,data:i,props:r,accessCache:o,type:a,appContext:l}=t;if(e[0]!=="$"){const h=o[e];if(h!==void 0)switch(h){case 1:return s[e];case 2:return i[e];case 4:return n[e];case 3:return r[e]}else{if(ml(s,e))return o[e]=1,s[e];if(i!==Ve&&Oe(i,e))return o[e]=2,i[e];if(Oe(r,e))return o[e]=3,r[e];if(n!==Ve&&Oe(n,e))return o[e]=4,n[e];ql&&(o[e]=0)}}const c=ar[e];let u,d;if(c)return e==="$attrs"&&ft(t.attrs,"get",""),c(t);if((u=a.__cssModules)&&(u=u[e]))return u;if(n!==Ve&&Oe(n,e))return o[e]=4,n[e];if(d=l.config.globalProperties,Oe(d,e))return d[e]},set({_:t},e,n){const{data:s,setupState:i,ctx:r}=t;return ml(i,e)?(i[e]=n,!0):s!==Ve&&Oe(s,e)?(s[e]=n,!0):Oe(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(r[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:s,appContext:i,props:r,type:o}},a){let l;return!!(n[a]||t!==Ve&&a[0]!=="$"&&Oe(t,a)||ml(e,a)||Oe(r,a)||Oe(s,a)||Oe(ar,a)||Oe(i.config.globalProperties,a)||(l=o.__cssModules)&&l[a])},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Oe(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function pd(t){return he(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let ql=!0;function l_(t){const e=pp(t),n=t.proxy,s=t.ctx;ql=!1,e.beforeCreate&&md(e.beforeCreate,t,"bc");const{data:i,computed:r,methods:o,watch:a,provide:l,inject:c,created:u,beforeMount:d,mounted:h,beforeUpdate:p,updated:m,activated:w,deactivated:C,beforeDestroy:A,beforeUnmount:W,destroyed:B,unmounted:V,render:Z,renderTracked:re,renderTriggered:z,errorCaptured:R,serverPrefetch:v,expose:T,inheritAttrs:x,components:b,directives:F,filters:D}=e;if(c&&c_(c,s,null),o)for(const U in o){const ce=o[U];be(ce)&&(s[U]=ce.bind(n))}if(i){const U=i.call(n,n);Ue(U)&&(t.data=Lr(U))}if(ql=!0,r)for(const U in r){const ce=r[U],te=be(ce)?ce.bind(n,n):be(ce.get)?ce.get.bind(n,n):un,S=!be(ce)&&be(ce.set)?ce.set.bind(n):un,y=Ge({get:te,set:S});Object.defineProperty(s,U,{enumerable:!0,configurable:!0,get:()=>y.value,set:P=>y.value=P})}if(a)for(const U in a)fp(a[U],s,n,U);if(l){const U=be(l)?l.call(n):l;Reflect.ownKeys(U).forEach(ce=>{Wl(ce,U[ce])})}u&&md(u,t,"c");function O(U,ce){he(ce)?ce.forEach(te=>U(te.bind(n))):ce&&U(ce.bind(n))}if(O(e_,d),O(wn,h),O(t_,p),O(hp,m),O(Xv,w),O(Jv,C),O(r_,R),O(i_,re),O(s_,z),O(Pa,W),O(Ys,V),O(n_,v),he(T))if(T.length){const U=t.exposed||(t.exposed={});T.forEach(ce=>{Object.defineProperty(U,ce,{get:()=>n[ce],set:te=>n[ce]=te,enumerable:!0})})}else t.exposed||(t.exposed={});Z&&t.render===un&&(t.render=Z),x!=null&&(t.inheritAttrs=x),b&&(t.components=b),F&&(t.directives=F),v&&up(t)}function c_(t,e,n=un){he(t)&&(t=Kl(t));for(const s in t){const i=t[s];let r;Ue(i)?"default"in i?r=Ms(i.from||s,i.default,!0):r=Ms(i.from||s):r=Ms(i),Xe(r)?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):e[s]=r}}function md(t,e,n){en(he(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,n)}function fp(t,e,n,s){let i=s.includes(".")?ep(n,s):()=>n[s];if(Je(t)){const r=e[t];be(r)&&Ot(i,r)}else if(be(t))Ot(i,t.bind(n));else if(Ue(t))if(he(t))t.forEach(r=>fp(r,e,n,s));else{const r=be(t.handler)?t.handler.bind(n):e[t.handler];be(r)&&Ot(i,r,t)}}function pp(t){const e=t.type,{mixins:n,extends:s}=e,{mixins:i,optionsCache:r,config:{optionMergeStrategies:o}}=t.appContext,a=r.get(e);let l;return a?l=a:!i.length&&!n&&!s?l=e:(l={},i.length&&i.forEach(c=>No(l,c,o,!0)),No(l,e,o)),Ue(e)&&r.set(e,l),l}function No(t,e,n,s=!1){const{mixins:i,extends:r}=e;r&&No(t,r,n,!0),i&&i.forEach(o=>No(t,o,n,!0));for(const o in e)if(!(s&&o==="expose")){const a=u_[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const u_={data:gd,props:wd,emits:wd,methods:er,computed:er,beforeCreate:gt,created:gt,beforeMount:gt,mounted:gt,beforeUpdate:gt,updated:gt,beforeDestroy:gt,beforeUnmount:gt,destroyed:gt,unmounted:gt,activated:gt,deactivated:gt,errorCaptured:gt,serverPrefetch:gt,components:er,directives:er,watch:h_,provide:gd,inject:d_};function gd(t,e){return e?t?function(){return ot(be(t)?t.call(this,this):t,be(e)?e.call(this,this):e)}:e:t}function d_(t,e){return er(Kl(t),Kl(e))}function Kl(t){if(he(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function gt(t,e){return t?[...new Set([].concat(t,e))]:e}function er(t,e){return t?ot(Object.create(null),t,e):e}function wd(t,e){return t?he(t)&&he(e)?[...new Set([...t,...e])]:ot(Object.create(null),pd(t),pd(e??{})):e}function h_(t,e){if(!t)return e;if(!e)return t;const n=ot(Object.create(null),t);for(const s in e)n[s]=gt(t[s],e[s]);return n}function mp(){return{app:null,config:{isNativeTag:bf,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let f_=0;function p_(t,e){return function(s,i=null){be(s)||(s=ot({},s)),i!=null&&!Ue(i)&&(i=null);const r=mp(),o=new WeakSet,a=[];let l=!1;const c=r.app={_uid:f_++,_component:s,_props:i,_container:null,_context:r,_instance:null,version:q_,get config(){return r.config},set config(u){},use(u,...d){return o.has(u)||(u&&be(u.install)?(o.add(u),u.install(c,...d)):be(u)&&(o.add(u),u(c,...d))),c},mixin(u){return r.mixins.includes(u)||r.mixins.push(u),c},component(u,d){return d?(r.components[u]=d,c):r.components[u]},directive(u,d){return d?(r.directives[u]=d,c):r.directives[u]},mount(u,d,h){if(!l){const p=c._ceVNode||et(s,i);return p.appContext=r,h===!0?h="svg":h===!1&&(h=void 0),t(p,u,h),l=!0,c._container=u,u.__vue_app__=c,Da(p.component)}},onUnmount(u){a.push(u)},unmount(){l&&(en(a,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(u,d){return r.provides[u]=d,c},runWithContext(u){const d=Ls;Ls=c;try{return u()}finally{Ls=d}}};return c}}let Ls=null;const m_=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${us(e)}Modifiers`]||t[`${ys(e)}Modifiers`];function g_(t,e,...n){if(t.isUnmounted)return;const s=t.vnode.props||Ve;let i=n;const r=e.startsWith("update:"),o=r&&m_(s,e.slice(7));o&&(o.trim&&(i=n.map(u=>Je(u)?u.trim():u)),o.number&&(i=n.map(Ca)));let a,l=s[a=cl(e)]||s[a=cl(us(e))];!l&&r&&(l=s[a=cl(ys(e))]),l&&en(l,t,6,i);const c=s[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,en(c,t,6,i)}}const w_=new WeakMap;function gp(t,e,n=!1){const s=n?w_:e.emitsCache,i=s.get(t);if(i!==void 0)return i;const r=t.emits;let o={},a=!1;if(!be(t)){const l=c=>{const u=gp(c,e,!0);u&&(a=!0,ot(o,u))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!r&&!a?(Ue(t)&&s.set(t,null),null):(he(r)?r.forEach(l=>o[l]=null):ot(o,r),Ue(t)&&s.set(t,o),o)}function Ra(t,e){return!t||!va(e)?!1:(e=e.slice(2).replace(/Once$/,""),Oe(t,e[0].toLowerCase()+e.slice(1))||Oe(t,ys(e))||Oe(t,e))}function vd(t){const{type:e,vnode:n,proxy:s,withProxy:i,propsOptions:[r],slots:o,attrs:a,emit:l,render:c,renderCache:u,props:d,data:h,setupState:p,ctx:m,inheritAttrs:w}=t,C=Po(t);let A,W;try{if(n.shapeFlag&4){const V=i||s,Z=V;A=cn(c.call(Z,V,u,d,p,h,m)),W=a}else{const V=e;A=cn(V.length>1?V(d,{attrs:a,slots:o,emit:l}):V(d,null)),W=e.props?a:v_(a)}}catch(V){lr.length=0,ka(V,t,1),A=et(_t)}let B=A;if(W&&w!==!1){const V=Object.keys(W),{shapeFlag:Z}=B;V.length&&Z&7&&(r&&V.some(Ac)&&(W=__(W,r)),B=ds(B,W,!1,!0))}return n.dirs&&(B=ds(B,null,!1,!0),B.dirs=B.dirs?B.dirs.concat(n.dirs):n.dirs),n.transition&&Bs(B,n.transition),A=B,Po(C),A}const v_=t=>{let e;for(const n in t)(n==="class"||n==="style"||va(n))&&((e||(e={}))[n]=t[n]);return e},__=(t,e)=>{const n={};for(const s in t)(!Ac(s)||!(s.slice(9)in e))&&(n[s]=t[s]);return n};function y_(t,e,n){const{props:s,children:i,component:r}=t,{props:o,children:a,patchFlag:l}=e,c=r.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return s?_d(s,o,c):!!o;if(l&8){const u=e.dynamicProps;for(let d=0;d<u.length;d++){const h=u[d];if(o[h]!==s[h]&&!Ra(c,h))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?_d(s,o,c):!0:!!o;return!1}function _d(t,e,n){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let i=0;i<s.length;i++){const r=s[i];if(e[r]!==t[r]&&!Ra(n,r))return!0}return!1}function b_({vnode:t,parent:e},n){for(;e;){const s=e.subTree;if(s.suspense&&s.suspense.activeBranch===t&&(s.el=t.el),s===t)(t=e.vnode).el=n,e=e.parent;else break}}const wp={},vp=()=>Object.create(wp),_p=t=>Object.getPrototypeOf(t)===wp;function C_(t,e,n,s=!1){const i={},r=vp();t.propsDefaults=Object.create(null),yp(t,e,i,r);for(const o in t.propsOptions[0])o in i||(i[o]=void 0);n?t.props=s?i:Pv(i):t.type.props?t.props=i:t.props=r,t.attrs=r}function E_(t,e,n,s){const{props:i,attrs:r,vnode:{patchFlag:o}}=t,a=Te(i),[l]=t.propsOptions;let c=!1;if((s||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let d=0;d<u.length;d++){let h=u[d];if(Ra(t.emitsOptions,h))continue;const p=e[h];if(l)if(Oe(r,h))p!==r[h]&&(r[h]=p,c=!0);else{const m=us(h);i[m]=Gl(l,a,m,p,t,!1)}else p!==r[h]&&(r[h]=p,c=!0)}}}else{yp(t,e,i,r)&&(c=!0);let u;for(const d in a)(!e||!Oe(e,d)&&((u=ys(d))===d||!Oe(e,u)))&&(l?n&&(n[d]!==void 0||n[u]!==void 0)&&(i[d]=Gl(l,a,d,void 0,t,!0)):delete i[d]);if(r!==a)for(const d in r)(!e||!Oe(e,d))&&(delete r[d],c=!0)}c&&bn(t.attrs,"set","")}function yp(t,e,n,s){const[i,r]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(tr(l))continue;const c=e[l];let u;i&&Oe(i,u=us(l))?!r||!r.includes(u)?n[u]=c:(a||(a={}))[u]=c:Ra(t.emitsOptions,l)||(!(l in s)||c!==s[l])&&(s[l]=c,o=!0)}if(r){const l=Te(n),c=a||Ve;for(let u=0;u<r.length;u++){const d=r[u];n[d]=Gl(i,l,d,c[d],t,!Oe(c,d))}}return o}function Gl(t,e,n,s,i,r){const o=t[n];if(o!=null){const a=Oe(o,"default");if(a&&s===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&be(l)){const{propsDefaults:c}=i;if(n in c)s=c[n];else{const u=Br(i);s=c[n]=l.call(null,e),u()}}else s=l;i.ce&&i.ce._setProp(n,s)}o[0]&&(r&&!a?s=!1:o[1]&&(s===""||s===ys(n))&&(s=!0))}return s}const S_=new WeakMap;function bp(t,e,n=!1){const s=n?S_:e.propsCache,i=s.get(t);if(i)return i;const r=t.props,o={},a=[];let l=!1;if(!be(t)){const u=d=>{l=!0;const[h,p]=bp(d,e,!0);ot(o,h),p&&a.push(...p)};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!r&&!l)return Ue(t)&&s.set(t,ui),ui;if(he(r))for(let u=0;u<r.length;u++){const d=us(r[u]);yd(d)&&(o[d]=Ve)}else if(r)for(const u in r){const d=us(u);if(yd(d)){const h=r[u],p=o[d]=he(h)||be(h)?{type:h}:ot({},h),m=p.type;let w=!1,C=!0;if(he(m))for(let A=0;A<m.length;++A){const W=m[A],B=be(W)&&W.name;if(B==="Boolean"){w=!0;break}else B==="String"&&(C=!1)}else w=be(m)&&m.name==="Boolean";p[0]=w,p[1]=C,(w||Oe(p,"default"))&&a.push(d)}}const c=[o,a];return Ue(t)&&s.set(t,c),c}function yd(t){return t[0]!=="$"&&!tr(t)}const Uc=t=>t==="_"||t==="_ctx"||t==="$stable",Vc=t=>he(t)?t.map(cn):[cn(t)],I_=(t,e,n)=>{if(e._n)return e;const s=Fr((...i)=>Vc(e(...i)),n);return s._c=!1,s},Cp=(t,e,n)=>{const s=t._ctx;for(const i in t){if(Uc(i))continue;const r=t[i];if(be(r))e[i]=I_(i,r,s);else if(r!=null){const o=Vc(r);e[i]=()=>o}}},Ep=(t,e)=>{const n=Vc(e);t.slots.default=()=>n},Sp=(t,e,n)=>{for(const s in e)(n||!Uc(s))&&(t[s]=e[s])},T_=(t,e,n)=>{const s=t.slots=vp();if(t.vnode.shapeFlag&32){const i=e._;i?(Sp(s,e,n),n&&Tf(s,"_",i,!0)):Cp(e,s)}else e&&Ep(t,e)},k_=(t,e,n)=>{const{vnode:s,slots:i}=t;let r=!0,o=Ve;if(s.shapeFlag&32){const a=e._;a?n&&a===1?r=!1:Sp(i,e,n):(r=!e.$stable,Cp(e,i)),o=e}else e&&(Ep(t,e),o={default:1});if(r)for(const a in i)!Uc(a)&&o[a]==null&&delete i[a]},wt=N_;function A_(t){return x_(t)}function x_(t,e){const n=Ea();n.__VUE__=!0;const{insert:s,remove:i,patchProp:r,createElement:o,createText:a,createComment:l,setText:c,setElementText:u,parentNode:d,nextSibling:h,setScopeId:p=un,insertStaticContent:m}=t,w=(g,_,I,L=null,M=null,$=null,X=void 0,Q=null,K=!!_.dynamicChildren)=>{if(g===_)return;g&&!Rs(g,_)&&(L=ae(g),P(g,M,$,!0),g=null),_.patchFlag===-2&&(K=!1,_.dynamicChildren=null);const{type:H,ref:de,shapeFlag:se}=_;switch(H){case Na:C(g,_,I,L);break;case _t:A(g,_,I,L);break;case wl:g==null&&W(_,I,L,X);break;case Le:b(g,_,I,L,M,$,X,Q,K);break;default:se&1?Z(g,_,I,L,M,$,X,Q,K):se&6?F(g,_,I,L,M,$,X,Q,K):(se&64||se&128)&&H.process(g,_,I,L,M,$,X,Q,K,$e)}de!=null&&M?rr(de,g&&g.ref,$,_||g,!_):de==null&&g&&g.ref!=null&&rr(g.ref,null,$,g,!0)},C=(g,_,I,L)=>{if(g==null)s(_.el=a(_.children),I,L);else{const M=_.el=g.el;_.children!==g.children&&c(M,_.children)}},A=(g,_,I,L)=>{g==null?s(_.el=l(_.children||""),I,L):_.el=g.el},W=(g,_,I,L)=>{[g.el,g.anchor]=m(g.children,_,I,L,g.el,g.anchor)},B=({el:g,anchor:_},I,L)=>{let M;for(;g&&g!==_;)M=h(g),s(g,I,L),g=M;s(_,I,L)},V=({el:g,anchor:_})=>{let I;for(;g&&g!==_;)I=h(g),i(g),g=I;i(_)},Z=(g,_,I,L,M,$,X,Q,K)=>{if(_.type==="svg"?X="svg":_.type==="math"&&(X="mathml"),g==null)re(_,I,L,M,$,X,Q,K);else{const H=g.el&&g.el._isVueCE?g.el:null;try{H&&H._beginPatch(),v(g,_,M,$,X,Q,K)}finally{H&&H._endPatch()}}},re=(g,_,I,L,M,$,X,Q)=>{let K,H;const{props:de,shapeFlag:se,transition:le,dirs:me}=g;if(K=g.el=o(g.type,$,de&&de.is,de),se&8?u(K,g.children):se&16&&R(g.children,K,null,L,M,gl(g,$),X,Q),me&&Es(g,null,L,"created"),z(K,g,g.scopeId,X,L),de){for(const Fe in de)Fe!=="value"&&!tr(Fe)&&r(K,Fe,null,de[Fe],$,L);"value"in de&&r(K,"value",null,de.value,$),(H=de.onVnodeBeforeMount)&&rn(H,L,g)}me&&Es(g,null,L,"beforeMount");const Ie=P_(M,le);Ie&&le.beforeEnter(K),s(K,_,I),((H=de&&de.onVnodeMounted)||Ie||me)&&wt(()=>{H&&rn(H,L,g),Ie&&le.enter(K),me&&Es(g,null,L,"mounted")},M)},z=(g,_,I,L,M)=>{if(I&&p(g,I),L)for(let $=0;$<L.length;$++)p(g,L[$]);if(M){let $=M.subTree;if(_===$||kp($.type)&&($.ssContent===_||$.ssFallback===_)){const X=M.vnode;z(g,X,X.scopeId,X.slotScopeIds,M.parent)}}},R=(g,_,I,L,M,$,X,Q,K=0)=>{for(let H=K;H<g.length;H++){const de=g[H]=Q?jn(g[H]):cn(g[H]);w(null,de,_,I,L,M,$,X,Q)}},v=(g,_,I,L,M,$,X)=>{const Q=_.el=g.el;let{patchFlag:K,dynamicChildren:H,dirs:de}=_;K|=g.patchFlag&16;const se=g.props||Ve,le=_.props||Ve;let me;if(I&&Ss(I,!1),(me=le.onVnodeBeforeUpdate)&&rn(me,I,_,g),de&&Es(_,g,I,"beforeUpdate"),I&&Ss(I,!0),(se.innerHTML&&le.innerHTML==null||se.textContent&&le.textContent==null)&&u(Q,""),H?T(g.dynamicChildren,H,Q,I,L,gl(_,M),$):X||ce(g,_,Q,null,I,L,gl(_,M),$,!1),K>0){if(K&16)x(Q,se,le,I,M);else if(K&2&&se.class!==le.class&&r(Q,"class",null,le.class,M),K&4&&r(Q,"style",se.style,le.style,M),K&8){const Ie=_.dynamicProps;for(let Fe=0;Fe<Ie.length;Fe++){const Re=Ie[Fe],ct=se[Re],ut=le[Re];(ut!==ct||Re==="value")&&r(Q,Re,ct,ut,M,I)}}K&1&&g.children!==_.children&&u(Q,_.children)}else!X&&H==null&&x(Q,se,le,I,M);((me=le.onVnodeUpdated)||de)&&wt(()=>{me&&rn(me,I,_,g),de&&Es(_,g,I,"updated")},L)},T=(g,_,I,L,M,$,X)=>{for(let Q=0;Q<_.length;Q++){const K=g[Q],H=_[Q],de=K.el&&(K.type===Le||!Rs(K,H)||K.shapeFlag&198)?d(K.el):I;w(K,H,de,null,L,M,$,X,!0)}},x=(g,_,I,L,M)=>{if(_!==I){if(_!==Ve)for(const $ in _)!tr($)&&!($ in I)&&r(g,$,_[$],null,M,L);for(const $ in I){if(tr($))continue;const X=I[$],Q=_[$];X!==Q&&$!=="value"&&r(g,$,Q,X,M,L)}"value"in I&&r(g,"value",_.value,I.value,M)}},b=(g,_,I,L,M,$,X,Q,K)=>{const H=_.el=g?g.el:a(""),de=_.anchor=g?g.anchor:a("");let{patchFlag:se,dynamicChildren:le,slotScopeIds:me}=_;me&&(Q=Q?Q.concat(me):me),g==null?(s(H,I,L),s(de,I,L),R(_.children||[],I,de,M,$,X,Q,K)):se>0&&se&64&&le&&g.dynamicChildren&&g.dynamicChildren.length===le.length?(T(g.dynamicChildren,le,I,M,$,X,Q),(_.key!=null||M&&_===M.subTree)&&Hc(g,_,!0)):ce(g,_,I,de,M,$,X,Q,K)},F=(g,_,I,L,M,$,X,Q,K)=>{_.slotScopeIds=Q,g==null?_.shapeFlag&512?M.ctx.activate(_,I,L,X,K):D(_,I,L,M,$,X,K):G(g,_,K)},D=(g,_,I,L,M,$,X)=>{const Q=g.component=B_(g,L,M);if(Aa(g)&&(Q.ctx.renderer=$e),U_(Q,!1,X),Q.asyncDep){if(M&&M.registerDep(Q,O,X),!g.el){const K=Q.subTree=et(_t);A(null,K,_,I),g.placeholder=K.el}}else O(Q,g,_,I,M,$,X)},G=(g,_,I)=>{const L=_.component=g.component;if(y_(g,_,I))if(L.asyncDep&&!L.asyncResolved){U(L,_,I);return}else L.next=_,L.update();else _.el=g.el,L.vnode=_},O=(g,_,I,L,M,$,X)=>{const Q=()=>{if(g.isMounted){let{next:se,bu:le,u:me,parent:Ie,vnode:Fe}=g;{const Ft=Ip(g);if(Ft){se&&(se.el=Fe.el,U(g,se,X)),Ft.asyncDep.then(()=>{g.isUnmounted||Q()});return}}let Re=se,ct;Ss(g,!1),se?(se.el=Fe.el,U(g,se,X)):se=Fe,le&&wo(le),(ct=se.props&&se.props.onVnodeBeforeUpdate)&&rn(ct,Ie,se,Fe),Ss(g,!0);const ut=vd(g),kt=g.subTree;g.subTree=ut,w(kt,ut,d(kt.el),ae(kt),g,M,$),se.el=ut.el,Re===null&&b_(g,ut.el),me&&wt(me,M),(ct=se.props&&se.props.onVnodeUpdated)&&wt(()=>rn(ct,Ie,se,Fe),M)}else{let se;const{el:le,props:me}=_,{bm:Ie,m:Fe,parent:Re,root:ct,type:ut}=g,kt=or(_);Ss(g,!1),Ie&&wo(Ie),!kt&&(se=me&&me.onVnodeBeforeMount)&&rn(se,Re,_),Ss(g,!0);{ct.ce&&ct.ce._def.shadowRoot!==!1&&ct.ce._injectChildStyle(ut);const Ft=g.subTree=vd(g);w(null,Ft,I,L,g,M,$),_.el=Ft.el}if(Fe&&wt(Fe,M),!kt&&(se=me&&me.onVnodeMounted)){const Ft=_;wt(()=>rn(se,Re,Ft),M)}(_.shapeFlag&256||Re&&or(Re.vnode)&&Re.vnode.shapeFlag&256)&&g.a&&wt(g.a,M),g.isMounted=!0,_=I=L=null}};g.scope.on();const K=g.effect=new Of(Q);g.scope.off();const H=g.update=K.run.bind(K),de=g.job=K.runIfDirty.bind(K);de.i=g,de.id=g.uid,K.scheduler=()=>$c(de),Ss(g,!0),H()},U=(g,_,I)=>{_.component=g;const L=g.vnode.props;g.vnode=_,g.next=null,E_(g,_.props,L,I),k_(g,_.children,I),Pn(),ld(g),Rn()},ce=(g,_,I,L,M,$,X,Q,K=!1)=>{const H=g&&g.children,de=g?g.shapeFlag:0,se=_.children,{patchFlag:le,shapeFlag:me}=_;if(le>0){if(le&128){S(H,se,I,L,M,$,X,Q,K);return}else if(le&256){te(H,se,I,L,M,$,X,Q,K);return}}me&8?(de&16&&oe(H,M,$),se!==H&&u(I,se)):de&16?me&16?S(H,se,I,L,M,$,X,Q,K):oe(H,M,$,!0):(de&8&&u(I,""),me&16&&R(se,I,L,M,$,X,Q,K))},te=(g,_,I,L,M,$,X,Q,K)=>{g=g||ui,_=_||ui;const H=g.length,de=_.length,se=Math.min(H,de);let le;for(le=0;le<se;le++){const me=_[le]=K?jn(_[le]):cn(_[le]);w(g[le],me,I,null,M,$,X,Q,K)}H>de?oe(g,M,$,!0,!1,se):R(_,I,L,M,$,X,Q,K,se)},S=(g,_,I,L,M,$,X,Q,K)=>{let H=0;const de=_.length;let se=g.length-1,le=de-1;for(;H<=se&&H<=le;){const me=g[H],Ie=_[H]=K?jn(_[H]):cn(_[H]);if(Rs(me,Ie))w(me,Ie,I,null,M,$,X,Q,K);else break;H++}for(;H<=se&&H<=le;){const me=g[se],Ie=_[le]=K?jn(_[le]):cn(_[le]);if(Rs(me,Ie))w(me,Ie,I,null,M,$,X,Q,K);else break;se--,le--}if(H>se){if(H<=le){const me=le+1,Ie=me<de?_[me].el:L;for(;H<=le;)w(null,_[H]=K?jn(_[H]):cn(_[H]),I,Ie,M,$,X,Q,K),H++}}else if(H>le)for(;H<=se;)P(g[H],M,$,!0),H++;else{const me=H,Ie=H,Fe=new Map;for(H=Ie;H<=le;H++){const Pt=_[H]=K?jn(_[H]):cn(_[H]);Pt.key!=null&&Fe.set(Pt.key,H)}let Re,ct=0;const ut=le-Ie+1;let kt=!1,Ft=0;const Cs=new Array(ut);for(H=0;H<ut;H++)Cs[H]=0;for(H=me;H<=se;H++){const Pt=g[H];if(ct>=ut){P(Pt,M,$,!0);continue}let sn;if(Pt.key!=null)sn=Fe.get(Pt.key);else for(Re=Ie;Re<=le;Re++)if(Cs[Re-Ie]===0&&Rs(Pt,_[Re])){sn=Re;break}sn===void 0?P(Pt,M,$,!0):(Cs[sn-Ie]=H+1,sn>=Ft?Ft=sn:kt=!0,w(Pt,_[sn],I,null,M,$,X,Q,K),ct++)}const td=kt?R_(Cs):ui;for(Re=td.length-1,H=ut-1;H>=0;H--){const Pt=Ie+H,sn=_[Pt],nd=_[Pt+1],sd=Pt+1<de?nd.el||Tp(nd):L;Cs[H]===0?w(null,sn,I,sd,M,$,X,Q,K):kt&&(Re<0||H!==td[Re]?y(sn,I,sd,2):Re--)}}},y=(g,_,I,L,M=null)=>{const{el:$,type:X,transition:Q,children:K,shapeFlag:H}=g;if(H&6){y(g.component.subTree,_,I,L);return}if(H&128){g.suspense.move(_,I,L);return}if(H&64){X.move(g,_,I,$e);return}if(X===Le){s($,_,I);for(let se=0;se<K.length;se++)y(K[se],_,I,L);s(g.anchor,_,I);return}if(X===wl){B(g,_,I);return}if(L!==2&&H&1&&Q)if(L===0)Q.beforeEnter($),s($,_,I),wt(()=>Q.enter($),M);else{const{leave:se,delayLeave:le,afterLeave:me}=Q,Ie=()=>{g.ctx.isUnmounted?i($):s($,_,I)},Fe=()=>{$._isLeaving&&$[yn](!0),se($,()=>{Ie(),me&&me()})};le?le($,Ie,Fe):Fe()}else s($,_,I)},P=(g,_,I,L=!1,M=!1)=>{const{type:$,props:X,ref:Q,children:K,dynamicChildren:H,shapeFlag:de,patchFlag:se,dirs:le,cacheIndex:me}=g;if(se===-2&&(M=!1),Q!=null&&(Pn(),rr(Q,null,I,g,!0),Rn()),me!=null&&(_.renderCache[me]=void 0),de&256){_.ctx.deactivate(g);return}const Ie=de&1&&le,Fe=!or(g);let Re;if(Fe&&(Re=X&&X.onVnodeBeforeUnmount)&&rn(Re,_,g),de&6)q(g.component,I,L);else{if(de&128){g.suspense.unmount(I,L);return}Ie&&Es(g,null,_,"beforeUnmount"),de&64?g.type.remove(g,_,I,$e,L):H&&!H.hasOnce&&($!==Le||se>0&&se&64)?oe(H,_,I,!1,!0):($===Le&&se&384||!M&&de&16)&&oe(K,_,I),L&&E(g)}(Fe&&(Re=X&&X.onVnodeUnmounted)||Ie)&&wt(()=>{Re&&rn(Re,_,g),Ie&&Es(g,null,_,"unmounted")},I)},E=g=>{const{type:_,el:I,anchor:L,transition:M}=g;if(_===Le){k(I,L);return}if(_===wl){V(g);return}const $=()=>{i(I),M&&!M.persisted&&M.afterLeave&&M.afterLeave()};if(g.shapeFlag&1&&M&&!M.persisted){const{leave:X,delayLeave:Q}=M,K=()=>X(I,$);Q?Q(g.el,$,K):K()}else $()},k=(g,_)=>{let I;for(;g!==_;)I=h(g),i(g),g=I;i(_)},q=(g,_,I)=>{const{bum:L,scope:M,job:$,subTree:X,um:Q,m:K,a:H}=g;bd(K),bd(H),L&&wo(L),M.stop(),$&&($.flags|=8,P(X,g,_,I)),Q&&wt(Q,_),wt(()=>{g.isUnmounted=!0},_)},oe=(g,_,I,L=!1,M=!1,$=0)=>{for(let X=$;X<g.length;X++)P(g[X],_,I,L,M)},ae=g=>{if(g.shapeFlag&6)return ae(g.component.subTree);if(g.shapeFlag&128)return g.suspense.next();const _=h(g.anchor||g.el),I=_&&_[tp];return I?h(I):_};let ye=!1;const Me=(g,_,I)=>{let L;g==null?_._vnode&&(P(_._vnode,null,null,!0),L=_._vnode.component):w(_._vnode||null,g,_,null,null,null,I),_._vnode=g,ye||(ye=!0,ld(L),Qf(),ye=!1)},$e={p:w,um:P,m:y,r:E,mt:D,mc:R,pc:ce,pbc:T,n:ae,o:t};return{render:Me,hydrate:void 0,createApp:p_(Me)}}function gl({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function Ss({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function P_(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function Hc(t,e,n=!1){const s=t.children,i=e.children;if(he(s)&&he(i))for(let r=0;r<s.length;r++){const o=s[r];let a=i[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[r]=jn(i[r]),a.el=o.el),!n&&a.patchFlag!==-2&&Hc(o,a)),a.type===Na&&(a.patchFlag!==-1?a.el=o.el:a.__elIndex=r+(t.type===Le?1:0)),a.type===_t&&!a.el&&(a.el=o.el)}}function R_(t){const e=t.slice(),n=[0];let s,i,r,o,a;const l=t.length;for(s=0;s<l;s++){const c=t[s];if(c!==0){if(i=n[n.length-1],t[i]<c){e[s]=i,n.push(s);continue}for(r=0,o=n.length-1;r<o;)a=r+o>>1,t[n[a]]<c?r=a+1:o=a;c<t[n[r]]&&(r>0&&(e[s]=n[r-1]),n[r]=s)}}for(r=n.length,o=n[r-1];r-- >0;)n[r]=o,o=e[o];return n}function Ip(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Ip(e)}function bd(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}function Tp(t){if(t.placeholder)return t.placeholder;const e=t.component;return e?Tp(e.subTree):null}const kp=t=>t.__isSuspense;function N_(t,e){e&&e.pendingBranch?he(t)?e.effects.push(...t):e.effects.push(t):Wv(t)}const Le=Symbol.for("v-fgt"),Na=Symbol.for("v-txt"),_t=Symbol.for("v-cmt"),wl=Symbol.for("v-stc"),lr=[];let Rt=null;function J(t=!1){lr.push(Rt=t?null:[])}function O_(){lr.pop(),Rt=lr[lr.length-1]||null}let br=1;function Oo(t,e=!1){br+=t,t<0&&Rt&&e&&(Rt.hasOnce=!0)}function Ap(t){return t.dynamicChildren=br>0?Rt||ui:null,O_(),br>0&&Rt&&Rt.push(t),t}function ee(t,e,n,s,i,r){return Ap(f(t,e,n,s,i,r,!0))}function Qn(t,e,n,s,i){return Ap(et(t,e,n,s,i,!0))}function Do(t){return t?t.__v_isVNode===!0:!1}function Rs(t,e){return t.type===e.type&&t.key===e.key}const xp=({key:t})=>t??null,_o=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Je(t)||Xe(t)||be(t)?{i:Ut,r:t,k:e,f:!!n}:t:null);function f(t,e=null,n=null,s=0,i=null,r=t===Le?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&xp(e),ref:e&&_o(e),scopeId:Jf,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:s,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Ut};return a?(Wc(l,n),r&128&&t.normalize(l)):n&&(l.shapeFlag|=Je(n)?8:16),br>0&&!o&&Rt&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&Rt.push(l),l}const et=D_;function D_(t,e=null,n=null,s=0,i=null,r=!1){if((!t||t===o_)&&(t=_t),Do(t)){const a=ds(t,e,!0);return n&&Wc(a,n),br>0&&!r&&Rt&&(a.shapeFlag&6?Rt[Rt.indexOf(t)]=a:Rt.push(a)),a.patchFlag=-2,a}if(j_(t)&&(t=t.__vccOpts),e){e=M_(e);let{class:a,style:l}=e;a&&!Je(a)&&(e.class=_e(a)),Ue(l)&&(Ta(l)&&!he(l)&&(l=ot({},l)),e.style=dn(l))}const o=Je(t)?1:kp(t)?128:np(t)?64:Ue(t)?4:be(t)?2:0;return f(t,e,n,s,i,o,r,!0)}function M_(t){return t?Ta(t)||_p(t)?ot({},t):t:null}function ds(t,e,n=!1,s=!1){const{props:i,ref:r,patchFlag:o,children:a,transition:l}=t,c=e?L_(i||{},e):i,u={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&xp(c),ref:e&&e.ref?n&&r?he(r)?r.concat(_o(e)):[r,_o(e)]:_o(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Le?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&ds(t.ssContent),ssFallback:t.ssFallback&&ds(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&s&&Bs(u,l.clone(u)),u}function ke(t=" ",e=0){return et(Na,null,t,e)}function Ae(t="",e=!1){return e?(J(),Qn(_t,null,t)):et(_t,null,t)}function cn(t){return t==null||typeof t=="boolean"?et(_t):he(t)?et(Le,null,t.slice()):Do(t)?jn(t):et(Na,null,String(t))}function jn(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:ds(t)}function Wc(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(he(e))n=16;else if(typeof e=="object")if(s&65){const i=e.default;i&&(i._c&&(i._d=!1),Wc(t,i()),i._c&&(i._d=!0));return}else{n=32;const i=e._;!i&&!_p(e)?e._ctx=Ut:i===3&&Ut&&(Ut.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else be(e)?(e={default:e,_ctx:Ut},n=32):(e=String(e),s&64?(n=16,e=[ke(e)]):n=8);t.children=e,t.shapeFlag|=n}function L_(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const i in s)if(i==="class")e.class!==s.class&&(e.class=_e([e.class,s.class]));else if(i==="style")e.style=dn([e.style,s.style]);else if(va(i)){const r=e[i],o=s[i];o&&r!==o&&!(he(r)&&r.includes(o))&&(e[i]=r?[].concat(r,o):o)}else i!==""&&(e[i]=s[i])}return e}function rn(t,e,n,s=null){en(t,e,7,[n,s])}const $_=mp();let F_=0;function B_(t,e,n){const s=t.type,i=(e?e.appContext:t.appContext)||$_,r={uid:F_++,vnode:t,type:s,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Pf(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:bp(s,i),emitsOptions:gp(s,i),emit:null,emitted:null,propsDefaults:Ve,inheritAttrs:s.inheritAttrs,ctx:Ve,data:Ve,props:Ve,attrs:Ve,slots:Ve,refs:Ve,setupState:Ve,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=g_.bind(null,r),t.ce&&t.ce(r),r}let yt=null;const Oa=()=>yt||Ut;let Mo,Yl;{const t=Ea(),e=(n,s)=>{let i;return(i=t[n])||(i=t[n]=[]),i.push(s),r=>{i.length>1?i.forEach(o=>o(r)):i[0](r)}};Mo=e("__VUE_INSTANCE_SETTERS__",n=>yt=n),Yl=e("__VUE_SSR_SETTERS__",n=>Cr=n)}const Br=t=>{const e=yt;return Mo(t),t.scope.on(),()=>{t.scope.off(),Mo(e)}},Cd=()=>{yt&&yt.scope.off(),Mo(null)};function Pp(t){return t.vnode.shapeFlag&4}let Cr=!1;function U_(t,e=!1,n=!1){e&&Yl(e);const{props:s,children:i}=t.vnode,r=Pp(t);C_(t,s,r,e),T_(t,i,n||e);const o=r?V_(t,e):void 0;return e&&Yl(!1),o}function V_(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,a_);const{setup:s}=n;if(s){Pn();const i=t.setupContext=s.length>1?W_(t):null,r=Br(t),o=$r(s,t,0,[t.props,i]),a=Cf(o);if(Rn(),r(),(a||t.sp)&&!or(t)&&up(t),a){if(o.then(Cd,Cd),e)return o.then(l=>{Ed(t,l)}).catch(l=>{ka(l,t,0)});t.asyncDep=o}else Ed(t,o)}else Rp(t)}function Ed(t,e,n){be(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Ue(e)&&(t.setupState=Kf(e)),Rp(t)}function Rp(t,e,n){const s=t.type;t.render||(t.render=s.render||un);{const i=Br(t);Pn();try{l_(t)}finally{Rn(),i()}}}const H_={get(t,e){return ft(t,"get",""),t[e]}};function W_(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,H_),slots:t.slots,emit:t.emit,expose:e}}function Da(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Kf(Lc(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in ar)return ar[n](t)},has(e,n){return n in e||n in ar}})):t.proxy}function j_(t){return be(t)&&"__vccOpts"in t}const Ge=(t,e)=>Fv(t,e,Cr);function z_(t,e,n){try{Oo(-1);const s=arguments.length;return s===2?Ue(e)&&!he(e)?Do(e)?et(t,null,[e]):et(t,e):et(t,null,e):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&Do(n)&&(n=[n]),et(t,e,n))}finally{Oo(1)}}const q_="3.5.26";let Ql;const Sd=typeof window<"u"&&window.trustedTypes;if(Sd)try{Ql=Sd.createPolicy("vue",{createHTML:t=>t})}catch{}const Np=Ql?t=>Ql.createHTML(t):t=>t,K_="http://www.w3.org/2000/svg",G_="http://www.w3.org/1998/Math/MathML",_n=typeof document<"u"?document:null,Id=_n&&_n.createElement("template"),Y_={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,s)=>{const i=e==="svg"?_n.createElementNS(K_,t):e==="mathml"?_n.createElementNS(G_,t):n?_n.createElement(t,{is:n}):_n.createElement(t);return t==="select"&&s&&s.multiple!=null&&i.setAttribute("multiple",s.multiple),i},createText:t=>_n.createTextNode(t),createComment:t=>_n.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>_n.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,s,i,r){const o=n?n.previousSibling:e.lastChild;if(i&&(i===r||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),n),!(i===r||!(i=i.nextSibling)););else{Id.innerHTML=Np(s==="svg"?`<svg>${t}</svg>`:s==="mathml"?`<math>${t}</math>`:t);const a=Id.content;if(s==="svg"||s==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},Fn="transition",Yi="animation",Ei=Symbol("_vtc"),Op={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Dp=ot({},op,Op),Q_=t=>(t.displayName="Transition",t.props=Dp,t),Mp=Q_((t,{slots:e})=>z_(Qv,Lp(t),e)),Is=(t,e=[])=>{he(t)?t.forEach(n=>n(...e)):t&&t(...e)},Td=t=>t?he(t)?t.some(e=>e.length>1):t.length>1:!1;function Lp(t){const e={};for(const b in t)b in Op||(e[b]=t[b]);if(t.css===!1)return e;const{name:n="v",type:s,duration:i,enterFromClass:r=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:l=r,appearActiveClass:c=o,appearToClass:u=a,leaveFromClass:d=`${n}-leave-from`,leaveActiveClass:h=`${n}-leave-active`,leaveToClass:p=`${n}-leave-to`}=t,m=X_(i),w=m&&m[0],C=m&&m[1],{onBeforeEnter:A,onEnter:W,onEnterCancelled:B,onLeave:V,onLeaveCancelled:Z,onBeforeAppear:re=A,onAppear:z=W,onAppearCancelled:R=B}=e,v=(b,F,D,G)=>{b._enterCancelled=G,Un(b,F?u:a),Un(b,F?c:o),D&&D()},T=(b,F)=>{b._isLeaving=!1,Un(b,d),Un(b,p),Un(b,h),F&&F()},x=b=>(F,D)=>{const G=b?z:W,O=()=>v(F,b,D);Is(G,[F,O]),kd(()=>{Un(F,b?l:r),on(F,b?u:a),Td(G)||Ad(F,s,w,O)})};return ot(e,{onBeforeEnter(b){Is(A,[b]),on(b,r),on(b,o)},onBeforeAppear(b){Is(re,[b]),on(b,l),on(b,c)},onEnter:x(!1),onAppear:x(!0),onLeave(b,F){b._isLeaving=!0;const D=()=>T(b,F);on(b,d),b._enterCancelled?(on(b,h),Xl(b)):(Xl(b),on(b,h)),kd(()=>{b._isLeaving&&(Un(b,d),on(b,p),Td(V)||Ad(b,s,C,D))}),Is(V,[b,D])},onEnterCancelled(b){v(b,!1,void 0,!0),Is(B,[b])},onAppearCancelled(b){v(b,!0,void 0,!0),Is(R,[b])},onLeaveCancelled(b){T(b),Is(Z,[b])}})}function X_(t){if(t==null)return null;if(Ue(t))return[vl(t.enter),vl(t.leave)];{const e=vl(t);return[e,e]}}function vl(t){return tv(t)}function on(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t[Ei]||(t[Ei]=new Set)).add(e)}function Un(t,e){e.split(/\s+/).forEach(s=>s&&t.classList.remove(s));const n=t[Ei];n&&(n.delete(e),n.size||(t[Ei]=void 0))}function kd(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let J_=0;function Ad(t,e,n,s){const i=t._endId=++J_,r=()=>{i===t._endId&&s()};if(n!=null)return setTimeout(r,n);const{type:o,timeout:a,propCount:l}=$p(t,e);if(!o)return s();const c=o+"end";let u=0;const d=()=>{t.removeEventListener(c,h),r()},h=p=>{p.target===t&&++u>=l&&d()};setTimeout(()=>{u<l&&d()},a+1),t.addEventListener(c,h)}function $p(t,e){const n=window.getComputedStyle(t),s=m=>(n[m]||"").split(", "),i=s(`${Fn}Delay`),r=s(`${Fn}Duration`),o=xd(i,r),a=s(`${Yi}Delay`),l=s(`${Yi}Duration`),c=xd(a,l);let u=null,d=0,h=0;e===Fn?o>0&&(u=Fn,d=o,h=r.length):e===Yi?c>0&&(u=Yi,d=c,h=l.length):(d=Math.max(o,c),u=d>0?o>c?Fn:Yi:null,h=u?u===Fn?r.length:l.length:0);const p=u===Fn&&/\b(?:transform|all)(?:,|$)/.test(s(`${Fn}Property`).toString());return{type:u,timeout:d,propCount:h,hasTransform:p}}function xd(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,s)=>Pd(n)+Pd(t[s])))}function Pd(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function Xl(t){return(t?t.ownerDocument:document).body.offsetHeight}function Z_(t,e,n){const s=t[Ei];s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const Rd=Symbol("_vod"),ey=Symbol("_vsh"),ty=Symbol(""),ny=/(?:^|;)\s*display\s*:/;function sy(t,e,n){const s=t.style,i=Je(n);let r=!1;if(n&&!i){if(e)if(Je(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&yo(s,a,"")}else for(const o in e)n[o]==null&&yo(s,o,"");for(const o in n)o==="display"&&(r=!0),yo(s,o,n[o])}else if(i){if(e!==n){const o=s[ty];o&&(n+=";"+o),s.cssText=n,r=ny.test(n)}}else e&&t.removeAttribute("style");Rd in t&&(t[Rd]=r?s.display:"",t[ey]&&(s.display="none"))}const Nd=/\s*!important$/;function yo(t,e,n){if(he(n))n.forEach(s=>yo(t,e,s));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const s=iy(t,e);Nd.test(n)?t.setProperty(ys(s),n.replace(Nd,""),"important"):t[s]=n}}const Od=["Webkit","Moz","ms"],_l={};function iy(t,e){const n=_l[e];if(n)return n;let s=us(e);if(s!=="filter"&&s in t)return _l[e]=s;s=If(s);for(let i=0;i<Od.length;i++){const r=Od[i]+s;if(r in t)return _l[e]=r}return e}const Dd="http://www.w3.org/1999/xlink";function Md(t,e,n,s,i,r=av(e)){s&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(Dd,e.slice(6,e.length)):t.setAttributeNS(Dd,e,n):n==null||r&&!kf(n)?t.removeAttribute(e):t.setAttribute(e,r?"":mn(n)?String(n):n)}function Ld(t,e,n,s,i){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?Np(n):n);return}const r=t.tagName;if(e==="value"&&r!=="PROGRESS"&&!r.includes("-")){const a=r==="OPTION"?t.getAttribute("value")||"":t.value,l=n==null?t.type==="checkbox"?"on":"":String(n);(a!==l||!("_value"in t))&&(t.value=l),n==null&&t.removeAttribute(e),t._value=n;return}let o=!1;if(n===""||n==null){const a=typeof t[e];a==="boolean"?n=kf(n):n==null&&a==="string"?(n="",o=!0):a==="number"&&(n=0,o=!0)}try{t[e]=n}catch{}o&&t.removeAttribute(i||e)}function Ns(t,e,n,s){t.addEventListener(e,n,s)}function ry(t,e,n,s){t.removeEventListener(e,n,s)}const $d=Symbol("_vei");function oy(t,e,n,s,i=null){const r=t[$d]||(t[$d]={}),o=r[e];if(s&&o)o.value=s;else{const[a,l]=ay(e);if(s){const c=r[e]=uy(s,i);Ns(t,a,c,l)}else o&&(ry(t,a,o,l),r[e]=void 0)}}const Fd=/(?:Once|Passive|Capture)$/;function ay(t){let e;if(Fd.test(t)){e={};let s;for(;s=t.match(Fd);)t=t.slice(0,t.length-s[0].length),e[s[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):ys(t.slice(2)),e]}let yl=0;const ly=Promise.resolve(),cy=()=>yl||(ly.then(()=>yl=0),yl=Date.now());function uy(t,e){const n=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=n.attached)return;en(dy(s,n.value),e,5,[s])};return n.value=t,n.attached=cy(),n}function dy(t,e){if(he(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(s=>i=>!i._stopped&&s&&s(i))}else return e}const Bd=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,hy=(t,e,n,s,i,r)=>{const o=i==="svg";e==="class"?Z_(t,s,o):e==="style"?sy(t,n,s):va(e)?Ac(e)||oy(t,e,n,s,r):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):fy(t,e,s,o))?(Ld(t,e,s),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Md(t,e,s,o,r,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Je(s))?Ld(t,us(e),s,r,e):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),Md(t,e,s,o))};function fy(t,e,n,s){if(s)return!!(e==="innerHTML"||e==="textContent"||e in t&&Bd(e)&&be(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="sandbox"&&t.tagName==="IFRAME"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=t.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return Bd(e)&&Je(n)?!1:e in t}const Fp=new WeakMap,Bp=new WeakMap,Lo=Symbol("_moveCb"),Ud=Symbol("_enterCb"),py=t=>(delete t.props.mode,t),my=py({name:"TransitionGroup",props:ot({},Dp,{tag:String,moveClass:String}),setup(t,{slots:e}){const n=Oa(),s=rp();let i,r;return hp(()=>{if(!i.length)return;const o=t.moveClass||`${t.name||"v"}-move`;if(!_y(i[0].el,n.vnode.el,o)){i=[];return}i.forEach(gy),i.forEach(wy);const a=i.filter(vy);Xl(n.vnode.el),a.forEach(l=>{const c=l.el,u=c.style;on(c,o),u.transform=u.webkitTransform=u.transitionDuration="";const d=c[Lo]=h=>{h&&h.target!==c||(!h||h.propertyName.endsWith("transform"))&&(c.removeEventListener("transitionend",d),c[Lo]=null,Un(c,o))};c.addEventListener("transitionend",d)}),i=[]}),()=>{const o=Te(t),a=Lp(o);let l=o.tag||Le;if(i=[],r)for(let c=0;c<r.length;c++){const u=r[c];u.el&&u.el instanceof Element&&(i.push(u),Bs(u,yr(u,a,s,n)),Fp.set(u,{left:u.el.offsetLeft,top:u.el.offsetTop}))}r=e.default?Bc(e.default()):[];for(let c=0;c<r.length;c++){const u=r[c];u.key!=null&&Bs(u,yr(u,a,s,n))}return et(l,null,r)}}}),Up=my;function gy(t){const e=t.el;e[Lo]&&e[Lo](),e[Ud]&&e[Ud]()}function wy(t){Bp.set(t,{left:t.el.offsetLeft,top:t.el.offsetTop})}function vy(t){const e=Fp.get(t),n=Bp.get(t),s=e.left-n.left,i=e.top-n.top;if(s||i){const r=t.el.style;return r.transform=r.webkitTransform=`translate(${s}px,${i}px)`,r.transitionDuration="0s",t}}function _y(t,e,n){const s=t.cloneNode(),i=t[Ei];i&&i.forEach(a=>{a.split(/\s+/).forEach(l=>l&&s.classList.remove(l))}),n.split(/\s+/).forEach(a=>a&&s.classList.add(a)),s.style.display="none";const r=e.nodeType===1?e:e.parentNode;r.appendChild(s);const{hasTransform:o}=$p(s);return r.removeChild(s),o}const $o=t=>{const e=t.props["onUpdate:modelValue"]||!1;return he(e)?n=>wo(e,n):e};function yy(t){t.target.composing=!0}function Vd(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const fi=Symbol("_assign");function Hd(t,e,n){return e&&(t=t.trim()),n&&(t=Ca(t)),t}const ss={created(t,{modifiers:{lazy:e,trim:n,number:s}},i){t[fi]=$o(i);const r=s||i.props&&i.props.type==="number";Ns(t,e?"change":"input",o=>{o.target.composing||t[fi](Hd(t.value,n,r))}),(n||r)&&Ns(t,"change",()=>{t.value=Hd(t.value,n,r)}),e||(Ns(t,"compositionstart",yy),Ns(t,"compositionend",Vd),Ns(t,"change",Vd))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:s,trim:i,number:r}},o){if(t[fi]=$o(o),t.composing)return;const a=(r||t.type==="number")&&!/^0\d/.test(t.value)?Ca(t.value):t.value,l=e??"";a!==l&&(document.activeElement===t&&t.type!=="range"&&(s&&e===n||i&&t.value.trim()===l)||(t.value=l))}},by={deep:!0,created(t,{value:e,modifiers:{number:n}},s){const i=_a(e);Ns(t,"change",()=>{const r=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?Ca(Fo(o)):Fo(o));t[fi](t.multiple?i?new Set(r):r:r[0]),t._assigning=!0,ns(()=>{t._assigning=!1})}),t[fi]=$o(s)},mounted(t,{value:e}){Wd(t,e)},beforeUpdate(t,e,n){t[fi]=$o(n)},updated(t,{value:e}){t._assigning||Wd(t,e)}};function Wd(t,e){const n=t.multiple,s=he(e);if(!(n&&!s&&!_a(e))){for(let i=0,r=t.options.length;i<r;i++){const o=t.options[i],a=Fo(o);if(n)if(s){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(c=>String(c)===String(a)):o.selected=cv(e,a)>-1}else o.selected=e.has(a);else if(Sa(Fo(o),e)){t.selectedIndex!==i&&(t.selectedIndex=i);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function Fo(t){return"_value"in t?t._value:t.value}const Cy=["ctrl","shift","alt","meta"],Ey={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Cy.some(n=>t[`${n}Key`]&&!e.includes(n))},hs=(t,e)=>{const n=t._withMods||(t._withMods={}),s=e.join(".");return n[s]||(n[s]=((i,...r)=>{for(let o=0;o<e.length;o++){const a=Ey[e[o]];if(a&&a(i,e))return}return t(i,...r)}))},Sy={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Iy=(t,e)=>{const n=t._withKeys||(t._withKeys={}),s=e.join(".");return n[s]||(n[s]=(i=>{if(!("key"in i))return;const r=ys(i.key);if(e.some(o=>o===r||Sy[o]===r))return t(i)}))},Ty=ot({patchProp:hy},Y_);let jd;function ky(){return jd||(jd=A_(Ty))}const Ay=((...t)=>{const e=ky().createApp(...t),{mount:n}=e;return e.mount=s=>{const i=Py(s);if(!i)return;const r=e._component;!be(r)&&!r.render&&!r.template&&(r.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=n(i,!1,xy(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e});function xy(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Py(t){return Je(t)?document.querySelector(t):t}let Vp;const Ma=t=>Vp=t,Hp=Symbol();function Jl(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var cr;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(cr||(cr={}));function Ry(){const t=Rf(!0),e=t.run(()=>j({}));let n=[],s=[];const i=Lc({install(r){Ma(i),i._a=r,r.provide(Hp,i),r.config.globalProperties.$pinia=i,s.forEach(o=>n.push(o)),s=[]},use(r){return this._a?n.push(r):s.push(r),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return i}const Wp=()=>{};function zd(t,e,n,s=Wp){t.add(e);const i=()=>{t.delete(e)&&s()};return!n&&Nf()&&uv(i),i}function si(t,...e){t.forEach(n=>{n(...e)})}const Ny=t=>t(),qd=Symbol(),bl=Symbol();function Zl(t,e){t instanceof Map&&e instanceof Map?e.forEach((n,s)=>t.set(s,n)):t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const n in e){if(!e.hasOwnProperty(n))continue;const s=e[n],i=t[n];Jl(i)&&Jl(s)&&t.hasOwnProperty(n)&&!Xe(s)&&!Tn(s)?t[n]=Zl(i,s):t[n]=s}return t}const Oy=Symbol();function Dy(t){return!Jl(t)||!Object.prototype.hasOwnProperty.call(t,Oy)}const{assign:Vn}=Object;function My(t){return!!(Xe(t)&&t.effect)}function Ly(t,e,n,s){const{state:i,actions:r,getters:o}=e,a=n.state.value[t];let l;function c(){a||(n.state.value[t]=i?i():{});const u=Dv(n.state.value[t]);return Vn(u,r,Object.keys(o||{}).reduce((d,h)=>(d[h]=Lc(Ge(()=>{Ma(n);const p=n._s.get(t);return o[h].call(p,p)})),d),{}))}return l=jp(t,c,e,n,s,!0),l}function jp(t,e,n={},s,i,r){let o;const a=Vn({actions:{}},n),l={deep:!0};let c,u,d=new Set,h=new Set,p;const m=s.state.value[t];!r&&!m&&(s.state.value[t]={}),j({});let w;function C(R){let v;c=u=!1,typeof R=="function"?(R(s.state.value[t]),v={type:cr.patchFunction,storeId:t,events:p}):(Zl(s.state.value[t],R),v={type:cr.patchObject,payload:R,storeId:t,events:p});const T=w=Symbol();ns().then(()=>{w===T&&(c=!0)}),u=!0,si(d,v,s.state.value[t])}const A=r?function(){const{state:v}=n,T=v?v():{};this.$patch(x=>{Vn(x,T)})}:Wp;function W(){o.stop(),d.clear(),h.clear(),s._s.delete(t)}const B=(R,v="")=>{if(qd in R)return R[bl]=v,R;const T=function(){Ma(s);const x=Array.from(arguments),b=new Set,F=new Set;function D(U){b.add(U)}function G(U){F.add(U)}si(h,{args:x,name:T[bl],store:Z,after:D,onError:G});let O;try{O=R.apply(this&&this.$id===t?this:Z,x)}catch(U){throw si(F,U),U}return O instanceof Promise?O.then(U=>(si(b,U),U)).catch(U=>(si(F,U),Promise.reject(U))):(si(b,O),O)};return T[qd]=!0,T[bl]=v,T},V={_p:s,$id:t,$onAction:zd.bind(null,h),$patch:C,$reset:A,$subscribe(R,v={}){const T=zd(d,R,v.detached,()=>x()),x=o.run(()=>Ot(()=>s.state.value[t],b=>{(v.flush==="sync"?u:c)&&R({storeId:t,type:cr.direct,events:p},b)},Vn({},l,v)));return T},$dispose:W},Z=Lr(V);s._s.set(t,Z);const z=(s._a&&s._a.runWithContext||Ny)(()=>s._e.run(()=>(o=Rf()).run(()=>e({action:B}))));for(const R in z){const v=z[R];if(Xe(v)&&!My(v)||Tn(v))r||(m&&Dy(v)&&(Xe(v)?v.value=m[R]:Zl(v,m[R])),s.state.value[t][R]=v);else if(typeof v=="function"){const T=B(v,R);z[R]=T,a.actions[R]=v}}return Vn(Z,z),Vn(Te(Z),z),Object.defineProperty(Z,"$state",{get:()=>s.state.value[t],set:R=>{C(v=>{Vn(v,R)})}}),s._p.forEach(R=>{Vn(Z,o.run(()=>R({store:Z,app:s._a,pinia:s,options:a})))}),m&&r&&n.hydrate&&n.hydrate(Z.$state,m),c=!0,u=!0,Z}function La(t,e,n){let s;const i=typeof e=="function";s=i?n:e;function r(o,a){const l=jv();return o=o||(l?Ms(Hp,null):null),o&&Ma(o),o=Vp,o._s.has(t)||(i?jp(t,e,s,o):Ly(t,s,o)),o._s.get(t)}return r.$id=t,r}const $y=()=>{};var Kd={};const zp={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};const Y=function(t,e){if(!t)throw Oi(e)},Oi=function(t){return new Error("Firebase Database ("+zp.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};const qp=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Fy=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const i=t[n++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=t[n++];e[s++]=String.fromCharCode((i&31)<<6|r&63)}else if(i>239&&i<365){const r=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(l>>10)),e[s++]=String.fromCharCode(56320+(l&1023))}else{const r=t[n++],o=t[n++];e[s++]=String.fromCharCode((i&15)<<12|(r&63)<<6|o&63)}}return e.join("")},jc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<t.length;i+=3){const r=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,u=r>>2,d=(r&3)<<4|a>>4;let h=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(h=64)),s.push(n[u],n[d],n[h],n[p])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(qp(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Fy(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<t.length;){const r=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const d=i<t.length?n[t.charAt(i)]:64;if(++i,r==null||a==null||c==null||d==null)throw new By;const h=r<<2|a>>4;if(s.push(h),c!==64){const p=a<<4&240|c>>2;if(s.push(p),d!==64){const m=c<<6&192|d;s.push(m)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class By extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Kp=function(t){const e=qp(t);return jc.encodeByteArray(e,!0)},Bo=function(t){return Kp(t).replace(/\./g,"")},Uo=function(t){try{return jc.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Uy(t){return Gp(void 0,t)}function Gp(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!Vy(n)||(t[n]=Gp(t[n],e[n]));return t}function Vy(t){return t!=="__proto__"}function Hy(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Wy=()=>Hy().__FIREBASE_DEFAULTS__,jy=()=>{if(typeof process>"u"||typeof Kd>"u")return;const t=Kd.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},zy=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Uo(t[1]);return e&&JSON.parse(e)},zc=()=>{try{return $y()||Wy()||jy()||zy()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Yp=t=>zc()?.emulatorHosts?.[t],qy=t=>{const e=Yp(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},Qp=()=>zc()?.config,Xp=t=>zc()?.[`_${t}`];class jt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}function Di(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Jp(t){return(await fetch(t,{credentials:"include"})).ok}function Ky(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Bo(JSON.stringify(n)),Bo(JSON.stringify(o)),""].join(".")}const ur={};function Gy(){const t={prod:[],emulator:[]};for(const e of Object.keys(ur))ur[e]?t.emulator.push(e):t.prod.push(e);return t}function Yy(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Gd=!1;function Zp(t,e){if(typeof window>"u"||typeof document>"u"||!Di(window.location.host)||ur[t]===e||ur[t]||Gd)return;ur[t]=e;function n(h){return`__firebase__banner__${h}`}const s="__firebase__banner",r=Gy().prod.length>0;function o(){const h=document.getElementById(s);h&&h.remove()}function a(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function l(h,p){h.setAttribute("width","24"),h.setAttribute("id",p),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function c(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{Gd=!0,o()},h}function u(h,p){h.setAttribute("id",p),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function d(){const h=Yy(s),p=n("text"),m=document.getElementById(p)||document.createElement("span"),w=n("learnmore"),C=document.getElementById(w)||document.createElement("a"),A=n("preprendIcon"),W=document.getElementById(A)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const B=h.element;a(B),u(C,w);const V=c();l(W,A),B.append(W,m,C,V),document.body.appendChild(B)}r?(m.innerText="Preview backend disconnected.",W.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(W.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,m.innerText="Preview backend running in this workspace."),m.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}function St(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function qc(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(St())}function Qy(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Xy(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function em(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Jy(){const t=St();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Zy(){return zp.NODE_ADMIN===!0}function eb(){try{return typeof indexedDB=="object"}catch{return!1}}function tb(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(n){e(n)}})}const nb="FirebaseError";class bs extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=nb,Object.setPrototypeOf(this,bs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ur.prototype.create)}}class Ur{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},i=`${this.service}/${e}`,r=this.errors[e],o=r?sb(r,s):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new bs(i,a,s)}}function sb(t,e){return t.replace(ib,(n,s)=>{const i=e[s];return i!=null?String(i):`<${s}?>`})}const ib=/\{\$([^}]+)}/g;function Er(t){return JSON.parse(t)}function nt(t){return JSON.stringify(t)}const tm=function(t){let e={},n={},s={},i="";try{const r=t.split(".");e=Er(Uo(r[0])||""),n=Er(Uo(r[1])||""),i=r[2],s=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:s,signature:i}},rb=function(t){const e=tm(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},ob=function(t){const e=tm(t).claims;return typeof e=="object"&&e.admin===!0};function tn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Us(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Vo(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ho(t,e,n){const s={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=e.call(n,t[i],i,t));return s}function Vs(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const i of n){if(!s.includes(i))return!1;const r=t[i],o=e[i];if(Yd(r)&&Yd(o)){if(!Vs(r,o))return!1}else if(r!==o)return!1}for(const i of s)if(!n.includes(i))return!1;return!0}function Yd(t){return t!==null&&typeof t=="object"}function Mi(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}class ab{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const s=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)s[d]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let d=0;d<16;d++)s[d]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let d=16;d<80;d++){const h=s[d-3]^s[d-8]^s[d-14]^s[d-16];s[d]=(h<<1|h>>>31)&4294967295}let i=this.chain_[0],r=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,u;for(let d=0;d<80;d++){d<40?d<20?(c=a^r&(o^a),u=1518500249):(c=r^o^a,u=1859775393):d<60?(c=r&o|a&(r|o),u=2400959708):(c=r^o^a,u=3395469782);const h=(i<<5|i>>>27)+c+l+u+s[d]&4294967295;l=a,a=o,o=(r<<30|r>>>2)&4294967295,r=i,i=h}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+r&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const s=n-this.blockSize;let i=0;const r=this.buf_;let o=this.inbuf_;for(;i<n;){if(o===0)for(;i<=s;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(r[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(r),o=0;break}}else for(;i<n;)if(r[o]=e[i],++o,++i,o===this.blockSize){this.compress_(r),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let s=0;for(let i=0;i<5;i++)for(let r=24;r>=0;r-=8)e[s]=this.chain_[i]>>r&255,++s;return e}}function lb(t,e){const n=new cb(t,e);return n.subscribe.bind(n)}class cb{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let i;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");ub(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:s},i.next===void 0&&(i.next=Cl),i.error===void 0&&(i.error=Cl),i.complete===void 0&&(i.complete=Cl);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),r}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ub(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Cl(){}function Si(t,e){return`${t} failed: ${e} argument `}const db=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);if(i>=55296&&i<=56319){const r=i-55296;s++,Y(s<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(s)-56320;i=65536+(r<<10)+o}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},$a=function(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,n++):e+=3}return e};function dt(t){return t&&t._delegate?t._delegate:t}class Hs{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const xs="[DEFAULT]";class hb{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new jt;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),s=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(pb(e))try{this.getOrInitializeService({instanceIdentifier:xs})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const r=this.getOrInitializeService({instanceIdentifier:i});s.resolve(r)}catch{}}}}clearInstance(e=xs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=xs){return this.instances.has(e)}getOptions(e=xs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);s===a&&o.resolve(i)}return i}onInit(e,n){const s=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(s)??new Set;i.add(e),this.onInitCallbacks.set(s,i);const r=this.instances.get(s);return r&&e(r,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const i of s)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:fb(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=xs){return this.component?this.component.multipleInstances?e:xs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function fb(t){return t===xs?void 0:t}function pb(t){return t.instantiationMode==="EAGER"}class mb{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new hb(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var Be;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Be||(Be={}));const gb={debug:Be.DEBUG,verbose:Be.VERBOSE,info:Be.INFO,warn:Be.WARN,error:Be.ERROR,silent:Be.SILENT},wb=Be.INFO,vb={[Be.DEBUG]:"log",[Be.VERBOSE]:"log",[Be.INFO]:"info",[Be.WARN]:"warn",[Be.ERROR]:"error"},_b=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),i=vb[e];if(i)console[i](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Kc{constructor(e){this.name=e,this._logLevel=wb,this._logHandler=_b,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?gb[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Be.DEBUG,...e),this._logHandler(this,Be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Be.VERBOSE,...e),this._logHandler(this,Be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Be.INFO,...e),this._logHandler(this,Be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Be.WARN,...e),this._logHandler(this,Be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Be.ERROR,...e),this._logHandler(this,Be.ERROR,...e)}}const yb=(t,e)=>e.some(n=>t instanceof n);let Qd,Xd;function bb(){return Qd||(Qd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Cb(){return Xd||(Xd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const nm=new WeakMap,ec=new WeakMap,sm=new WeakMap,El=new WeakMap,Gc=new WeakMap;function Eb(t){const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",o)},r=()=>{n(is(t.result)),i()},o=()=>{s(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&nm.set(n,t)}).catch(()=>{}),Gc.set(e,t),e}function Sb(t){if(ec.has(t))return;const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",o),t.removeEventListener("abort",o)},r=()=>{n(),i()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",o),t.addEventListener("abort",o)});ec.set(t,e)}let tc={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ec.get(t);if(e==="objectStoreNames")return t.objectStoreNames||sm.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return is(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Ib(t){tc=t(tc)}function Tb(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(Sl(this),e,...n);return sm.set(s,e.sort?e.sort():[e]),is(s)}:Cb().includes(t)?function(...e){return t.apply(Sl(this),e),is(nm.get(this))}:function(...e){return is(t.apply(Sl(this),e))}}function kb(t){return typeof t=="function"?Tb(t):(t instanceof IDBTransaction&&Sb(t),yb(t,bb())?new Proxy(t,tc):t)}function is(t){if(t instanceof IDBRequest)return Eb(t);if(El.has(t))return El.get(t);const e=kb(t);return e!==t&&(El.set(t,e),Gc.set(e,t)),e}const Sl=t=>Gc.get(t);function Ab(t,e,{blocked:n,upgrade:s,blocking:i,terminated:r}={}){const o=indexedDB.open(t,e),a=is(o);return s&&o.addEventListener("upgradeneeded",l=>{s(is(o.result),l.oldVersion,l.newVersion,is(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{r&&l.addEventListener("close",()=>r()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const xb=["get","getKey","getAll","getAllKeys","count"],Pb=["put","add","delete","clear"],Il=new Map;function Jd(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Il.get(e))return Il.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,i=Pb.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(i||xb.includes(n)))return;const r=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return s&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return Il.set(e,r),r}Ib(t=>({...t,get:(e,n,s)=>Jd(e,n)||t.get(e,n,s),has:(e,n)=>!!Jd(e,n)||t.has(e,n)}));class Rb{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Nb(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function Nb(t){return t.getComponent()?.type==="VERSION"}const nc="@firebase/app",Zd="0.14.6";const On=new Kc("@firebase/app"),Ob="@firebase/app-compat",Db="@firebase/analytics-compat",Mb="@firebase/analytics",Lb="@firebase/app-check-compat",$b="@firebase/app-check",Fb="@firebase/auth",Bb="@firebase/auth-compat",Ub="@firebase/database",Vb="@firebase/data-connect",Hb="@firebase/database-compat",Wb="@firebase/functions",jb="@firebase/functions-compat",zb="@firebase/installations",qb="@firebase/installations-compat",Kb="@firebase/messaging",Gb="@firebase/messaging-compat",Yb="@firebase/performance",Qb="@firebase/performance-compat",Xb="@firebase/remote-config",Jb="@firebase/remote-config-compat",Zb="@firebase/storage",e0="@firebase/storage-compat",t0="@firebase/firestore",n0="@firebase/ai",s0="@firebase/firestore-compat",i0="firebase",r0="12.6.0";const sc="[DEFAULT]",o0={[nc]:"fire-core",[Ob]:"fire-core-compat",[Mb]:"fire-analytics",[Db]:"fire-analytics-compat",[$b]:"fire-app-check",[Lb]:"fire-app-check-compat",[Fb]:"fire-auth",[Bb]:"fire-auth-compat",[Ub]:"fire-rtdb",[Vb]:"fire-data-connect",[Hb]:"fire-rtdb-compat",[Wb]:"fire-fn",[jb]:"fire-fn-compat",[zb]:"fire-iid",[qb]:"fire-iid-compat",[Kb]:"fire-fcm",[Gb]:"fire-fcm-compat",[Yb]:"fire-perf",[Qb]:"fire-perf-compat",[Xb]:"fire-rc",[Jb]:"fire-rc-compat",[Zb]:"fire-gcs",[e0]:"fire-gcs-compat",[t0]:"fire-fst",[s0]:"fire-fst-compat",[n0]:"fire-vertex","fire-js":"fire-js",[i0]:"fire-js-all"};const Wo=new Map,a0=new Map,ic=new Map;function eh(t,e){try{t.container.addComponent(e)}catch(n){On.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ii(t){const e=t.name;if(ic.has(e))return On.debug(`There were multiple attempts to register component ${e}.`),!1;ic.set(e,t);for(const n of Wo.values())eh(n,t);for(const n of a0.values())eh(n,t);return!0}function Yc(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function zt(t){return t==null?!1:t.settings!==void 0}const l0={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},rs=new Ur("app","Firebase",l0);class c0{constructor(e,n,s){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Hs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw rs.create("app-deleted",{appName:this._name})}}const Li=r0;function im(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s={name:sc,automaticDataCollectionEnabled:!0,...e},i=s.name;if(typeof i!="string"||!i)throw rs.create("bad-app-name",{appName:String(i)});if(n||(n=Qp()),!n)throw rs.create("no-options");const r=Wo.get(i);if(r){if(Vs(n,r.options)&&Vs(s,r.config))return r;throw rs.create("duplicate-app",{appName:i})}const o=new mb(i);for(const l of ic.values())o.addComponent(l);const a=new c0(n,s,o);return Wo.set(i,a),a}function rm(t=sc){const e=Wo.get(t);if(!e&&t===sc&&Qp())return im();if(!e)throw rs.create("no-app",{appName:t});return e}function os(t,e,n){let s=o0[t]??t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),r=e.match(/\s|\//);if(i||r){const o=[`Unable to register library "${s}" with version "${e}":`];i&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&r&&o.push("and"),r&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),On.warn(o.join(" "));return}Ii(new Hs(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const u0="firebase-heartbeat-database",d0=1,Sr="firebase-heartbeat-store";let Tl=null;function om(){return Tl||(Tl=Ab(u0,d0,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Sr)}catch(n){console.warn(n)}}}}).catch(t=>{throw rs.create("idb-open",{originalErrorMessage:t.message})})),Tl}async function h0(t){try{const n=(await om()).transaction(Sr),s=await n.objectStore(Sr).get(am(t));return await n.done,s}catch(e){if(e instanceof bs)On.warn(e.message);else{const n=rs.create("idb-get",{originalErrorMessage:e?.message});On.warn(n.message)}}}async function th(t,e){try{const s=(await om()).transaction(Sr,"readwrite");await s.objectStore(Sr).put(e,am(t)),await s.done}catch(n){if(n instanceof bs)On.warn(n.message);else{const s=rs.create("idb-set",{originalErrorMessage:n?.message});On.warn(s.message)}}}function am(t){return`${t.name}!${t.options.appId}`}const f0=1024,p0=30;class m0{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new w0(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=nh();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(i=>i.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:n}),this._heartbeatsCache.heartbeats.length>p0){const i=v0(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){On.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=nh(),{heartbeatsToSend:n,unsentEntries:s}=g0(this._heartbeatsCache.heartbeats),i=Bo(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return On.warn(e),""}}}function nh(){return new Date().toISOString().substring(0,10)}function g0(t,e=f0){const n=[];let s=t.slice();for(const i of t){const r=n.find(o=>o.agent===i.agent);if(r){if(r.dates.push(i.date),sh(n)>e){r.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),sh(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class w0{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return eb()?tb().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await h0(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return th(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return th(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function sh(t){return Bo(JSON.stringify({version:2,heartbeats:t})).length}function v0(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let s=1;s<t.length;s++)t[s].date<n&&(n=t[s].date,e=s);return e}function _0(t){Ii(new Hs("platform-logger",e=>new Rb(e),"PRIVATE")),Ii(new Hs("heartbeat",e=>new m0(e),"PRIVATE")),os(nc,Zd,t),os(nc,Zd,"esm2020"),os("fire-js","")}_0("");var ih={};const rh="@firebase/database",oh="1.1.0";let lm="";function y0(t){lm=t}class b0{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),nt(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Er(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class C0{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return tn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const cm=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new b0(e)}}catch{}return new C0},Os=cm("localStorage"),E0=cm("sessionStorage");const pi=new Kc("@firebase/database"),um=(function(){let t=1;return function(){return t++}})(),dm=function(t){const e=db(t),n=new ab;n.update(e);const s=n.digest();return jc.encodeByteArray(s)},Vr=function(...t){let e="";for(let n=0;n<t.length;n++){const s=t[n];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=Vr.apply(null,s):typeof s=="object"?e+=nt(s):e+=s,e+=" "}return e};let dr=null,ah=!0;const S0=function(t,e){Y(!0,"Can't turn on custom loggers persistently."),pi.logLevel=Be.VERBOSE,dr=pi.log.bind(pi)},rt=function(...t){if(ah===!0&&(ah=!1,dr===null&&E0.get("logging_enabled")===!0&&S0()),dr){const e=Vr.apply(null,t);dr(e)}},Hr=function(t){return function(...e){rt(t,...e)}},rc=function(...t){const e="FIREBASE INTERNAL ERROR: "+Vr(...t);pi.error(e)},Dn=function(...t){const e=`FIREBASE FATAL ERROR: ${Vr(...t)}`;throw pi.error(e),new Error(e)},Ct=function(...t){const e="FIREBASE WARNING: "+Vr(...t);pi.warn(e)},I0=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ct("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Fa=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},T0=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Ws="[MIN_NAME]",fs="[MAX_NAME]",Qs=function(t,e){if(t===e)return 0;if(t===Ws||e===fs)return-1;if(e===Ws||t===fs)return 1;{const n=lh(t),s=lh(e);return n!==null?s!==null?n-s===0?t.length-e.length:n-s:-1:s!==null?1:t<e?-1:1}},k0=function(t,e){return t===e?0:t<e?-1:1},Qi=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+nt(e))},Qc=function(t){if(typeof t!="object"||t===null)return nt(t);const e=[];for(const s in t)e.push(s);e.sort();let n="{";for(let s=0;s<e.length;s++)s!==0&&(n+=","),n+=nt(e[s]),n+=":",n+=Qc(t[e[s]]);return n+="}",n},hm=function(t,e){const n=t.length;if(n<=e)return[t];const s=[];for(let i=0;i<n;i+=e)i+e>n?s.push(t.substring(i,n)):s.push(t.substring(i,i+e));return s};function at(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const fm=function(t){Y(!Fa(t),"Invalid JSON number");const e=11,n=52,s=(1<<e-1)-1;let i,r,o,a,l;t===0?(r=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-s)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),s),r=a+s,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(r=0,o=Math.round(t/Math.pow(2,1-s-n))));const c=[];for(l=n;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(r%2?1:0),r=Math.floor(r/2);c.push(i?1:0),c.reverse();const u=c.join("");let d="";for(l=0;l<64;l+=8){let h=parseInt(u.substr(l,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},A0=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},x0=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function P0(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const s=new Error(t+" at "+e._path.toString()+": "+n);return s.code=t.toUpperCase(),s}const R0=new RegExp("^-?(0*)\\d{1,10}$"),N0=-2147483648,O0=2147483647,lh=function(t){if(R0.test(t)){const e=Number(t);if(e>=N0&&e<=O0)return e}return null},$i=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Ct("Exception was thrown by user callback.",n),e},Math.floor(0))}},D0=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},hr=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};class M0{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,zt(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(s=>this.appCheck=s)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.appCheckProvider?.get().then(n=>n.addTokenListener(e))}notifyForInvalidToken(){Ct(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}class L0{constructor(e,n,s){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(rt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ct(e)}}class bo{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}bo.OWNER="owner";const Xc="5",pm="v",mm="s",gm="r",wm="f",vm=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,_m="ls",ym="p",oc="ac",bm="websocket",Cm="long_polling";class Em{constructor(e,n,s,i,r=!1,o="",a=!1,l=!1,c=null){this.secure=n,this.namespace=s,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this.emulatorOptions=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Os.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Os.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function $0(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function Sm(t,e,n){Y(typeof e=="string","typeof type must == string"),Y(typeof n=="object","typeof params must == object");let s;if(e===bm)s=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===Cm)s=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);$0(t)&&(n.ns=t.namespace);const i=[];return at(n,(r,o)=>{i.push(r+"="+o)}),s+i.join("&")}class F0{constructor(){this.counters_={}}incrementCounter(e,n=1){tn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return Uy(this.counters_)}}const kl={},Al={};function Jc(t){const e=t.toString();return kl[e]||(kl[e]=new F0),kl[e]}function B0(t,e){const n=t.toString();return Al[n]||(Al[n]=e()),Al[n]}class U0{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<s.length;++i)s[i]&&$i(()=>{this.onMessage_(s[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const ch="start",V0="close",H0="pLPCommand",W0="pRTLPCB",Im="id",Tm="pw",km="ser",j0="cb",z0="seg",q0="ts",K0="d",G0="dframe",Am=1870,xm=30,Y0=Am-xm,Q0=25e3,X0=3e4;class ai{constructor(e,n,s,i,r,o,a){this.connId=e,this.repoInfo=n,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Hr(e),this.stats_=Jc(n),this.urlFn=l=>(this.appCheckToken&&(l[oc]=this.appCheckToken),Sm(n,Cm,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new U0(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(X0)),T0(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Zc((...r)=>{const[o,a,l,c,u]=r;if(this.incrementIncomingBytes_(r),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===ch)this.id=a,this.password=l;else if(o===V0)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...r)=>{const[o,a]=r;this.incrementIncomingBytes_(r),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const s={};s[ch]="t",s[km]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[j0]=this.scriptTagHolder.uniqueCallbackIdentifier),s[pm]=Xc,this.transportSessionId&&(s[mm]=this.transportSessionId),this.lastSessionId&&(s[_m]=this.lastSessionId),this.applicationId&&(s[ym]=this.applicationId),this.appCheckToken&&(s[oc]=this.appCheckToken),typeof location<"u"&&location.hostname&&vm.test(location.hostname)&&(s[gm]=wm);const i=this.urlFn(s);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){ai.forceAllow_=!0}static forceDisallow(){ai.forceDisallow_=!0}static isAvailable(){return ai.forceAllow_?!0:!ai.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!A0()&&!x0()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=nt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=Kp(n),i=hm(s,Y0);for(let r=0;r<i.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[r]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const s={};s[G0]="t",s[Im]=e,s[Tm]=n,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=nt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class Zc{constructor(e,n,s,i){this.onDisconnect=s,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=um(),window[H0+this.uniqueCallbackIdentifier]=e,window[W0+this.uniqueCallbackIdentifier]=n,this.myIFrame=Zc.createIFrame_();let r="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(r='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+r+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){rt("frame writing exception"),a.stack&&rt(a.stack),rt(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||rt("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[Im]=this.myID,e[Tm]=this.myPW,e[km]=this.currentSerial;let n=this.urlFn(e),s="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+xm+s.length<=Am;){const o=this.pendingSegs.shift();s=s+"&"+z0+i+"="+o.seg+"&"+q0+i+"="+o.ts+"&"+K0+i+"="+o.d,i++}return n=n+s,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,s){this.pendingSegs.push({seg:e,ts:n,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const s=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(s,Math.floor(Q0)),r=()=>{clearTimeout(i),s()};this.addTag(e,r)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const i=s.readyState;(!i||i==="loaded"||i==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),n())},s.onerror=()=>{rt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}const J0=16384,Z0=45e3;let jo=null;typeof MozWebSocket<"u"?jo=MozWebSocket:typeof WebSocket<"u"&&(jo=WebSocket);class qt{constructor(e,n,s,i,r,o,a){this.connId=e,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Hr(this.connId),this.stats_=Jc(n),this.connURL=qt.connectionURL_(n,o,a,i,s),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,s,i,r){const o={};return o[pm]=Xc,typeof location<"u"&&location.hostname&&vm.test(location.hostname)&&(o[gm]=wm),n&&(o[mm]=n),s&&(o[_m]=s),i&&(o[oc]=i),r&&(o[ym]=r),Sm(e,bm,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Os.set("previous_websocket_failure",!0);try{let s;Zy(),this.mySock=new jo(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){qt.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(n);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&jo!==null&&!qt.forceDisallow_}static previouslyFailed(){return Os.isInMemoryStorage||Os.get("previous_websocket_failure")===!0}markConnectionHealthy(){Os.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const s=Er(n);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Y(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const s=this.extractFrameCount_(n);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const n=nt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=hm(n,J0);s.length>1&&this.sendString_(String(s.length));for(let i=0;i<s.length;i++)this.sendString_(s[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Z0))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}qt.responsesRequiredToBeHealthy=2;qt.healthyTimeout=3e4;class Ir{static get ALL_TRANSPORTS(){return[ai,qt]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=qt&&qt.isAvailable();let s=n&&!qt.previouslyFailed();if(e.webSocketOnly&&(n||Ct("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[qt];else{const i=this.transports_=[];for(const r of Ir.ALL_TRANSPORTS)r&&r.isAvailable()&&i.push(r);Ir.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Ir.globalTransportInitialized_=!1;const eC=6e4,tC=5e3,nC=10*1024,sC=100*1024,xl="t",uh="d",iC="s",dh="r",rC="e",hh="o",fh="a",ph="n",mh="p",oC="h";class aC{constructor(e,n,s,i,r,o,a,l,c,u){this.id=e,this.repoInfo_=n,this.applicationId_=s,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Hr("c:"+this.id+":"),this.transportManager_=new Ir(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,s)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=hr(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>sC?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>nC?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(xl in e){const n=e[xl];n===fh?this.upgradeIfSecondaryHealthy_():n===dh?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===hh&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=Qi("t",e),s=Qi("d",e);if(n==="c")this.onSecondaryControl_(s);else if(n==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:mh,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:fh,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:ph,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=Qi("t",e),s=Qi("d",e);n==="c"?this.onControl_(s):n==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=Qi(xl,e);if(uh in e){const s=e[uh];if(n===oC){const i={...s};this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===ph){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===iC?this.onConnectionShutdown_(s):n===dh?this.onReset_(s):n===rC?rc("Server Error: "+s):n===hh?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):rc("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,s=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Xc!==s&&Ct("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,s),hr(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(eC))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):hr(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(tC))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:mh,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Os.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Pm{put(e,n,s,i){}merge(e,n,s,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,s){}onDisconnectMerge(e,n,s){}onDisconnectCancel(e,n){}reportStats(e){}}let Rm=class{constructor(e){this.allowedEvents_=e,this.listeners_={},Y(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let i=0;i<s.length;i++)s[i].callback.apply(s[i].context,n)}}on(e,n,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:s});const i=this.getInitialEvent(e);i&&n.apply(s,i)}off(e,n,s){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let r=0;r<i.length;r++)if(i[r].callback===n&&(!s||s===i[r].context)){i.splice(r,1);return}}validateEventType_(e){Y(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};class zo extends Rm{static getInstance(){return new zo}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!qc()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return Y(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}const gh=32,wh=768;class De{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let s=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[s]=this.pieces_[i],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function xe(){return new De("")}function Ce(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function ps(t){return t.pieces_.length-t.pieceNum_}function He(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new De(t.pieces_,e)}function eu(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function lC(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Tr(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function Nm(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new De(e,0)}function Qe(t,e){const n=[];for(let s=t.pieceNum_;s<t.pieces_.length;s++)n.push(t.pieces_[s]);if(e instanceof De)for(let s=e.pieceNum_;s<e.pieces_.length;s++)n.push(e.pieces_[s]);else{const s=e.split("/");for(let i=0;i<s.length;i++)s[i].length>0&&n.push(s[i])}return new De(n,0)}function Ee(t){return t.pieceNum_>=t.pieces_.length}function bt(t,e){const n=Ce(t),s=Ce(e);if(n===null)return e;if(n===s)return bt(He(t),He(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function cC(t,e){const n=Tr(t,0),s=Tr(e,0);for(let i=0;i<n.length&&i<s.length;i++){const r=Qs(n[i],s[i]);if(r!==0)return r}return n.length===s.length?0:n.length<s.length?-1:1}function tu(t,e){if(ps(t)!==ps(e))return!1;for(let n=t.pieceNum_,s=e.pieceNum_;n<=t.pieces_.length;n++,s++)if(t.pieces_[n]!==e.pieces_[s])return!1;return!0}function Vt(t,e){let n=t.pieceNum_,s=e.pieceNum_;if(ps(t)>ps(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[s])return!1;++n,++s}return!0}class uC{constructor(e,n){this.errorPrefix_=n,this.parts_=Tr(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=$a(this.parts_[s]);Om(this)}}function dC(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=$a(e),Om(t)}function hC(t){const e=t.parts_.pop();t.byteLength_-=$a(e),t.parts_.length>0&&(t.byteLength_-=1)}function Om(t){if(t.byteLength_>wh)throw new Error(t.errorPrefix_+"has a key path longer than "+wh+" bytes ("+t.byteLength_+").");if(t.parts_.length>gh)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+gh+") or object contains a cycle "+Ps(t))}function Ps(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}class nu extends Rm{static getInstance(){return new nu}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}getInitialEvent(e){return Y(e==="visible","Unknown event type: "+e),[this.visible_]}}const Xi=1e3,fC=300*1e3,vh=30*1e3,pC=1.3,mC=3e4,gC="server_kill",_h=3;class An extends Pm{constructor(e,n,s,i,r,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=s,this.onConnectStatus_=i,this.onServerInfoUpdate_=r,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=An.nextPersistentConnectionId_++,this.log_=Hr("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Xi,this.maxReconnectDelay_=fC,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");nu.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&zo.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,s){const i=++this.requestNumber_,r={r:i,a:e,b:n};this.log_(nt(r)),Y(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),s&&(this.requestCBHash_[i]=s)}get(e){this.initConnection_();const n=new jt,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),n.promise}listen(e,n,s,i){this.initConnection_();const r=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+r),this.listens.has(o)||this.listens.set(o,new Map),Y(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Y(!this.listens.get(o).has(r),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:n,query:e,tag:s};this.listens.get(o).set(r,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(s)})}sendListen_(e){const n=e.query,s=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+s+" for "+i);const r={p:s},o="q";e.tag&&(r.q=n._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest(o,r,a=>{const l=a.d,c=a.s;An.warnOnListenWarnings_(l,n),(this.listens.get(s)&&this.listens.get(s).get(i))===e&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(s,i),e.onComplete&&e.onComplete(c,l))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&tn(e,"w")){const s=Us(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',r=n._path.toString();Ct(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${r} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||ob(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=vh)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=rb(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(n,s,i=>{const r=i.s,o=i.d||"error";this.authToken_===e&&(r==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(r,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,s=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,s)})}unlisten(e,n){const s=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+i),Y(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,i)&&this.connected_&&this.sendUnlisten_(s,i,e._queryObject,n)}sendUnlisten_(e,n,s,i){this.log_("Unlisten on "+e+" for "+n);const r={p:e},o="n";i&&(r.q=s,r.t=i),this.sendRequest(o,r)}onDisconnectPut(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:s})}onDisconnectMerge(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:s})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,s,i){const r={p:n,d:s};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,n,s,i){this.putInternal("p",e,n,s,i)}merge(e,n,s,i){this.putInternal("m",e,n,s,i)}putInternal(e,n,s,i,r){this.initConnection_();const o={p:n,d:s};r!==void 0&&(o.h=r),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,s,r=>{this.log_(n+" response",r),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(r.s,r.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,s=>{if(s.s!=="ok"){const r=s.d;this.log_("reportStats","Error sending stats: "+r)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+nt(e));const n=e.r,s=this.requestCBHash_[n];s&&(delete this.requestCBHash_[n],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):rc("Unrecognized action received from server: "+nt(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Y(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Xi,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Xi,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>mC&&(this.reconnectDelay_=Xi),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*pC)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+An.nextConnectionId_++,r=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,s())},c=function(d){Y(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(d)};this.realtime_={close:l,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[d,h]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?rt("getToken() completed but was canceled"):(rt("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=h&&h.token,a=new aC(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,s,p=>{Ct(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(gC)},r))}catch(d){this.log_("Failed to get token: "+d),o||(this.repoInfo_.nodeAdmin&&Ct(d),l())}}}interrupt(e){rt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){rt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Vo(this.interruptReasons_)&&(this.reconnectDelay_=Xi,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let s;n?s=n.map(r=>Qc(r)).join("$"):s="default";const i=this.removeListen_(e,s);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,n){const s=new De(e).toString();let i;if(this.listens.has(s)){const r=this.listens.get(s);i=r.get(n),r.delete(n),r.size===0&&this.listens.delete(s)}else i=void 0;return i}onAuthRevoked_(e,n){rt("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=_h&&(this.reconnectDelay_=vh,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){rt("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=_h&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+lm.replace(/\./g,"-")]=1,qc()?e["framework.cordova"]=1:em()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=zo.getInstance().currentlyOnline();return Vo(this.interruptReasons_)&&e}}An.nextPersistentConnectionId_=0;An.nextConnectionId_=0;class Se{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new Se(e,n)}}class Ba{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const s=new Se(Ws,e),i=new Se(Ws,n);return this.compare(s,i)!==0}minPost(){return Se.MIN}}let uo;class Dm extends Ba{static get __EMPTY_NODE(){return uo}static set __EMPTY_NODE(e){uo=e}compare(e,n){return Qs(e.name,n.name)}isDefinedOn(e){throw Oi("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return Se.MIN}maxPost(){return new Se(fs,uo)}makePost(e,n){return Y(typeof e=="string","KeyIndex indexValue must always be a string."),new Se(e,uo)}toString(){return".key"}}const $s=new Dm;class ho{constructor(e,n,s,i,r=null){this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?s(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class it{constructor(e,n,s,i,r){this.key=e,this.value=n,this.color=s??it.RED,this.left=i??At.EMPTY_NODE,this.right=r??At.EMPTY_NODE}copy(e,n,s,i,r){return new it(e??this.key,n??this.value,s??this.color,i??this.left,r??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let i=this;const r=s(e,i.key);return r<0?i=i.copy(null,null,null,i.left.insert(e,n,s),null):r===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,n,s)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return At.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let s,i;if(s=this,n(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),n(e,s.key)===0){if(s.right.isEmpty())return At.EMPTY_NODE;i=s.right.min_(),s=s.copy(i.key,i.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,it.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,it.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}it.RED=!0;it.BLACK=!1;class wC{copy(e,n,s,i,r){return this}insert(e,n,s){return new it(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class At{constructor(e,n=At.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new At(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,it.BLACK,null,null))}remove(e){return new At(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,it.BLACK,null,null))}get(e){let n,s=this.root_;for(;!s.isEmpty();){if(n=this.comparator_(e,s.key),n===0)return s.value;n<0?s=s.left:n>0&&(s=s.right)}return null}getPredecessorKey(e){let n,s=this.root_,i=null;for(;!s.isEmpty();)if(n=this.comparator_(e,s.key),n===0){if(s.left.isEmpty())return i?i.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else n<0?s=s.left:n>0&&(i=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ho(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new ho(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new ho(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new ho(this.root_,null,this.comparator_,!0,e)}}At.EMPTY_NODE=new wC;function vC(t,e){return Qs(t.name,e.name)}function su(t,e){return Qs(t,e)}let ac;function _C(t){ac=t}const Mm=function(t){return typeof t=="number"?"number:"+fm(t):"string:"+t},Lm=function(t){if(t.isLeafNode()){const e=t.val();Y(typeof e=="string"||typeof e=="number"||typeof e=="object"&&tn(e,".sv"),"Priority must be a string or number.")}else Y(t===ac||t.isEmpty(),"priority of unexpected type.");Y(t===ac||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let yh;class st{static set __childrenNodeConstructor(e){yh=e}static get __childrenNodeConstructor(){return yh}constructor(e,n=st.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,Y(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Lm(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new st(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:st.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ee(e)?this:Ce(e)===".priority"?this.priorityNode_:st.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:st.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const s=Ce(e);return s===null?n:n.isEmpty()&&s!==".priority"?this:(Y(s!==".priority"||ps(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,st.__childrenNodeConstructor.EMPTY_NODE.updateChild(He(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Mm(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=fm(this.value_):e+=this.value_,this.lazyHash_=dm(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===st.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof st.__childrenNodeConstructor?-1:(Y(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,s=typeof this.value_,i=st.VALUE_TYPE_ORDER.indexOf(n),r=st.VALUE_TYPE_ORDER.indexOf(s);return Y(i>=0,"Unknown leaf type: "+n),Y(r>=0,"Unknown leaf type: "+s),i===r?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}st.VALUE_TYPE_ORDER=["object","boolean","number","string"];let $m,Fm;function yC(t){$m=t}function bC(t){Fm=t}class CC extends Ba{compare(e,n){const s=e.node.getPriority(),i=n.node.getPriority(),r=s.compareTo(i);return r===0?Qs(e.name,n.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return Se.MIN}maxPost(){return new Se(fs,new st("[PRIORITY-POST]",Fm))}makePost(e,n){const s=$m(e);return new Se(n,new st("[PRIORITY-POST]",s))}toString(){return".priority"}}const Ke=new CC;const EC=Math.log(2);class SC{constructor(e){const n=r=>parseInt(Math.log(r)/EC,10),s=r=>parseInt(Array(r+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const i=s(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const qo=function(t,e,n,s){t.sort(e);const i=function(l,c){const u=c-l;let d,h;if(u===0)return null;if(u===1)return d=t[l],h=n?n(d):d,new it(h,d.node,it.BLACK,null,null);{const p=parseInt(u/2,10)+l,m=i(l,p),w=i(p+1,c);return d=t[p],h=n?n(d):d,new it(h,d.node,it.BLACK,m,w)}},r=function(l){let c=null,u=null,d=t.length;const h=function(m,w){const C=d-m,A=d;d-=m;const W=i(C+1,A),B=t[C],V=n?n(B):B;p(new it(V,B.node,w,null,W))},p=function(m){c?(c.left=m,c=m):(u=m,c=m)};for(let m=0;m<l.count;++m){const w=l.nextBitIsOne(),C=Math.pow(2,l.count-(m+1));w?h(C,it.BLACK):(h(C,it.BLACK),h(C,it.RED))}return u},o=new SC(t.length),a=r(o);return new At(s||e,a)};let Pl;const ii={};class En{static get Default(){return Y(ii&&Ke,"ChildrenNode.ts has not been loaded"),Pl=Pl||new En({".priority":ii},{".priority":Ke}),Pl}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=Us(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof At?n:null}hasIndex(e){return tn(this.indexSet_,e.toString())}addIndex(e,n){Y(e!==$s,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let i=!1;const r=n.getIterator(Se.Wrap);let o=r.getNext();for(;o;)i=i||e.isDefinedOn(o.node),s.push(o),o=r.getNext();let a;i?a=qo(s,e.getCompare()):a=ii;const l=e.toString(),c={...this.indexSet_};c[l]=e;const u={...this.indexes_};return u[l]=a,new En(u,c)}addToIndexes(e,n){const s=Ho(this.indexes_,(i,r)=>{const o=Us(this.indexSet_,r);if(Y(o,"Missing index implementation for "+r),i===ii)if(o.isDefinedOn(e.node)){const a=[],l=n.getIterator(Se.Wrap);let c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),qo(a,o.getCompare())}else return ii;else{const a=n.get(e.name);let l=i;return a&&(l=l.remove(new Se(e.name,a))),l.insert(e,e.node)}});return new En(s,this.indexSet_)}removeFromIndexes(e,n){const s=Ho(this.indexes_,i=>{if(i===ii)return i;{const r=n.get(e.name);return r?i.remove(new Se(e.name,r)):i}});return new En(s,this.indexSet_)}}let Ji;class fe{static get EMPTY_NODE(){return Ji||(Ji=new fe(new At(su),null,En.Default))}constructor(e,n,s){this.children_=e,this.priorityNode_=n,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&Lm(this.priorityNode_),this.children_.isEmpty()&&Y(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ji}updatePriority(e){return this.children_.isEmpty()?this:new fe(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Ji:n}}getChild(e){const n=Ce(e);return n===null?this:this.getImmediateChild(n).getChild(He(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(Y(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const s=new Se(e,n);let i,r;n.isEmpty()?(i=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(s,this.children_)):(i=this.children_.insert(e,n),r=this.indexMap_.addToIndexes(s,this.children_));const o=i.isEmpty()?Ji:this.priorityNode_;return new fe(i,o,r)}}updateChild(e,n){const s=Ce(e);if(s===null)return n;{Y(Ce(e)!==".priority"||ps(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(s).updateChild(He(e),n);return this.updateImmediateChild(s,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let s=0,i=0,r=!0;if(this.forEachChild(Ke,(o,a)=>{n[o]=a.val(e),s++,r&&fe.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):r=!1}),!e&&r&&i<2*s){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Mm(this.getPriority().val())+":"),this.forEachChild(Ke,(n,s)=>{const i=s.hash();i!==""&&(e+=":"+n+":"+i)}),this.lazyHash_=e===""?"":dm(e)}return this.lazyHash_}getPredecessorChildName(e,n,s){const i=this.resolveIndex_(s);if(i){const r=i.getPredecessorKey(new Se(e,n));return r?r.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new Se(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new Se(n,this.children_.get(n)):null}forEachChild(e,n){const s=this.resolveIndex_(e);return s?s.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,Se.Wrap);let r=i.peek();for(;r!=null&&n.compare(r,e)<0;)i.getNext(),r=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,Se.Wrap);let r=i.peek();for(;r!=null&&n.compare(r,e)>0;)i.getNext(),r=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Wr?-1:0}withIndex(e){if(e===$s||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new fe(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===$s||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const s=this.getIterator(Ke),i=n.getIterator(Ke);let r=s.getNext(),o=i.getNext();for(;r&&o;){if(r.name!==o.name||!r.node.equals(o.node))return!1;r=s.getNext(),o=i.getNext()}return r===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===$s?null:this.indexMap_.get(e.toString())}}fe.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class IC extends fe{constructor(){super(new At(su),fe.EMPTY_NODE,En.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return fe.EMPTY_NODE}isEmpty(){return!1}}const Wr=new IC;Object.defineProperties(Se,{MIN:{value:new Se(Ws,fe.EMPTY_NODE)},MAX:{value:new Se(fs,Wr)}});Dm.__EMPTY_NODE=fe.EMPTY_NODE;st.__childrenNodeConstructor=fe;_C(Wr);bC(Wr);const TC=!0;function Ye(t,e=null){if(t===null)return fe.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),Y(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new st(n,Ye(e))}if(!(t instanceof Array)&&TC){const n=[];let s=!1;if(at(t,(o,a)=>{if(o.substring(0,1)!=="."){const l=Ye(a);l.isEmpty()||(s=s||!l.getPriority().isEmpty(),n.push(new Se(o,l)))}}),n.length===0)return fe.EMPTY_NODE;const r=qo(n,vC,o=>o.name,su);if(s){const o=qo(n,Ke.getCompare());return new fe(r,Ye(e),new En({".priority":o},{".priority":Ke}))}else return new fe(r,Ye(e),En.Default)}else{let n=fe.EMPTY_NODE;return at(t,(s,i)=>{if(tn(t,s)&&s.substring(0,1)!=="."){const r=Ye(i);(r.isLeafNode()||!r.isEmpty())&&(n=n.updateImmediateChild(s,r))}}),n.updatePriority(Ye(e))}}yC(Ye);class iu extends Ba{constructor(e){super(),this.indexPath_=e,Y(!Ee(e)&&Ce(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const s=this.extractChild(e.node),i=this.extractChild(n.node),r=s.compareTo(i);return r===0?Qs(e.name,n.name):r}makePost(e,n){const s=Ye(e),i=fe.EMPTY_NODE.updateChild(this.indexPath_,s);return new Se(n,i)}maxPost(){const e=fe.EMPTY_NODE.updateChild(this.indexPath_,Wr);return new Se(fs,e)}toString(){return Tr(this.indexPath_,0).join("/")}}class kC extends Ba{compare(e,n){const s=e.node.compareTo(n.node);return s===0?Qs(e.name,n.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return Se.MIN}maxPost(){return Se.MAX}makePost(e,n){const s=Ye(e);return new Se(n,s)}toString(){return".value"}}const Bm=new kC;function Um(t){return{type:"value",snapshotNode:t}}function Ti(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function kr(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Ar(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function AC(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}class ru{constructor(e){this.index_=e}updateChild(e,n,s,i,r,o){Y(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(i).equals(s.getChild(i))&&a.isEmpty()===s.isEmpty()||(o!=null&&(s.isEmpty()?e.hasChild(n)?o.trackChildChange(kr(n,a)):Y(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Ti(n,s)):o.trackChildChange(Ar(n,s,a))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(n,s).withIndex(this.index_)}updateFullNode(e,n,s){return s!=null&&(e.isLeafNode()||e.forEachChild(Ke,(i,r)=>{n.hasChild(i)||s.trackChildChange(kr(i,r))}),n.isLeafNode()||n.forEachChild(Ke,(i,r)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(r)||s.trackChildChange(Ar(i,r,o))}else s.trackChildChange(Ti(i,r))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?fe.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class xr{constructor(e){this.indexedFilter_=new ru(e.getIndex()),this.index_=e.getIndex(),this.startPost_=xr.getStartPost_(e),this.endPost_=xr.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,s=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&s}updateChild(e,n,s,i,r,o){return this.matches(new Se(n,s))||(s=fe.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,s,i,r,o)}updateFullNode(e,n,s){n.isLeafNode()&&(n=fe.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(fe.EMPTY_NODE);const r=this;return n.forEachChild(Ke,(o,a)=>{r.matches(new Se(o,a))||(i=i.updateImmediateChild(o,fe.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}class xC{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const s=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?s<=0:s<0},this.withinEndPost=n=>{const s=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?s<=0:s<0},this.rangedFilter_=new xr(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,s,i,r,o){return this.rangedFilter_.matches(new Se(n,s))||(s=fe.EMPTY_NODE),e.getImmediateChild(n).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,s,i,r,o):this.fullLimitUpdateChild_(e,n,s,r,o)}updateFullNode(e,n,s){let i;if(n.isLeafNode()||n.isEmpty())i=fe.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=fe.EMPTY_NODE.withIndex(this.index_);let r;this.reverse_?r=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):r=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;r.hasNext()&&o<this.limit_;){const a=r.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(fe.EMPTY_NODE);let r;this.reverse_?r=i.getReverseIterator(this.index_):r=i.getIterator(this.index_);let o=0;for(;r.hasNext();){const a=r.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,fe.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,s,i,r){let o;if(this.reverse_){const d=this.index_.getCompare();o=(h,p)=>d(p,h)}else o=this.index_.getCompare();const a=e;Y(a.numChildren()===this.limit_,"");const l=new Se(n,s),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(a.hasChild(n)){const d=a.getImmediateChild(n);let h=i.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);const p=h==null?1:o(h,l);if(u&&!s.isEmpty()&&p>=0)return r?.trackChildChange(Ar(n,s,d)),a.updateImmediateChild(n,s);{r?.trackChildChange(kr(n,d));const w=a.updateImmediateChild(n,fe.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(r?.trackChildChange(Ti(h.name,h.node)),w.updateImmediateChild(h.name,h.node)):w}}else return s.isEmpty()?e:u&&o(c,l)>=0?(r!=null&&(r.trackChildChange(kr(c.name,c.node)),r.trackChildChange(Ti(n,s))),a.updateImmediateChild(n,s).updateImmediateChild(c.name,fe.EMPTY_NODE)):e}}class ou{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ke}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return Y(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Y(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ws}hasEnd(){return this.endSet_}getIndexEndValue(){return Y(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Y(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:fs}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return Y(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ke}copy(){const e=new ou;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function PC(t){return t.loadsAllData()?new ru(t.getIndex()):t.hasLimit()?new xC(t):new xr(t)}function RC(t,e,n){const s=t.copy();return s.endSet_=!0,e===void 0&&(e=null),s.indexEndValue_=e,n!==void 0?(s.endNameSet_=!0,s.indexEndName_=n):(s.endNameSet_=!1,s.indexEndName_=""),s}function NC(t,e){const n=t.copy();return n.index_=e,n}function bh(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Ke?n="$priority":t.index_===Bm?n="$value":t.index_===$s?n="$key":(Y(t.index_ instanceof iu,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=nt(n),t.startSet_){const s=t.startAfterSet_?"startAfter":"startAt";e[s]=nt(t.indexStartValue_),t.startNameSet_&&(e[s]+=","+nt(t.indexStartName_))}if(t.endSet_){const s=t.endBeforeSet_?"endBefore":"endAt";e[s]=nt(t.indexEndValue_),t.endNameSet_&&(e[s]+=","+nt(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Ch(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Ke&&(e.i=t.index_.toString()),e}class Ko extends Pm{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(Y(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,s,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=s,this.appCheckTokenProvider_=i,this.log_=Hr("p:rest:"),this.listens_={}}listen(e,n,s,i){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const o=Ko.getListenId_(e,s),a={};this.listens_[o]=a;const l=bh(e._queryParams);this.restRequest_(r+".json",l,(c,u)=>{let d=u;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(r,d,!1,s),Us(this.listens_,o)===a){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",i(h,null)}})}unlisten(e,n){const s=Ko.getListenId_(e,n);delete this.listens_[s]}get(e){const n=bh(e._queryParams),s=e._path.toString(),i=new jt;return this.restRequest_(s+".json",n,(r,o)=>{let a=o;r===404&&(a=null,r=null),r===null?(this.onDataUpdate_(s,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},s){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,r])=>{i&&i.accessToken&&(n.auth=i.accessToken),r&&r.token&&(n.ac=r.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Mi(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(s&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=Er(a.responseText)}catch{Ct("Failed to parse JSON response for "+o+": "+a.responseText)}s(null,l)}else a.status!==401&&a.status!==404&&Ct("Got unsuccessful REST response for "+o+" Status: "+a.status),s(a.status);s=null}},a.open("GET",o,!0),a.send()})}}class OC{constructor(){this.rootNode_=fe.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}function Go(){return{value:null,children:new Map}}function Fi(t,e,n){if(Ee(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const s=Ce(e);t.children.has(s)||t.children.set(s,Go());const i=t.children.get(s);e=He(e),Fi(i,e,n)}}function lc(t,e){if(Ee(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(Ke,(s,i)=>{Fi(t,new De(s),i)}),lc(t,e)}}else if(t.children.size>0){const n=Ce(e);return e=He(e),t.children.has(n)&&lc(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function cc(t,e,n){t.value!==null?n(e,t.value):DC(t,(s,i)=>{const r=new De(e.toString()+"/"+s);cc(i,r,n)})}function DC(t,e){t.children.forEach((n,s)=>{e(s,n)})}class MC{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n={...e};return this.last_&&at(this.last_,(s,i)=>{n[s]=n[s]-i}),this.last_=e,n}}const Eh=10*1e3,LC=30*1e3,$C=300*1e3;class FC{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new MC(e);const s=Eh+(LC-Eh)*Math.random();hr(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),n={};let s=!1;at(e,(i,r)=>{r>0&&tn(this.statsToReport_,i)&&(n[i]=r,s=!0)}),s&&this.server_.reportStats(n),hr(this.reportStats_.bind(this),Math.floor(Math.random()*2*$C))}}var Kt;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Kt||(Kt={}));function au(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function lu(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function cu(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}class Yo{constructor(e,n,s){this.path=e,this.affectedTree=n,this.revert=s,this.type=Kt.ACK_USER_WRITE,this.source=au()}operationForChild(e){if(Ee(this.path)){if(this.affectedTree.value!=null)return Y(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new De(e));return new Yo(xe(),n,this.revert)}}else return Y(Ce(this.path)===e,"operationForChild called for unrelated child."),new Yo(He(this.path),this.affectedTree,this.revert)}}class Pr{constructor(e,n){this.source=e,this.path=n,this.type=Kt.LISTEN_COMPLETE}operationForChild(e){return Ee(this.path)?new Pr(this.source,xe()):new Pr(this.source,He(this.path))}}class js{constructor(e,n,s){this.source=e,this.path=n,this.snap=s,this.type=Kt.OVERWRITE}operationForChild(e){return Ee(this.path)?new js(this.source,xe(),this.snap.getImmediateChild(e)):new js(this.source,He(this.path),this.snap)}}class ki{constructor(e,n,s){this.source=e,this.path=n,this.children=s,this.type=Kt.MERGE}operationForChild(e){if(Ee(this.path)){const n=this.children.subtree(new De(e));return n.isEmpty()?null:n.value?new js(this.source,xe(),n.value):new ki(this.source,xe(),n)}else return Y(Ce(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new ki(this.source,He(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class ms{constructor(e,n,s){this.node_=e,this.fullyInitialized_=n,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ee(e))return this.isFullyInitialized()&&!this.filtered_;const n=Ce(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class BC{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function UC(t,e,n,s){const i=[],r=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&r.push(AC(o.childName,o.snapshotNode))}),Zi(t,i,"child_removed",e,s,n),Zi(t,i,"child_added",e,s,n),Zi(t,i,"child_moved",r,s,n),Zi(t,i,"child_changed",e,s,n),Zi(t,i,"value",e,s,n),i}function Zi(t,e,n,s,i,r){const o=s.filter(a=>a.type===n);o.sort((a,l)=>HC(t,a,l)),o.forEach(a=>{const l=VC(t,a,r);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,t.query_))})})}function VC(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function HC(t,e,n){if(e.childName==null||n.childName==null)throw Oi("Should only compare child_ events.");const s=new Se(e.childName,e.snapshotNode),i=new Se(n.childName,n.snapshotNode);return t.index_.compare(s,i)}function Ua(t,e){return{eventCache:t,serverCache:e}}function fr(t,e,n,s){return Ua(new ms(e,n,s),t.serverCache)}function Vm(t,e,n,s){return Ua(t.eventCache,new ms(e,n,s))}function Qo(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function zs(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}let Rl;const WC=()=>(Rl||(Rl=new At(k0)),Rl);class ze{static fromObject(e){let n=new ze(null);return at(e,(s,i)=>{n=n.set(new De(s),i)}),n}constructor(e,n=WC()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:xe(),value:this.value};if(Ee(e))return null;{const s=Ce(e),i=this.children.get(s);if(i!==null){const r=i.findRootMostMatchingPathAndValue(He(e),n);return r!=null?{path:Qe(new De(s),r.path),value:r.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Ee(e))return this;{const n=Ce(e),s=this.children.get(n);return s!==null?s.subtree(He(e)):new ze(null)}}set(e,n){if(Ee(e))return new ze(n,this.children);{const s=Ce(e),r=(this.children.get(s)||new ze(null)).set(He(e),n),o=this.children.insert(s,r);return new ze(this.value,o)}}remove(e){if(Ee(e))return this.children.isEmpty()?new ze(null):new ze(null,this.children);{const n=Ce(e),s=this.children.get(n);if(s){const i=s.remove(He(e));let r;return i.isEmpty()?r=this.children.remove(n):r=this.children.insert(n,i),this.value===null&&r.isEmpty()?new ze(null):new ze(this.value,r)}else return this}}get(e){if(Ee(e))return this.value;{const n=Ce(e),s=this.children.get(n);return s?s.get(He(e)):null}}setTree(e,n){if(Ee(e))return n;{const s=Ce(e),r=(this.children.get(s)||new ze(null)).setTree(He(e),n);let o;return r.isEmpty()?o=this.children.remove(s):o=this.children.insert(s,r),new ze(this.value,o)}}fold(e){return this.fold_(xe(),e)}fold_(e,n){const s={};return this.children.inorderTraversal((i,r)=>{s[i]=r.fold_(Qe(e,i),n)}),n(e,this.value,s)}findOnPath(e,n){return this.findOnPath_(e,xe(),n)}findOnPath_(e,n,s){const i=this.value?s(n,this.value):!1;if(i)return i;if(Ee(e))return null;{const r=Ce(e),o=this.children.get(r);return o?o.findOnPath_(He(e),Qe(n,r),s):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,xe(),n)}foreachOnPath_(e,n,s){if(Ee(e))return this;{this.value&&s(n,this.value);const i=Ce(e),r=this.children.get(i);return r?r.foreachOnPath_(He(e),Qe(n,i),s):new ze(null)}}foreach(e){this.foreach_(xe(),e)}foreach_(e,n){this.children.inorderTraversal((s,i)=>{i.foreach_(Qe(e,s),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,s)=>{s.value&&e(n,s.value)})}}class Jt{constructor(e){this.writeTree_=e}static empty(){return new Jt(new ze(null))}}function pr(t,e,n){if(Ee(e))return new Jt(new ze(n));{const s=t.writeTree_.findRootMostValueAndPath(e);if(s!=null){const i=s.path;let r=s.value;const o=bt(i,e);return r=r.updateChild(o,n),new Jt(t.writeTree_.set(i,r))}else{const i=new ze(n),r=t.writeTree_.setTree(e,i);return new Jt(r)}}}function uc(t,e,n){let s=t;return at(n,(i,r)=>{s=pr(s,Qe(e,i),r)}),s}function Sh(t,e){if(Ee(e))return Jt.empty();{const n=t.writeTree_.setTree(e,new ze(null));return new Jt(n)}}function dc(t,e){return Xs(t,e)!=null}function Xs(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(bt(n.path,e)):null}function Ih(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Ke,(s,i)=>{e.push(new Se(s,i))}):t.writeTree_.children.inorderTraversal((s,i)=>{i.value!=null&&e.push(new Se(s,i.value))}),e}function as(t,e){if(Ee(e))return t;{const n=Xs(t,e);return n!=null?new Jt(new ze(n)):new Jt(t.writeTree_.subtree(e))}}function hc(t){return t.writeTree_.isEmpty()}function Ai(t,e){return Hm(xe(),t.writeTree_,e)}function Hm(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let s=null;return e.children.inorderTraversal((i,r)=>{i===".priority"?(Y(r.value!==null,"Priority writes must always be leaf nodes"),s=r.value):n=Hm(Qe(t,i),r,n)}),!n.getChild(t).isEmpty()&&s!==null&&(n=n.updateChild(Qe(t,".priority"),s)),n}}function Va(t,e){return qm(e,t)}function jC(t,e,n,s,i){Y(s>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:s,visible:i}),i&&(t.visibleWrites=pr(t.visibleWrites,e,n)),t.lastWriteId=s}function zC(t,e,n,s){Y(s>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:s,visible:!0}),t.visibleWrites=uc(t.visibleWrites,e,n),t.lastWriteId=s}function qC(t,e){for(let n=0;n<t.allWrites.length;n++){const s=t.allWrites[n];if(s.writeId===e)return s}return null}function KC(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);Y(n>=0,"removeWrite called with nonexistent writeId.");const s=t.allWrites[n];t.allWrites.splice(n,1);let i=s.visible,r=!1,o=t.allWrites.length-1;for(;i&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&GC(a,s.path)?i=!1:Vt(s.path,a.path)&&(r=!0)),o--}if(i){if(r)return YC(t),!0;if(s.snap)t.visibleWrites=Sh(t.visibleWrites,s.path);else{const a=s.children;at(a,l=>{t.visibleWrites=Sh(t.visibleWrites,Qe(s.path,l))})}return!0}else return!1}function GC(t,e){if(t.snap)return Vt(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&Vt(Qe(t.path,n),e))return!0;return!1}function YC(t){t.visibleWrites=Wm(t.allWrites,QC,xe()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function QC(t){return t.visible}function Wm(t,e,n){let s=Jt.empty();for(let i=0;i<t.length;++i){const r=t[i];if(e(r)){const o=r.path;let a;if(r.snap)Vt(n,o)?(a=bt(n,o),s=pr(s,a,r.snap)):Vt(o,n)&&(a=bt(o,n),s=pr(s,xe(),r.snap.getChild(a)));else if(r.children){if(Vt(n,o))a=bt(n,o),s=uc(s,a,r.children);else if(Vt(o,n))if(a=bt(o,n),Ee(a))s=uc(s,xe(),r.children);else{const l=Us(r.children,Ce(a));if(l){const c=l.getChild(He(a));s=pr(s,xe(),c)}}}else throw Oi("WriteRecord should have .snap or .children")}}return s}function jm(t,e,n,s,i){if(!s&&!i){const r=Xs(t.visibleWrites,e);if(r!=null)return r;{const o=as(t.visibleWrites,e);if(hc(o))return n;if(n==null&&!dc(o,xe()))return null;{const a=n||fe.EMPTY_NODE;return Ai(o,a)}}}else{const r=as(t.visibleWrites,e);if(!i&&hc(r))return n;if(!i&&n==null&&!dc(r,xe()))return null;{const o=function(c){return(c.visible||i)&&(!s||!~s.indexOf(c.writeId))&&(Vt(c.path,e)||Vt(e,c.path))},a=Wm(t.allWrites,o,e),l=n||fe.EMPTY_NODE;return Ai(a,l)}}}function XC(t,e,n){let s=fe.EMPTY_NODE;const i=Xs(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ke,(r,o)=>{s=s.updateImmediateChild(r,o)}),s;if(n){const r=as(t.visibleWrites,e);return n.forEachChild(Ke,(o,a)=>{const l=Ai(as(r,new De(o)),a);s=s.updateImmediateChild(o,l)}),Ih(r).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}else{const r=as(t.visibleWrites,e);return Ih(r).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}}function JC(t,e,n,s,i){Y(s||i,"Either existingEventSnap or existingServerSnap must exist");const r=Qe(e,n);if(dc(t.visibleWrites,r))return null;{const o=as(t.visibleWrites,r);return hc(o)?i.getChild(n):Ai(o,i.getChild(n))}}function ZC(t,e,n,s){const i=Qe(e,n),r=Xs(t.visibleWrites,i);if(r!=null)return r;if(s.isCompleteForChild(n)){const o=as(t.visibleWrites,i);return Ai(o,s.getNode().getImmediateChild(n))}else return null}function eE(t,e){return Xs(t.visibleWrites,e)}function tE(t,e,n,s,i,r,o){let a;const l=as(t.visibleWrites,e),c=Xs(l,xe());if(c!=null)a=c;else if(n!=null)a=Ai(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const u=[],d=o.getCompare(),h=r?a.getReverseIteratorFrom(s,o):a.getIteratorFrom(s,o);let p=h.getNext();for(;p&&u.length<i;)d(p,s)!==0&&u.push(p),p=h.getNext();return u}else return[]}function nE(){return{visibleWrites:Jt.empty(),allWrites:[],lastWriteId:-1}}function Xo(t,e,n,s){return jm(t.writeTree,t.treePath,e,n,s)}function uu(t,e){return XC(t.writeTree,t.treePath,e)}function Th(t,e,n,s){return JC(t.writeTree,t.treePath,e,n,s)}function Jo(t,e){return eE(t.writeTree,Qe(t.treePath,e))}function sE(t,e,n,s,i,r){return tE(t.writeTree,t.treePath,e,n,s,i,r)}function du(t,e,n){return ZC(t.writeTree,t.treePath,e,n)}function zm(t,e){return qm(Qe(t.treePath,e),t.writeTree)}function qm(t,e){return{treePath:t,writeTree:e}}class iE{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,s=e.childName;Y(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),Y(s!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(s);if(i){const r=i.type;if(n==="child_added"&&r==="child_removed")this.changeMap.set(s,Ar(s,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&r==="child_added")this.changeMap.delete(s);else if(n==="child_removed"&&r==="child_changed")this.changeMap.set(s,kr(s,i.oldSnap));else if(n==="child_changed"&&r==="child_added")this.changeMap.set(s,Ti(s,e.snapshotNode));else if(n==="child_changed"&&r==="child_changed")this.changeMap.set(s,Ar(s,e.snapshotNode,i.oldSnap));else throw Oi("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}class rE{getCompleteChild(e){return null}getChildAfterChild(e,n,s){return null}}const Km=new rE;class hu{constructor(e,n,s=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=s}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new ms(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return du(this.writes_,e,s)}}getChildAfterChild(e,n,s){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:zs(this.viewCache_),r=sE(this.writes_,i,n,1,s,e);return r.length===0?null:r[0]}}function oE(t){return{filter:t}}function aE(t,e){Y(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),Y(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function lE(t,e,n,s,i){const r=new iE;let o,a;if(n.type===Kt.OVERWRITE){const c=n;c.source.fromUser?o=fc(t,e,c.path,c.snap,s,i,r):(Y(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!Ee(c.path),o=Zo(t,e,c.path,c.snap,s,i,a,r))}else if(n.type===Kt.MERGE){const c=n;c.source.fromUser?o=uE(t,e,c.path,c.children,s,i,r):(Y(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=pc(t,e,c.path,c.children,s,i,a,r))}else if(n.type===Kt.ACK_USER_WRITE){const c=n;c.revert?o=fE(t,e,c.path,s,i,r):o=dE(t,e,c.path,c.affectedTree,s,i,r)}else if(n.type===Kt.LISTEN_COMPLETE)o=hE(t,e,n.path,s,r);else throw Oi("Unknown operation type: "+n.type);const l=r.getChanges();return cE(e,o,l),{viewCache:o,changes:l}}function cE(t,e,n){const s=e.eventCache;if(s.isFullyInitialized()){const i=s.getNode().isLeafNode()||s.getNode().isEmpty(),r=Qo(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!s.getNode().equals(r)||!s.getNode().getPriority().equals(r.getPriority()))&&n.push(Um(Qo(e)))}}function Gm(t,e,n,s,i,r){const o=e.eventCache;if(Jo(s,n)!=null)return e;{let a,l;if(Ee(n))if(Y(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=zs(e),u=c instanceof fe?c:fe.EMPTY_NODE,d=uu(s,u);a=t.filter.updateFullNode(e.eventCache.getNode(),d,r)}else{const c=Xo(s,zs(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,r)}else{const c=Ce(n);if(c===".priority"){Y(ps(n)===1,"Can't have a priority with additional path components");const u=o.getNode();l=e.serverCache.getNode();const d=Th(s,n,u,l);d!=null?a=t.filter.updatePriority(u,d):a=o.getNode()}else{const u=He(n);let d;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();const h=Th(s,n,o.getNode(),l);h!=null?d=o.getNode().getImmediateChild(c).updateChild(u,h):d=o.getNode().getImmediateChild(c)}else d=du(s,c,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),c,d,u,i,r):a=o.getNode()}}return fr(e,a,o.isFullyInitialized()||Ee(n),t.filter.filtersNodes())}}function Zo(t,e,n,s,i,r,o,a){const l=e.serverCache;let c;const u=o?t.filter:t.filter.getIndexedFilter();if(Ee(n))c=u.updateFullNode(l.getNode(),s,null);else if(u.filtersNodes()&&!l.isFiltered()){const p=l.getNode().updateChild(n,s);c=u.updateFullNode(l.getNode(),p,null)}else{const p=Ce(n);if(!l.isCompleteForPath(n)&&ps(n)>1)return e;const m=He(n),C=l.getNode().getImmediateChild(p).updateChild(m,s);p===".priority"?c=u.updatePriority(l.getNode(),C):c=u.updateChild(l.getNode(),p,C,m,Km,null)}const d=Vm(e,c,l.isFullyInitialized()||Ee(n),u.filtersNodes()),h=new hu(i,d,r);return Gm(t,d,n,i,h,a)}function fc(t,e,n,s,i,r,o){const a=e.eventCache;let l,c;const u=new hu(i,e,r);if(Ee(n))c=t.filter.updateFullNode(e.eventCache.getNode(),s,o),l=fr(e,c,!0,t.filter.filtersNodes());else{const d=Ce(n);if(d===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),s),l=fr(e,c,a.isFullyInitialized(),a.isFiltered());else{const h=He(n),p=a.getNode().getImmediateChild(d);let m;if(Ee(h))m=s;else{const w=u.getCompleteChild(d);w!=null?eu(h)===".priority"&&w.getChild(Nm(h)).isEmpty()?m=w:m=w.updateChild(h,s):m=fe.EMPTY_NODE}if(p.equals(m))l=e;else{const w=t.filter.updateChild(a.getNode(),d,m,h,u,o);l=fr(e,w,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function kh(t,e){return t.eventCache.isCompleteForChild(e)}function uE(t,e,n,s,i,r,o){let a=e;return s.foreach((l,c)=>{const u=Qe(n,l);kh(e,Ce(u))&&(a=fc(t,a,u,c,i,r,o))}),s.foreach((l,c)=>{const u=Qe(n,l);kh(e,Ce(u))||(a=fc(t,a,u,c,i,r,o))}),a}function Ah(t,e,n){return n.foreach((s,i)=>{e=e.updateChild(s,i)}),e}function pc(t,e,n,s,i,r,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;Ee(n)?c=s:c=new ze(null).setTree(n,s);const u=e.serverCache.getNode();return c.children.inorderTraversal((d,h)=>{if(u.hasChild(d)){const p=e.serverCache.getNode().getImmediateChild(d),m=Ah(t,p,h);l=Zo(t,l,new De(d),m,i,r,o,a)}}),c.children.inorderTraversal((d,h)=>{const p=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!u.hasChild(d)&&!p){const m=e.serverCache.getNode().getImmediateChild(d),w=Ah(t,m,h);l=Zo(t,l,new De(d),w,i,r,o,a)}}),l}function dE(t,e,n,s,i,r,o){if(Jo(i,n)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(s.value!=null){if(Ee(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return Zo(t,e,n,l.getNode().getChild(n),i,r,a,o);if(Ee(n)){let c=new ze(null);return l.getNode().forEachChild($s,(u,d)=>{c=c.set(new De(u),d)}),pc(t,e,n,c,i,r,a,o)}else return e}else{let c=new ze(null);return s.foreach((u,d)=>{const h=Qe(n,u);l.isCompleteForPath(h)&&(c=c.set(u,l.getNode().getChild(h)))}),pc(t,e,n,c,i,r,a,o)}}function hE(t,e,n,s,i){const r=e.serverCache,o=Vm(e,r.getNode(),r.isFullyInitialized()||Ee(n),r.isFiltered());return Gm(t,o,n,s,Km,i)}function fE(t,e,n,s,i,r){let o;if(Jo(s,n)!=null)return e;{const a=new hu(s,e,i),l=e.eventCache.getNode();let c;if(Ee(n)||Ce(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=Xo(s,zs(e));else{const d=e.serverCache.getNode();Y(d instanceof fe,"serverChildren would be complete if leaf node"),u=uu(s,d)}u=u,c=t.filter.updateFullNode(l,u,r)}else{const u=Ce(n);let d=du(s,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=l.getImmediateChild(u)),d!=null?c=t.filter.updateChild(l,u,d,He(n),a,r):e.eventCache.getNode().hasChild(u)?c=t.filter.updateChild(l,u,fe.EMPTY_NODE,He(n),a,r):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Xo(s,zs(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,r)))}return o=e.serverCache.isFullyInitialized()||Jo(s,xe())!=null,fr(e,c,o,t.filter.filtersNodes())}}class pE{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,i=new ru(s.getIndex()),r=PC(s);this.processor_=oE(r);const o=n.serverCache,a=n.eventCache,l=i.updateFullNode(fe.EMPTY_NODE,o.getNode(),null),c=r.updateFullNode(fe.EMPTY_NODE,a.getNode(),null),u=new ms(l,o.isFullyInitialized(),i.filtersNodes()),d=new ms(c,a.isFullyInitialized(),r.filtersNodes());this.viewCache_=Ua(d,u),this.eventGenerator_=new BC(this.query_)}get query(){return this.query_}}function mE(t){return t.viewCache_.serverCache.getNode()}function gE(t){return Qo(t.viewCache_)}function wE(t,e){const n=zs(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!Ee(e)&&!n.getImmediateChild(Ce(e)).isEmpty())?n.getChild(e):null}function xh(t){return t.eventRegistrations_.length===0}function vE(t,e){t.eventRegistrations_.push(e)}function Ph(t,e,n){const s=[];if(n){Y(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(r=>{const o=r.createCancelEvent(n,i);o&&s.push(o)})}if(e){let i=[];for(let r=0;r<t.eventRegistrations_.length;++r){const o=t.eventRegistrations_[r];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(r+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return s}function Rh(t,e,n,s){e.type===Kt.MERGE&&e.source.queryId!==null&&(Y(zs(t.viewCache_),"We should always have a full cache before handling merges"),Y(Qo(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,r=lE(t.processor_,i,e,n,s);return aE(t.processor_,r.viewCache),Y(r.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=r.viewCache,Ym(t,r.changes,r.viewCache.eventCache.getNode(),null)}function _E(t,e){const n=t.viewCache_.eventCache,s=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ke,(r,o)=>{s.push(Ti(r,o))}),n.isFullyInitialized()&&s.push(Um(n.getNode())),Ym(t,s,n.getNode(),e)}function Ym(t,e,n,s){const i=s?[s]:t.eventRegistrations_;return UC(t.eventGenerator_,e,n,i)}let ea;class Qm{constructor(){this.views=new Map}}function yE(t){Y(!ea,"__referenceConstructor has already been defined"),ea=t}function bE(){return Y(ea,"Reference.ts has not been loaded"),ea}function CE(t){return t.views.size===0}function fu(t,e,n,s){const i=e.source.queryId;if(i!==null){const r=t.views.get(i);return Y(r!=null,"SyncTree gave us an op for an invalid query."),Rh(r,e,n,s)}else{let r=[];for(const o of t.views.values())r=r.concat(Rh(o,e,n,s));return r}}function Xm(t,e,n,s,i){const r=e._queryIdentifier,o=t.views.get(r);if(!o){let a=Xo(n,i?s:null),l=!1;a?l=!0:s instanceof fe?(a=uu(n,s),l=!1):(a=fe.EMPTY_NODE,l=!1);const c=Ua(new ms(a,l,!1),new ms(s,i,!1));return new pE(e,c)}return o}function EE(t,e,n,s,i,r){const o=Xm(t,e,s,i,r);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),vE(o,n),_E(o,n)}function SE(t,e,n,s){const i=e._queryIdentifier,r=[];let o=[];const a=gs(t);if(i==="default")for(const[l,c]of t.views.entries())o=o.concat(Ph(c,n,s)),xh(c)&&(t.views.delete(l),c.query._queryParams.loadsAllData()||r.push(c.query));else{const l=t.views.get(i);l&&(o=o.concat(Ph(l,n,s)),xh(l)&&(t.views.delete(i),l.query._queryParams.loadsAllData()||r.push(l.query)))}return a&&!gs(t)&&r.push(new(bE())(e._repo,e._path)),{removed:r,events:o}}function Jm(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function ls(t,e){let n=null;for(const s of t.views.values())n=n||wE(s,e);return n}function Zm(t,e){if(e._queryParams.loadsAllData())return Ha(t);{const s=e._queryIdentifier;return t.views.get(s)}}function eg(t,e){return Zm(t,e)!=null}function gs(t){return Ha(t)!=null}function Ha(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let ta;function IE(t){Y(!ta,"__referenceConstructor has already been defined"),ta=t}function TE(){return Y(ta,"Reference.ts has not been loaded"),ta}let kE=1;class Nh{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ze(null),this.pendingWriteTree_=nE(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function pu(t,e,n,s,i){return jC(t.pendingWriteTree_,e,n,s,i),i?Bi(t,new js(au(),e,n)):[]}function AE(t,e,n,s){zC(t.pendingWriteTree_,e,n,s);const i=ze.fromObject(n);return Bi(t,new ki(au(),e,i))}function Xn(t,e,n=!1){const s=qC(t.pendingWriteTree_,e);if(KC(t.pendingWriteTree_,e)){let r=new ze(null);return s.snap!=null?r=r.set(xe(),!0):at(s.children,o=>{r=r.set(new De(o),!0)}),Bi(t,new Yo(s.path,r,n))}else return[]}function jr(t,e,n){return Bi(t,new js(lu(),e,n))}function xE(t,e,n){const s=ze.fromObject(n);return Bi(t,new ki(lu(),e,s))}function PE(t,e){return Bi(t,new Pr(lu(),e))}function RE(t,e,n){const s=mu(t,n);if(s){const i=gu(s),r=i.path,o=i.queryId,a=bt(r,e),l=new Pr(cu(o),a);return wu(t,r,l)}else return[]}function na(t,e,n,s,i=!1){const r=e._path,o=t.syncPointTree_.get(r);let a=[];if(o&&(e._queryIdentifier==="default"||eg(o,e))){const l=SE(o,e,n,s);CE(o)&&(t.syncPointTree_=t.syncPointTree_.remove(r));const c=l.removed;if(a=l.events,!i){const u=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(r,(h,p)=>gs(p));if(u&&!d){const h=t.syncPointTree_.subtree(r);if(!h.isEmpty()){const p=DE(h);for(let m=0;m<p.length;++m){const w=p[m],C=w.query,A=ig(t,w);t.listenProvider_.startListening(mr(C),Rr(t,C),A.hashFn,A.onComplete)}}}!d&&c.length>0&&!s&&(u?t.listenProvider_.stopListening(mr(e),null):c.forEach(h=>{const p=t.queryToTagMap.get(ja(h));t.listenProvider_.stopListening(mr(h),p)}))}ME(t,c)}return a}function tg(t,e,n,s){const i=mu(t,s);if(i!=null){const r=gu(i),o=r.path,a=r.queryId,l=bt(o,e),c=new js(cu(a),l,n);return wu(t,o,c)}else return[]}function NE(t,e,n,s){const i=mu(t,s);if(i){const r=gu(i),o=r.path,a=r.queryId,l=bt(o,e),c=ze.fromObject(n),u=new ki(cu(a),l,c);return wu(t,o,u)}else return[]}function mc(t,e,n,s=!1){const i=e._path;let r=null,o=!1;t.syncPointTree_.foreachOnPath(i,(h,p)=>{const m=bt(h,i);r=r||ls(p,m),o=o||gs(p)});let a=t.syncPointTree_.get(i);a?(o=o||gs(a),r=r||ls(a,xe())):(a=new Qm,t.syncPointTree_=t.syncPointTree_.set(i,a));let l;r!=null?l=!0:(l=!1,r=fe.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((p,m)=>{const w=ls(m,xe());w&&(r=r.updateImmediateChild(p,w))}));const c=eg(a,e);if(!c&&!e._queryParams.loadsAllData()){const h=ja(e);Y(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");const p=LE();t.queryToTagMap.set(h,p),t.tagToQueryMap.set(p,h)}const u=Va(t.pendingWriteTree_,i);let d=EE(a,e,n,u,r,l);if(!c&&!o&&!s){const h=Zm(a,e);d=d.concat($E(t,e,h))}return d}function Wa(t,e,n){const i=t.pendingWriteTree_,r=t.syncPointTree_.findOnPath(e,(o,a)=>{const l=bt(o,e),c=ls(a,l);if(c)return c});return jm(i,e,r,n,!0)}function OE(t,e){const n=e._path;let s=null;t.syncPointTree_.foreachOnPath(n,(c,u)=>{const d=bt(c,n);s=s||ls(u,d)});let i=t.syncPointTree_.get(n);i?s=s||ls(i,xe()):(i=new Qm,t.syncPointTree_=t.syncPointTree_.set(n,i));const r=s!=null,o=r?new ms(s,!0,!1):null,a=Va(t.pendingWriteTree_,e._path),l=Xm(i,e,a,r?o.getNode():fe.EMPTY_NODE,r);return gE(l)}function Bi(t,e){return ng(e,t.syncPointTree_,null,Va(t.pendingWriteTree_,xe()))}function ng(t,e,n,s){if(Ee(t.path))return sg(t,e,n,s);{const i=e.get(xe());n==null&&i!=null&&(n=ls(i,xe()));let r=[];const o=Ce(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){const c=n?n.getImmediateChild(o):null,u=zm(s,o);r=r.concat(ng(a,l,c,u))}return i&&(r=r.concat(fu(i,t,s,n))),r}}function sg(t,e,n,s){const i=e.get(xe());n==null&&i!=null&&(n=ls(i,xe()));let r=[];return e.children.inorderTraversal((o,a)=>{const l=n?n.getImmediateChild(o):null,c=zm(s,o),u=t.operationForChild(o);u&&(r=r.concat(sg(u,a,l,c)))}),i&&(r=r.concat(fu(i,t,s,n))),r}function ig(t,e){const n=e.query,s=Rr(t,n);return{hashFn:()=>(mE(e)||fe.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return s?RE(t,n._path,s):PE(t,n._path);{const r=P0(i,n);return na(t,n,null,r)}}}}function Rr(t,e){const n=ja(e);return t.queryToTagMap.get(n)}function ja(t){return t._path.toString()+"$"+t._queryIdentifier}function mu(t,e){return t.tagToQueryMap.get(e)}function gu(t){const e=t.indexOf("$");return Y(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new De(t.substr(0,e))}}function wu(t,e,n){const s=t.syncPointTree_.get(e);Y(s,"Missing sync point for query tag that we're tracking");const i=Va(t.pendingWriteTree_,e);return fu(s,n,i,null)}function DE(t){return t.fold((e,n,s)=>{if(n&&gs(n))return[Ha(n)];{let i=[];return n&&(i=Jm(n)),at(s,(r,o)=>{i=i.concat(o)}),i}})}function mr(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(TE())(t._repo,t._path):t}function ME(t,e){for(let n=0;n<e.length;++n){const s=e[n];if(!s._queryParams.loadsAllData()){const i=ja(s),r=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(r)}}}function LE(){return kE++}function $E(t,e,n){const s=e._path,i=Rr(t,e),r=ig(t,n),o=t.listenProvider_.startListening(mr(e),i,r.hashFn,r.onComplete),a=t.syncPointTree_.subtree(s);if(i)Y(!gs(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((c,u,d)=>{if(!Ee(c)&&u&&gs(u))return[Ha(u).query];{let h=[];return u&&(h=h.concat(Jm(u).map(p=>p.query))),at(d,(p,m)=>{h=h.concat(m)}),h}});for(let c=0;c<l.length;++c){const u=l[c];t.listenProvider_.stopListening(mr(u),Rr(t,u))}}return o}class vu{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new vu(n)}node(){return this.node_}}class _u{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Qe(this.path_,e);return new _u(this.syncTree_,n)}node(){return Wa(this.syncTree_,this.path_)}}const FE=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},Oh=function(t,e,n){if(!t||typeof t!="object")return t;if(Y(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return BE(t[".sv"],e,n);if(typeof t[".sv"]=="object")return UE(t[".sv"],e);Y(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},BE=function(t,e,n){if(t==="timestamp")return n.timestamp;Y(!1,"Unexpected server value: "+t)},UE=function(t,e,n){t.hasOwnProperty("increment")||Y(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const s=t.increment;typeof s!="number"&&Y(!1,"Unexpected increment value: "+s);const i=e.node();if(Y(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return s;const o=i.getValue();return typeof o!="number"?s:o+s},rg=function(t,e,n,s){return bu(e,new _u(n,t),s)},yu=function(t,e,n){return bu(t,new vu(e),n)};function bu(t,e,n){const s=t.getPriority().val(),i=Oh(s,e.getImmediateChild(".priority"),n);let r;if(t.isLeafNode()){const o=t,a=Oh(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new st(a,Ye(i)):t}else{const o=t;return r=o,i!==o.getPriority().val()&&(r=r.updatePriority(new st(i))),o.forEachChild(Ke,(a,l)=>{const c=bu(l,e.getImmediateChild(a),n);c!==l&&(r=r.updateImmediateChild(a,c))}),r}}class Cu{constructor(e="",n=null,s={children:{},childCount:0}){this.name=e,this.parent=n,this.node=s}}function za(t,e){let n=e instanceof De?e:new De(e),s=t,i=Ce(n);for(;i!==null;){const r=Us(s.node.children,i)||{children:{},childCount:0};s=new Cu(i,s,r),n=He(n),i=Ce(n)}return s}function Js(t){return t.node.value}function Eu(t,e){t.node.value=e,gc(t)}function og(t){return t.node.childCount>0}function VE(t){return Js(t)===void 0&&!og(t)}function qa(t,e){at(t.node.children,(n,s)=>{e(new Cu(n,t,s))})}function ag(t,e,n,s){n&&e(t),qa(t,i=>{ag(i,e,!0)})}function HE(t,e,n){let s=t.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function zr(t){return new De(t.parent===null?t.name:zr(t.parent)+"/"+t.name)}function gc(t){t.parent!==null&&WE(t.parent,t.name,t)}function WE(t,e,n){const s=VE(n),i=tn(t.node.children,e);s&&i?(delete t.node.children[e],t.node.childCount--,gc(t)):!s&&!i&&(t.node.children[e]=n.node,t.node.childCount++,gc(t))}const jE=/[\[\].#$\/\u0000-\u001F\u007F]/,zE=/[\[\].#$\u0000-\u001F\u007F]/,Nl=10*1024*1024,Su=function(t){return typeof t=="string"&&t.length!==0&&!jE.test(t)},lg=function(t){return typeof t=="string"&&t.length!==0&&!zE.test(t)},qE=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),lg(t)},Nr=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Fa(t)||t&&typeof t=="object"&&tn(t,".sv")},Or=function(t,e,n,s){s&&e===void 0||qr(Si(t,"value"),e,n)},qr=function(t,e,n){const s=n instanceof De?new uC(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Ps(s));if(typeof e=="function")throw new Error(t+"contains a function "+Ps(s)+" with contents = "+e.toString());if(Fa(e))throw new Error(t+"contains "+e.toString()+" "+Ps(s));if(typeof e=="string"&&e.length>Nl/3&&$a(e)>Nl)throw new Error(t+"contains a string greater than "+Nl+" utf8 bytes "+Ps(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,r=!1;if(at(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(r=!0,!Su(o)))throw new Error(t+" contains an invalid key ("+o+") "+Ps(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);dC(s,o),qr(t,a,s),hC(s)}),i&&r)throw new Error(t+' contains ".value" child '+Ps(s)+" in addition to actual children.")}},KE=function(t,e){let n,s;for(n=0;n<e.length;n++){s=e[n];const r=Tr(s);for(let o=0;o<r.length;o++)if(!(r[o]===".priority"&&o===r.length-1)){if(!Su(r[o]))throw new Error(t+"contains an invalid key ("+r[o]+") in path "+s.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(cC);let i=null;for(n=0;n<e.length;n++){if(s=e[n],i!==null&&Vt(i,s))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+s.toString());i=s}},cg=function(t,e,n,s){const i=Si(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const r=[];at(e,(o,a)=>{const l=new De(o);if(qr(i,a,Qe(n,l)),eu(l)===".priority"&&!Nr(a))throw new Error(i+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");r.push(l)}),KE(i,r)},GE=function(t,e,n){if(Fa(e))throw new Error(Si(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Nr(e))throw new Error(Si(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},Iu=function(t,e,n,s){if(!lg(n))throw new Error(Si(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},YE=function(t,e,n,s){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Iu(t,e,n)},Jn=function(t,e){if(Ce(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},QE=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Su(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!qE(n))throw new Error(Si(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};class XE{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Ka(t,e){let n=null;for(let s=0;s<e.length;s++){const i=e[s],r=i.getPath();n!==null&&!tu(r,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:r}),n.events.push(i)}n&&t.eventLists_.push(n)}function ug(t,e,n){Ka(t,n),dg(t,s=>tu(s,e))}function Dt(t,e,n){Ka(t,n),dg(t,s=>Vt(s,e)||Vt(e,s))}function dg(t,e){t.recursionDepth_++;let n=!0;for(let s=0;s<t.eventLists_.length;s++){const i=t.eventLists_[s];if(i){const r=i.path;e(r)?(JE(t.eventLists_[s]),t.eventLists_[s]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function JE(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const s=n.getEventRunner();dr&&rt("event: "+n.toString()),$i(s)}}}const ZE="repo_interrupt",eS=25;class tS{constructor(e,n,s,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=s,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new XE,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Go(),this.transactionQueueTree_=new Cu,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function nS(t,e,n){if(t.stats_=Jc(t.repoInfo_),t.forceRestClient_||D0())t.server_=new Ko(t.repoInfo_,(s,i,r,o)=>{Dh(t,s,i,r,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>Mh(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{nt(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}t.persistentConnection_=new An(t.repoInfo_,e,(s,i,r,o)=>{Dh(t,s,i,r,o)},s=>{Mh(t,s)},s=>{sS(t,s)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(s=>{t.server_.refreshAuthToken(s)}),t.appCheckProvider_.addTokenChangeListener(s=>{t.server_.refreshAppCheckToken(s.token)}),t.statsReporter_=B0(t.repoInfo_,()=>new FC(t.stats_,t.server_)),t.infoData_=new OC,t.infoSyncTree_=new Nh({startListening:(s,i,r,o)=>{let a=[];const l=t.infoData_.getNode(s._path);return l.isEmpty()||(a=jr(t.infoSyncTree_,s._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Tu(t,"connected",!1),t.serverSyncTree_=new Nh({startListening:(s,i,r,o)=>(t.server_.listen(s,r,i,(a,l)=>{const c=o(a,l);Dt(t.eventQueue_,s._path,c)}),[]),stopListening:(s,i)=>{t.server_.unlisten(s,i)}})}function hg(t){const n=t.infoData_.getNode(new De(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Kr(t){return FE({timestamp:hg(t)})}function Dh(t,e,n,s,i){t.dataUpdateCount++;const r=new De(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(s){const l=Ho(n,c=>Ye(c));o=NE(t.serverSyncTree_,r,l,i)}else{const l=Ye(n);o=tg(t.serverSyncTree_,r,l,i)}else if(s){const l=Ho(n,c=>Ye(c));o=xE(t.serverSyncTree_,r,l)}else{const l=Ye(n);o=jr(t.serverSyncTree_,r,l)}let a=r;o.length>0&&(a=xi(t,r)),Dt(t.eventQueue_,a,o)}function Mh(t,e){Tu(t,"connected",e),e===!1&&aS(t)}function sS(t,e){at(e,(n,s)=>{Tu(t,n,s)})}function Tu(t,e,n){const s=new De("/.info/"+e),i=Ye(n);t.infoData_.updateSnapshot(s,i);const r=jr(t.infoSyncTree_,s,i);Dt(t.eventQueue_,s,r)}function Ga(t){return t.nextWriteId_++}function iS(t,e,n){const s=OE(t.serverSyncTree_,e);return s!=null?Promise.resolve(s):t.server_.get(e).then(i=>{const r=Ye(i).withIndex(e._queryParams.getIndex());mc(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=jr(t.serverSyncTree_,e._path,r);else{const a=Rr(t.serverSyncTree_,e);o=tg(t.serverSyncTree_,e._path,r,a)}return Dt(t.eventQueue_,e._path,o),na(t.serverSyncTree_,e,n,null,!0),r},i=>(Ui(t,"get for query "+nt(e)+" failed: "+i),Promise.reject(new Error(i))))}function rS(t,e,n,s,i){Ui(t,"set",{path:e.toString(),value:n,priority:s});const r=Kr(t),o=Ye(n,s),a=Wa(t.serverSyncTree_,e),l=yu(o,a,r),c=Ga(t),u=pu(t.serverSyncTree_,e,l,c,!0);Ka(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),(h,p)=>{const m=h==="ok";m||Ct("set at "+e+" failed: "+h);const w=Xn(t.serverSyncTree_,c,!m);Dt(t.eventQueue_,e,w),ws(t,i,h,p)});const d=Au(t,e);xi(t,d),Dt(t.eventQueue_,d,[])}function oS(t,e,n,s){Ui(t,"update",{path:e.toString(),value:n});let i=!0;const r=Kr(t),o={};if(at(n,(a,l)=>{i=!1,o[a]=rg(Qe(e,a),Ye(l),t.serverSyncTree_,r)}),i)rt("update() called with empty data.  Don't do anything."),ws(t,s,"ok",void 0);else{const a=Ga(t),l=AE(t.serverSyncTree_,e,o,a);Ka(t.eventQueue_,l),t.server_.merge(e.toString(),n,(c,u)=>{const d=c==="ok";d||Ct("update at "+e+" failed: "+c);const h=Xn(t.serverSyncTree_,a,!d),p=h.length>0?xi(t,e):e;Dt(t.eventQueue_,p,h),ws(t,s,c,u)}),at(n,c=>{const u=Au(t,Qe(e,c));xi(t,u)}),Dt(t.eventQueue_,e,[])}}function aS(t){Ui(t,"onDisconnectEvents");const e=Kr(t),n=Go();cc(t.onDisconnect_,xe(),(i,r)=>{const o=rg(i,r,t.serverSyncTree_,e);Fi(n,i,o)});let s=[];cc(n,xe(),(i,r)=>{s=s.concat(jr(t.serverSyncTree_,i,r));const o=Au(t,i);xi(t,o)}),t.onDisconnect_=Go(),Dt(t.eventQueue_,xe(),s)}function lS(t,e,n){t.server_.onDisconnectCancel(e.toString(),(s,i)=>{s==="ok"&&lc(t.onDisconnect_,e),ws(t,n,s,i)})}function Lh(t,e,n,s){const i=Ye(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(r,o)=>{r==="ok"&&Fi(t.onDisconnect_,e,i),ws(t,s,r,o)})}function cS(t,e,n,s,i){const r=Ye(n,s);t.server_.onDisconnectPut(e.toString(),r.val(!0),(o,a)=>{o==="ok"&&Fi(t.onDisconnect_,e,r),ws(t,i,o,a)})}function uS(t,e,n,s){if(Vo(n)){rt("onDisconnect().update() called with empty data.  Don't do anything."),ws(t,s,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,r)=>{i==="ok"&&at(n,(o,a)=>{const l=Ye(a);Fi(t.onDisconnect_,Qe(e,o),l)}),ws(t,s,i,r)})}function dS(t,e,n){let s;Ce(e._path)===".info"?s=mc(t.infoSyncTree_,e,n):s=mc(t.serverSyncTree_,e,n),ug(t.eventQueue_,e._path,s)}function fg(t,e,n){let s;Ce(e._path)===".info"?s=na(t.infoSyncTree_,e,n):s=na(t.serverSyncTree_,e,n),ug(t.eventQueue_,e._path,s)}function hS(t){t.persistentConnection_&&t.persistentConnection_.interrupt(ZE)}function Ui(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),rt(n,...e)}function ws(t,e,n,s){e&&$i(()=>{if(n==="ok")e(null);else{const i=(n||"error").toUpperCase();let r=i;s&&(r+=": "+s);const o=new Error(r);o.code=i,e(o)}})}function fS(t,e,n,s,i,r){Ui(t,"transaction on "+e);const o={path:e,update:n,onComplete:s,status:null,order:um(),applyLocally:r,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=ku(t,e,void 0);o.currentInputSnapshot=a;const l=o.update(a.val());if(l===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{qr("transaction failed: Data returned ",l,o.path),o.status=0;const c=za(t.transactionQueueTree_,e),u=Js(c)||[];u.push(o),Eu(c,u);let d;typeof l=="object"&&l!==null&&tn(l,".priority")?(d=Us(l,".priority"),Y(Nr(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(Wa(t.serverSyncTree_,e)||fe.EMPTY_NODE).getPriority().val();const h=Kr(t),p=Ye(l,d),m=yu(p,a,h);o.currentOutputSnapshotRaw=p,o.currentOutputSnapshotResolved=m,o.currentWriteId=Ga(t);const w=pu(t.serverSyncTree_,e,m,o.currentWriteId,o.applyLocally);Dt(t.eventQueue_,e,w),Ya(t,t.transactionQueueTree_)}}function ku(t,e,n){return Wa(t.serverSyncTree_,e,n)||fe.EMPTY_NODE}function Ya(t,e=t.transactionQueueTree_){if(e||Qa(t,e),Js(e)){const n=mg(t,e);Y(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&pS(t,zr(e),n)}else og(e)&&qa(e,n=>{Ya(t,n)})}function pS(t,e,n){const s=n.map(c=>c.currentWriteId),i=ku(t,e,s);let r=i;const o=i.hash();for(let c=0;c<n.length;c++){const u=n[c];Y(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const d=bt(e,u.path);r=r.updateChild(d,u.currentOutputSnapshotRaw)}const a=r.val(!0),l=e;t.server_.put(l.toString(),a,c=>{Ui(t,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){const d=[];for(let h=0;h<n.length;h++)n[h].status=2,u=u.concat(Xn(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();Qa(t,za(t.transactionQueueTree_,e)),Ya(t,t.transactionQueueTree_),Dt(t.eventQueue_,e,u);for(let h=0;h<d.length;h++)$i(d[h])}else{if(c==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{Ct("transaction at "+l.toString()+" failed: "+c);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=c}xi(t,e)}},o)}function xi(t,e){const n=pg(t,e),s=zr(n),i=mg(t,n);return mS(t,i,s),s}function mS(t,e,n){if(e.length===0)return;const s=[];let i=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],c=bt(n,l.path);let u=!1,d;if(Y(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,d=l.abortReason,i=i.concat(Xn(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=eS)u=!0,d="maxretry",i=i.concat(Xn(t.serverSyncTree_,l.currentWriteId,!0));else{const h=ku(t,l.path,o);l.currentInputSnapshot=h;const p=e[a].update(h.val());if(p!==void 0){qr("transaction failed: Data returned ",p,l.path);let m=Ye(p);typeof p=="object"&&p!=null&&tn(p,".priority")||(m=m.updatePriority(h.getPriority()));const C=l.currentWriteId,A=Kr(t),W=yu(m,h,A);l.currentOutputSnapshotRaw=m,l.currentOutputSnapshotResolved=W,l.currentWriteId=Ga(t),o.splice(o.indexOf(C),1),i=i.concat(pu(t.serverSyncTree_,l.path,W,l.currentWriteId,l.applyLocally)),i=i.concat(Xn(t.serverSyncTree_,C,!0))}else u=!0,d="nodata",i=i.concat(Xn(t.serverSyncTree_,l.currentWriteId,!0))}Dt(t.eventQueue_,n,i),i=[],u&&(e[a].status=2,(function(h){setTimeout(h,Math.floor(0))})(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?s.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):s.push(()=>e[a].onComplete(new Error(d),!1,null))))}Qa(t,t.transactionQueueTree_);for(let a=0;a<s.length;a++)$i(s[a]);Ya(t,t.transactionQueueTree_)}function pg(t,e){let n,s=t.transactionQueueTree_;for(n=Ce(e);n!==null&&Js(s)===void 0;)s=za(s,n),e=He(e),n=Ce(e);return s}function mg(t,e){const n=[];return gg(t,e,n),n.sort((s,i)=>s.order-i.order),n}function gg(t,e,n){const s=Js(e);if(s)for(let i=0;i<s.length;i++)n.push(s[i]);qa(e,i=>{gg(t,i,n)})}function Qa(t,e){const n=Js(e);if(n){let s=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[s]=n[i],s++);n.length=s,Eu(e,n.length>0?n:void 0)}qa(e,s=>{Qa(t,s)})}function Au(t,e){const n=zr(pg(t,e)),s=za(t.transactionQueueTree_,e);return HE(s,i=>{Ol(t,i)}),Ol(t,s),ag(s,i=>{Ol(t,i)}),n}function Ol(t,e){const n=Js(e);if(n){const s=[];let i=[],r=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(Y(r===o-1,"All SENT items should be at beginning of queue."),r=o,n[o].status=3,n[o].abortReason="set"):(Y(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(Xn(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&s.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));r===-1?Eu(e,void 0):n.length=r+1,Dt(t.eventQueue_,zr(e),i);for(let o=0;o<s.length;o++)$i(s[o])}}function gS(t){let e="";const n=t.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let i=n[s];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function wS(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const s=n.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Ct(`Invalid query segment '${n}' in query '${t}'`)}return e}const $h=function(t,e){const n=vS(t),s=n.namespace;n.domain==="firebase.com"&&Dn(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&n.domain!=="localhost"&&Dn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||I0();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Em(n.host,n.secure,s,i,e,"",s!==n.subdomain),path:new De(n.pathString)}},vS=function(t){let e="",n="",s="",i="",r="",o=!0,a="https",l=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let u=t.indexOf("/");u===-1&&(u=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(u,d)),u<d&&(i=gS(t.substring(u,d)));const h=wS(t.substring(Math.min(t.length,d)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;const p=e.slice(0,c);if(p.toLowerCase()==="localhost")n="localhost";else if(p.split(".").length<=2)n=p;else{const m=e.indexOf(".");s=e.substring(0,m).toLowerCase(),n=e.substring(m+1),r=s}"ns"in h&&(r=h.ns)}return{host:e,port:l,domain:n,subdomain:s,secure:o,scheme:a,pathString:i,namespace:r}};const Fh="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",_S=(function(){let t=0;const e=[];return function(n){const s=n===t;t=n;let i;const r=new Array(8);for(i=7;i>=0;i--)r[i]=Fh.charAt(n%64),n=Math.floor(n/64);Y(n===0,"Cannot push at time == 0");let o=r.join("");if(s){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=Fh.charAt(e[i]);return Y(o.length===20,"nextPushId: Length should be 20."),o}})();class wg{constructor(e,n,s,i){this.eventType=e,this.eventRegistration=n,this.snapshot=s,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+nt(this.snapshot.exportVal())}}class vg{constructor(e,n,s){this.eventRegistration=e,this.error=n,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class xu{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return Y(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class yS{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new jt;return lS(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Jn("OnDisconnect.remove",this._path);const e=new jt;return Lh(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Jn("OnDisconnect.set",this._path),Or("OnDisconnect.set",e,this._path,!1);const n=new jt;return Lh(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){Jn("OnDisconnect.setWithPriority",this._path),Or("OnDisconnect.setWithPriority",e,this._path,!1),GE("OnDisconnect.setWithPriority",n);const s=new jt;return cS(this._repo,this._path,e,n,s.wrapCallback(()=>{})),s.promise}update(e){Jn("OnDisconnect.update",this._path),cg("OnDisconnect.update",e,this._path);const n=new jt;return uS(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}class Gr{constructor(e,n,s,i){this._repo=e,this._path=n,this._queryParams=s,this._orderByCalled=i}get key(){return Ee(this._path)?null:eu(this._path)}get ref(){return new nn(this._repo,this._path)}get _queryIdentifier(){const e=Ch(this._queryParams),n=Qc(e);return n==="{}"?"default":n}get _queryObject(){return Ch(this._queryParams)}isEqual(e){if(e=dt(e),!(e instanceof Gr))return!1;const n=this._repo===e._repo,s=tu(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&s&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+lC(this._path)}}function bS(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function _g(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===$s){const s="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==Ws)throw new Error(s);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==fs)throw new Error(s);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Ke){if(e!=null&&!Nr(e)||n!=null&&!Nr(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Y(t.getIndex()instanceof iu||t.getIndex()===Bm,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function CS(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class nn extends Gr{constructor(e,n){super(e,n,new ou,!1)}get parent(){const e=Nm(this._path);return e===null?null:new nn(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class qs{constructor(e,n,s){this._node=e,this.ref=n,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new De(e),s=vs(this.ref,e);return new qs(this._node.getChild(n),s,Ke)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(s,i)=>e(new qs(i,vs(this.ref,s),Ke)))}hasChild(e){const n=new De(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function pe(t,e){return t=dt(t),t._checkNotDeleted("ref"),e!==void 0?vs(t._root,e):t._root}function vs(t,e){return t=dt(t),Ce(t._path)===null?YE("child","path",e):Iu("child","path",e),new nn(t._repo,Qe(t._path,e))}function ES(t){return t=dt(t),new yS(t._repo,t._path)}function yg(t,e){t=dt(t),Jn("push",t._path),Or("push",e,t._path,!0);const n=hg(t._repo),s=_S(n),i=vs(t,s),r=vs(t,s);let o;return e!=null?o=hn(r,e).then(()=>r):o=Promise.resolve(r),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function mi(t){return Jn("remove",t._path),hn(t,null)}function hn(t,e){t=dt(t),Jn("set",t._path),Or("set",e,t._path,!1);const n=new jt;return rS(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function Gt(t,e){cg("update",e,t._path);const n=new jt;return oS(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function li(t){t=dt(t);const e=new xu(()=>{}),n=new Xa(e);return iS(t._repo,t,n).then(s=>new qs(s,new nn(t._repo,t._path),t._queryParams.getIndex()))}class Xa{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const s=n._queryParams.getIndex();return new wg("value",this,new qs(e.snapshotNode,new nn(n._repo,n._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new vg(this,e,n):null}matches(e){return e instanceof Xa?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class Ja{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new vg(this,e,n):null}createEvent(e,n){Y(e.childName!=null,"Child events should have a childName.");const s=vs(new nn(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new wg(e.type,this,new qs(e.snapshotNode,s,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Ja?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function bg(t,e,n,s,i){const r=new xu(n,void 0),o=e==="value"?new Xa(r):new Ja(e,r);return dS(t._repo,t,o),()=>fg(t._repo,t,o)}function pt(t,e,n,s){return bg(t,"value",e)}function SS(t,e,n,s){return bg(t,"child_added",e)}function Bh(t,e,n){let s=null;const i=n?new xu(n):null;s=new Ja(e,i),fg(t._repo,t,s)}class Cg{}class IS extends Cg{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){Or("endAt",this._value,e._path,!0);const n=RC(e._queryParams,this._value,this._key);if(CS(n),_g(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Gr(e._repo,e._path,n,e._orderByCalled)}}function TS(t,e){return new IS(t,e)}class kS extends Cg{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){bS(e,"orderByChild");const n=new De(this._path);if(Ee(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const s=new iu(n),i=NC(e._queryParams,s);return _g(i),new Gr(e._repo,e._path,i,!0)}}function AS(t){return Iu("orderByChild","path",t),new kS(t)}function xS(t,...e){let n=dt(t);for(const s of e)n=s._apply(n);return n}yE(nn);IE(nn);const PS="FIREBASE_DATABASE_EMULATOR_HOST",wc={};let RS=!1;function NS(t,e,n,s){const i=e.lastIndexOf(":"),r=e.substring(0,i),o=Di(r);t.repoInfo_=new Em(e,o,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),s&&(t.authTokenProvider_=s)}function OS(t,e,n,s,i){let r=s||t.options.databaseURL;r===void 0&&(t.options.projectId||Dn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),rt("Using default host for project ",t.options.projectId),r=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=$h(r,i),a=o.repoInfo,l;typeof process<"u"&&ih&&(l=ih[PS]),l?(r=`http://${l}?ns=${a.namespace}`,o=$h(r,i),a=o.repoInfo):o.repoInfo.secure;const c=new L0(t.name,t.options,e);QE("Invalid Firebase Database URL",o),Ee(o.path)||Dn("Database URL must point to the root of a Firebase Database (not including a child path).");const u=MS(a,t,c,new M0(t,n));return new LS(u,t)}function DS(t,e){const n=wc[e];(!n||n[t.key]!==t)&&Dn(`Database ${e}(${t.repoInfo_}) has already been deleted.`),hS(t),delete n[t.key]}function MS(t,e,n,s){let i=wc[e.name];i||(i={},wc[e.name]=i);let r=i[t.toURLString()];return r&&Dn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new tS(t,RS,n,s),i[t.toURLString()]=r,r}class LS{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(nS(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new nn(this._repo,xe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(DS(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Dn("Cannot call "+e+" on a deleted database.")}}function $S(t=rm(),e){const n=Yc(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const s=qy("database");s&&FS(n,...s)}return n}function FS(t,e,n,s={}){t=dt(t),t._checkNotDeleted("useEmulator");const i=`${e}:${n}`,r=t._repoInternal;if(t._instanceStarted){if(i===t._repoInternal.repoInfo_.host&&Vs(s,r.repoInfo_.emulatorOptions))return;Dn("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(r.repoInfo_.nodeAdmin)s.mockUserToken&&Dn('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new bo(bo.OWNER);else if(s.mockUserToken){const a=typeof s.mockUserToken=="string"?s.mockUserToken:Ky(s.mockUserToken,t.app.options.projectId);o=new bo(a)}Di(e)&&(Jp(e),Zp("Database",!0)),NS(r,i,s,o)}function BS(t){y0(Li),Ii(new Hs("database",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return OS(s,i,r,n)},"PUBLIC").setMultipleInstances(!0)),os(rh,oh,t),os(rh,oh,"esm2020")}class US{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function VS(t,e,n){if(t=dt(t),Jn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const s=!0,i=new jt,r=(a,l,c)=>{let u=null;a?i.reject(a):(u=new qs(c,new nn(t._repo,t._path),Ke),i.resolve(new US(l,u)))},o=pt(t,()=>{});return fS(t._repo,t._path,e,r,o,s),i.promise}An.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};An.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};BS();var HS="firebase",WS="12.7.0";os(HS,WS,"app");function Eg(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const jS=Eg,Sg=new Ur("auth","Firebase",Eg());const sa=new Kc("@firebase/auth");function zS(t,...e){sa.logLevel<=Be.WARN&&sa.warn(`Auth (${Li}): ${t}`,...e)}function Co(t,...e){sa.logLevel<=Be.ERROR&&sa.error(`Auth (${Li}): ${t}`,...e)}function Mn(t,...e){throw Pu(t,...e)}function fn(t,...e){return Pu(t,...e)}function Ig(t,e,n){const s={...jS(),[e]:n};return new Ur("auth","Firebase",s).create(e,{appName:t.name})}function cs(t){return Ig(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Pu(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return Sg.create(t,...e)}function we(t,e,...n){if(!t)throw Pu(e,...n)}function Sn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Co(e),new Error(e)}function Ln(t,e){t||Sn(e)}function vc(){return typeof self<"u"&&self.location?.href||""}function qS(){return Uh()==="http:"||Uh()==="https:"}function Uh(){return typeof self<"u"&&self.location?.protocol||null}function KS(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(qS()||Xy()||"connection"in navigator)?navigator.onLine:!0}function GS(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class Yr{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ln(n>e,"Short delay should be less than long delay!"),this.isMobile=qc()||em()}get(){return KS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Ru(t,e){Ln(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class Tg{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Sn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Sn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Sn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const YS={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const QS=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],XS=new Yr(3e4,6e4);function Za(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Vi(t,e,n,s,i={}){return kg(t,i,async()=>{let r={},o={};s&&(e==="GET"?o=s:r={body:JSON.stringify(s)});const a=Mi({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c={method:e,headers:l,...r};return Qy()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&Di(t.emulatorConfig.host)&&(c.credentials="include"),Tg.fetch()(await xg(t,t.config.apiHost,n,a),c)})}async function kg(t,e,n){t._canInitEmulator=!1;const s={...YS,...e};try{const i=new JS(t),r=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw fo(t,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const a=r.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw fo(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw fo(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw fo(t,"user-disabled",o);const u=s[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Ig(t,u,c);Mn(t,u)}}catch(i){if(i instanceof bs)throw i;Mn(t,"network-request-failed",{message:String(i)})}}async function Ag(t,e,n,s,i={}){const r=await Vi(t,e,n,s,i);return"mfaPendingCredential"in r&&Mn(t,"multi-factor-auth-required",{_serverResponse:r}),r}async function xg(t,e,n,s){const i=`${e}${n}?${s}`,r=t,o=r.config.emulator?Ru(t.config,i):`${t.config.apiScheme}://${i}`;return QS.includes(n)&&(await r._persistenceManagerAvailable,r._getPersistenceType()==="COOKIE")?r._getPersistence()._getFinalTarget(o).toString():o}class JS{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(fn(this.auth,"network-request-failed")),XS.get())})}}function fo(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const i=fn(t,e,s);return i.customData._tokenResponse=n,i}async function ZS(t,e){return Vi(t,"POST","/v1/accounts:delete",e)}async function ia(t,e){return Vi(t,"POST","/v1/accounts:lookup",e)}function gr(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function eI(t,e=!1){const n=dt(t),s=await n.getIdToken(e),i=Nu(s);we(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const r=typeof i.firebase=="object"?i.firebase:void 0,o=r?.sign_in_provider;return{claims:i,token:s,authTime:gr(Dl(i.auth_time)),issuedAtTime:gr(Dl(i.iat)),expirationTime:gr(Dl(i.exp)),signInProvider:o||null,signInSecondFactor:r?.sign_in_second_factor||null}}function Dl(t){return Number(t)*1e3}function Nu(t){const[e,n,s]=t.split(".");if(e===void 0||n===void 0||s===void 0)return Co("JWT malformed, contained fewer than 3 sections"),null;try{const i=Uo(n);return i?JSON.parse(i):(Co("Failed to decode base64 JWT payload"),null)}catch(i){return Co("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Vh(t){const e=Nu(t);return we(e,"internal-error"),we(typeof e.exp<"u","internal-error"),we(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Dr(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof bs&&tI(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function tI({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class nI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class _c{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=gr(this.lastLoginAt),this.creationTime=gr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ra(t){const e=t.auth,n=await t.getIdToken(),s=await Dr(t,ia(e,{idToken:n}));we(s?.users.length,e,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const r=i.providerUserInfo?.length?Pg(i.providerUserInfo):[],o=iI(t.providerData,r),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!o?.length,c=a?l:!1,u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new _c(i.createdAt,i.lastLoginAt),isAnonymous:c};Object.assign(t,u)}async function sI(t){const e=dt(t);await ra(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function iI(t,e){return[...t.filter(s=>!e.some(i=>i.providerId===s.providerId)),...e]}function Pg(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function rI(t,e){const n=await kg(t,{},async()=>{const s=Mi({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:r}=t.config,o=await xg(t,i,"/v1/token",`key=${r}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:s};return t.emulatorConfig&&Di(t.emulatorConfig.host)&&(l.credentials="include"),Tg.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function oI(t,e){return Vi(t,"POST","/v2/accounts:revokeToken",Za(t,e))}class gi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){we(e.idToken,"internal-error"),we(typeof e.idToken<"u","internal-error"),we(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Vh(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){we(e.length!==0,"internal-error");const n=Vh(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(we(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:i,expiresIn:r}=await rI(e,n);this.updateTokensAndExpiration(s,i,Number(r))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:i,expirationTime:r}=n,o=new gi;return s&&(we(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),i&&(we(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),r&&(we(typeof r=="number","internal-error",{appName:e}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new gi,this.toJSON())}_performRefresh(){return Sn("not implemented")}}function Bn(t,e){we(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Yt{constructor({uid:e,auth:n,stsTokenManager:s,...i}){this.providerId="firebase",this.proactiveRefresh=new nI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new _c(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Dr(this,this.stsTokenManager.getToken(this.auth,e));return we(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return eI(this,e)}reload(){return sI(this)}_assign(e){this!==e&&(we(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Yt({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){we(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await ra(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(zt(this.auth.app))return Promise.reject(cs(this.auth));const e=await this.getIdToken();return await Dr(this,ZS(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const s=n.displayName??void 0,i=n.email??void 0,r=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,c=n.createdAt??void 0,u=n.lastLoginAt??void 0,{uid:d,emailVerified:h,isAnonymous:p,providerData:m,stsTokenManager:w}=n;we(d&&w,e,"internal-error");const C=gi.fromJSON(this.name,w);we(typeof d=="string",e,"internal-error"),Bn(s,e.name),Bn(i,e.name),we(typeof h=="boolean",e,"internal-error"),we(typeof p=="boolean",e,"internal-error"),Bn(r,e.name),Bn(o,e.name),Bn(a,e.name),Bn(l,e.name),Bn(c,e.name),Bn(u,e.name);const A=new Yt({uid:d,auth:e,email:i,emailVerified:h,displayName:s,isAnonymous:p,photoURL:o,phoneNumber:r,tenantId:a,stsTokenManager:C,createdAt:c,lastLoginAt:u});return m&&Array.isArray(m)&&(A.providerData=m.map(W=>({...W}))),l&&(A._redirectEventId=l),A}static async _fromIdTokenResponse(e,n,s=!1){const i=new gi;i.updateFromServerResponse(n);const r=new Yt({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:s});return await ra(r),r}static async _fromGetAccountInfoResponse(e,n,s){const i=n.users[0];we(i.localId!==void 0,"internal-error");const r=i.providerUserInfo!==void 0?Pg(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!r?.length,a=new gi;a.updateFromIdToken(s);const l=new Yt({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new _c(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!r?.length};return Object.assign(l,c),l}}const Hh=new Map;function In(t){Ln(t instanceof Function,"Expected a class definition");let e=Hh.get(t);return e?(Ln(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Hh.set(t,e),e)}class Rg{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Rg.type="NONE";const Wh=Rg;function Eo(t,e,n){return`firebase:${t}:${e}:${n}`}class wi{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:i,name:r}=this.auth;this.fullUserKey=Eo(this.userKey,i.apiKey,r),this.fullPersistenceKey=Eo("persistence",i.apiKey,r),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await ia(this.auth,{idToken:e}).catch(()=>{});return n?Yt._fromGetAccountInfoResponse(this.auth,n,e):null}return Yt._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new wi(In(Wh),e,s);const i=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let r=i[0]||In(Wh);const o=Eo(s,e.config.apiKey,e.name);let a=null;for(const c of n)try{const u=await c._get(o);if(u){let d;if(typeof u=="string"){const h=await ia(e,{idToken:u}).catch(()=>{});if(!h)break;d=await Yt._fromGetAccountInfoResponse(e,h,u)}else d=Yt._fromJSON(e,u);c!==r&&(a=d),r=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!r._shouldAllowMigration||!l.length?new wi(r,e,s):(r=l[0],a&&await r._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==r)try{await c._remove(o)}catch{}})),new wi(r,e,s))}}function jh(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Mg(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ng(e))return"Firefox";if(e.includes("silk/"))return"Silk";if($g(e))return"Blackberry";if(Fg(e))return"Webos";if(Og(e))return"Safari";if((e.includes("chrome/")||Dg(e))&&!e.includes("edge/"))return"Chrome";if(Lg(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if(s?.length===2)return s[1]}return"Other"}function Ng(t=St()){return/firefox\//i.test(t)}function Og(t=St()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Dg(t=St()){return/crios\//i.test(t)}function Mg(t=St()){return/iemobile/i.test(t)}function Lg(t=St()){return/android/i.test(t)}function $g(t=St()){return/blackberry/i.test(t)}function Fg(t=St()){return/webos/i.test(t)}function Ou(t=St()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function aI(t=St()){return Ou(t)&&!!window.navigator?.standalone}function lI(){return Jy()&&document.documentMode===10}function Bg(t=St()){return Ou(t)||Lg(t)||Fg(t)||$g(t)||/windows phone/i.test(t)||Mg(t)}function Ug(t,e=[]){let n;switch(t){case"Browser":n=jh(St());break;case"Worker":n=`${jh(St())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Li}/${s}`}class cI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=r=>new Promise((o,a)=>{try{const l=e(r);o(l)}catch(l){a(l)}});s.onAbort=n,this.queue.push(s);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const s of this.queue)await s(e),s.onAbort&&n.push(s.onAbort)}catch(s){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}async function uI(t,e={}){return Vi(t,"GET","/v2/passwordPolicy",Za(t,e))}const dI=6;class hI{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??dI,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const s=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;s&&(n.meetsMinPasswordLength=e.length>=s),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let s;for(let i=0;i<e.length;i++)s=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,n,s,i,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}class fI{constructor(e,n,s,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=s,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new zh(this),this.idTokenSubscription=new zh(this),this.beforeStateQueue=new cI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Sg,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(r=>this._resolvePersistenceManagerAvailable=r)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=In(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await wi.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await ia(this,{idToken:e}),s=await Yt._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(s)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(zt(this.app)){const r=this.app.settings.authIdToken;return r?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(r).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=this.redirectUser?._redirectEventId,o=s?._redirectEventId,a=await this.tryRedirectSignIn(e);(!r||r===o)&&a?.user&&(s=a.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(r){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(r))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return we(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await ra(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=GS()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(zt(this.app))return Promise.reject(cs(this));const n=e?dt(e):null;return n&&we(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&we(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return zt(this.app)?Promise.reject(cs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return zt(this.app)?Promise.reject(cs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(In(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await uI(this),n=new hI(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ur("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(s.tenantId=this.tenantId),await oI(this,s)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&In(e)||this._popupRedirectResolver;we(n,this,"argument-error"),this.redirectPersistenceManager=await wi.create(this,[In(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,i){if(this._deleted)return()=>{};const r=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(we(a,this,"internal-error"),a.then(()=>{o||r(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,s,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return we(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ug(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){if(zt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&zS(`Error while retrieving App Check token: ${e.error}`),e?.token}}function el(t){return dt(t)}class zh{constructor(e){this.auth=e,this.observer=null,this.addObserver=lb(n=>this.observer=n)}get next(){return we(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Du={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function pI(t){Du=t}function mI(t){return Du.loadJS(t)}function gI(){return Du.gapiScript}function wI(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function vI(t,e){const n=Yc(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),r=n.getOptions();if(Vs(r,e??{}))return i;Mn(i,"already-initialized")}return n.initialize({options:e})}function _I(t,e){const n=e?.persistence||[],s=(Array.isArray(n)?n:[n]).map(In);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e?.popupRedirectResolver)}function yI(t,e,n){const s=el(t);we(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const i=!1,r=Vg(e),{host:o,port:a}=bI(e),l=a===null?"":`:${a}`,c={url:`${r}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!s._canInitEmulator){we(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),we(Vs(c,s.config.emulator)&&Vs(u,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=c,s.emulatorConfig=u,s.settings.appVerificationDisabledForTesting=!0,Di(o)?(Jp(`${r}//${o}${l}`),Zp("Auth",!0)):CI()}function Vg(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function bI(t){const e=Vg(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(s);if(i){const r=i[1];return{host:r,port:qh(s.substr(r.length+1))}}else{const[r,o]=s.split(":");return{host:r,port:qh(o)}}}function qh(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function CI(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class Hg{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Sn("not implemented")}_getIdTokenResponse(e){return Sn("not implemented")}_linkToIdToken(e,n){return Sn("not implemented")}_getReauthenticationResolver(e){return Sn("not implemented")}}async function vi(t,e){return Ag(t,"POST","/v1/accounts:signInWithIdp",Za(t,e))}const EI="http://localhost";class Ks extends Hg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ks(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Mn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:i,...r}=n;if(!s||!i)return null;const o=new Ks(s,i);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return vi(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,vi(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,vi(e,n)}buildRequest(){const e={requestUri:EI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Mi(n)}return e}}class Wg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Qr extends Wg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class qn extends Qr{constructor(){super("facebook.com")}static credential(e){return Ks._fromParams({providerId:qn.PROVIDER_ID,signInMethod:qn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qn.credentialFromTaggedObject(e)}static credentialFromError(e){return qn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qn.credential(e.oauthAccessToken)}catch{return null}}}qn.FACEBOOK_SIGN_IN_METHOD="facebook.com";qn.PROVIDER_ID="facebook.com";class Kn extends Qr{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ks._fromParams({providerId:Kn.PROVIDER_ID,signInMethod:Kn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Kn.credentialFromTaggedObject(e)}static credentialFromError(e){return Kn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return Kn.credential(n,s)}catch{return null}}}Kn.GOOGLE_SIGN_IN_METHOD="google.com";Kn.PROVIDER_ID="google.com";class Gn extends Qr{constructor(){super("github.com")}static credential(e){return Ks._fromParams({providerId:Gn.PROVIDER_ID,signInMethod:Gn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gn.credentialFromTaggedObject(e)}static credentialFromError(e){return Gn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gn.credential(e.oauthAccessToken)}catch{return null}}}Gn.GITHUB_SIGN_IN_METHOD="github.com";Gn.PROVIDER_ID="github.com";class Yn extends Qr{constructor(){super("twitter.com")}static credential(e,n){return Ks._fromParams({providerId:Yn.PROVIDER_ID,signInMethod:Yn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Yn.credentialFromTaggedObject(e)}static credentialFromError(e){return Yn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return Yn.credential(n,s)}catch{return null}}}Yn.TWITTER_SIGN_IN_METHOD="twitter.com";Yn.PROVIDER_ID="twitter.com";async function SI(t,e){return Ag(t,"POST","/v1/accounts:signUp",Za(t,e))}class _s{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,i=!1){const r=await Yt._fromIdTokenResponse(e,s,i),o=Kh(s);return new _s({user:r,providerId:o,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const i=Kh(s);return new _s({user:e,providerId:i,_tokenResponse:s,operationType:n})}}function Kh(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}async function II(t){if(zt(t.app))return Promise.reject(cs(t));const e=el(t);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new _s({user:e.currentUser,providerId:null,operationType:"signIn"});const n=await SI(e,{returnSecureToken:!0}),s=await _s._fromIdTokenResponse(e,"signIn",n,!0);return await e._updateCurrentUser(s.user),s}class oa extends bs{constructor(e,n,s,i){super(n.code,n.message),this.operationType=s,this.user=i,Object.setPrototypeOf(this,oa.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,i){return new oa(e,n,s,i)}}function jg(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?oa._fromErrorAndOperation(t,r,e,s):r})}async function TI(t,e,n=!1){const s=await Dr(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return _s._forOperation(t,"link",s)}async function kI(t,e,n=!1){const{auth:s}=t;if(zt(s.app))return Promise.reject(cs(s));const i="reauthenticate";try{const r=await Dr(t,jg(s,i,e,t),n);we(r.idToken,s,"internal-error");const o=Nu(r.idToken);we(o,s,"internal-error");const{sub:a}=o;return we(t.uid===a,s,"user-mismatch"),_s._forOperation(t,i,r)}catch(r){throw r?.code==="auth/user-not-found"&&Mn(s,"user-mismatch"),r}}async function AI(t,e,n=!1){if(zt(t.app))return Promise.reject(cs(t));const s="signIn",i=await jg(t,s,e),r=await _s._fromIdTokenResponse(t,s,i);return n||await t._updateCurrentUser(r.user),r}function xI(t,e,n,s){return dt(t).onIdTokenChanged(e,n,s)}function PI(t,e,n){return dt(t).beforeAuthStateChanged(e,n)}function RI(t,e,n,s){return dt(t).onAuthStateChanged(e,n,s)}const aa="__sak";class zg{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(aa,"1"),this.storage.removeItem(aa),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const NI=1e3,OI=10;class qg extends zg{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Bg(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),i=this.localCache[n];s!==i&&e(n,i,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const s=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(s);!n&&this.localCache[s]===o||this.notifyListeners(s,o)},r=this.storage.getItem(s);lI()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,OI):i()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},NI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}qg.type="LOCAL";const DI=qg;class Kg extends zg{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Kg.type="SESSION";const Gg=Kg;function MI(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class tl{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const s=new tl(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:i,data:r}=n.data,o=this.handlersMap[i];if(!o?.size)return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:i});const a=Array.from(o).map(async c=>c(n.origin,r)),l=await MI(a);n.ports[0].postMessage({status:"done",eventId:s,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}tl.receivers=[];function Mu(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}class LI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,o;return new Promise((a,l)=>{const c=Mu("",20);i.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},s);o={messageChannel:i,onMessage(d){const h=d;if(h.data.eventId===c)switch(h.data.status){case"ack":clearTimeout(u),r=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),a(h.data.response);break;default:clearTimeout(u),clearTimeout(r),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function pn(){return window}function $I(t){pn().location.href=t}function Yg(){return typeof pn().WorkerGlobalScope<"u"&&typeof pn().importScripts=="function"}async function FI(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function BI(){return navigator?.serviceWorker?.controller||null}function UI(){return Yg()?self:null}const Qg="firebaseLocalStorageDb",VI=1,la="firebaseLocalStorage",Xg="fbase_key";class Xr{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function nl(t,e){return t.transaction([la],e?"readwrite":"readonly").objectStore(la)}function HI(){const t=indexedDB.deleteDatabase(Qg);return new Xr(t).toPromise()}function yc(){const t=indexedDB.open(Qg,VI);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(la,{keyPath:Xg})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(la)?e(s):(s.close(),await HI(),e(await yc()))})})}async function Gh(t,e,n){const s=nl(t,!0).put({[Xg]:e,value:n});return new Xr(s).toPromise()}async function WI(t,e){const n=nl(t,!1).get(e),s=await new Xr(n).toPromise();return s===void 0?null:s.value}function Yh(t,e){const n=nl(t,!0).delete(e);return new Xr(n).toPromise()}const jI=800,zI=3;class Jg{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await yc(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>zI)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Yg()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=tl._getInstance(UI()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await FI(),!this.activeServiceWorker)return;this.sender=new LI(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||BI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await yc();return await Gh(e,aa,"1"),await Yh(e,aa),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>Gh(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>WI(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Yh(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const r=nl(i,!1).getAll();return new Xr(r).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;if(e.length!==0)for(const{fbase_key:i,value:r}of e)s.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!s.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),jI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Jg.type="LOCAL";const qI=Jg;new Yr(3e4,6e4);function KI(t,e){return e?In(e):(we(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class Lu extends Hg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return vi(e,this._buildIdpRequest())}_linkToIdToken(e,n){return vi(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return vi(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function GI(t){return AI(t.auth,new Lu(t),t.bypassAuthState)}function YI(t){const{auth:e,user:n}=t;return we(n,e,"internal-error"),kI(n,new Lu(t),t.bypassAuthState)}async function QI(t){const{auth:e,user:n}=t;return we(n,e,"internal-error"),TI(n,new Lu(t),t.bypassAuthState)}class Zg{constructor(e,n,s,i,r=!1){this.auth=e,this.resolver=s,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:i,tenantId:r,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:s,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return GI;case"linkViaPopup":case"linkViaRedirect":return QI;case"reauthViaPopup":case"reauthViaRedirect":return YI;default:Mn(this.auth,"internal-error")}}resolve(e){Ln(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ln(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const XI=new Yr(2e3,1e4);class ci extends Zg{constructor(e,n,s,i,r){super(e,n,i,r),this.provider=s,this.authWindow=null,this.pollId=null,ci.currentPopupAction&&ci.currentPopupAction.cancel(),ci.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return we(e,this.auth,"internal-error"),e}async onExecution(){Ln(this.filter.length===1,"Popup operations only handle one event");const e=Mu();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(fn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(fn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ci.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(fn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,XI.get())};e()}}ci.currentPopupAction=null;const JI="pendingRedirect",So=new Map;class ZI extends Zg{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=So.get(this.auth._key());if(!e){try{const s=await eT(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}So.set(this.auth._key(),e)}return this.bypassAuthState||So.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function eT(t,e){const n=sT(e),s=nT(t);if(!await s._isAvailable())return!1;const i=await s._get(n)==="true";return await s._remove(n),i}function tT(t,e){So.set(t._key(),e)}function nT(t){return In(t._redirectPersistence)}function sT(t){return Eo(JI,t.config.apiKey,t.name)}async function iT(t,e,n=!1){if(zt(t.app))return Promise.reject(cs(t));const s=el(t),i=KI(s,e),o=await new ZI(s,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}const rT=600*1e3;class oT{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!aT(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!ew(e)){const s=e.error.code?.split("auth/")[1]||"internal-error";n.onError(fn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=rT&&this.cachedEventUids.clear(),this.cachedEventUids.has(Qh(e))}saveEventToCache(e){this.cachedEventUids.add(Qh(e)),this.lastProcessedEventTime=Date.now()}}function Qh(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function ew({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function aT(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ew(t);default:return!1}}async function lT(t,e={}){return Vi(t,"GET","/v1/projects",e)}const cT=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,uT=/^https?/;async function dT(t){if(t.config.emulator)return;const{authorizedDomains:e}=await lT(t);for(const n of e)try{if(hT(n))return}catch{}Mn(t,"unauthorized-domain")}function hT(t){const e=vc(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===s}if(!uT.test(n))return!1;if(cT.test(t))return s===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(s)}const fT=new Yr(3e4,6e4);function Xh(){const t=pn().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function pT(t){return new Promise((e,n)=>{function s(){Xh(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Xh(),n(fn(t,"network-request-failed"))},timeout:fT.get()})}if(pn().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(pn().gapi?.load)s();else{const i=wI("iframefcb");return pn()[i]=()=>{gapi.load?s():n(fn(t,"network-request-failed"))},mI(`${gI()}?onload=${i}`).catch(r=>n(r))}}).catch(e=>{throw Io=null,e})}let Io=null;function mT(t){return Io=Io||pT(t),Io}const gT=new Yr(5e3,15e3),wT="__/auth/iframe",vT="emulator/auth/iframe",_T={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},yT=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function bT(t){const e=t.config;we(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Ru(e,vT):`https://${t.config.authDomain}/${wT}`,s={apiKey:e.apiKey,appName:t.name,v:Li},i=yT.get(t.config.apiHost);i&&(s.eid=i);const r=t._getFrameworks();return r.length&&(s.fw=r.join(",")),`${n}?${Mi(s).slice(1)}`}async function CT(t){const e=await mT(t),n=pn().gapi;return we(n,t,"internal-error"),e.open({where:document.body,url:bT(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:_T,dontclear:!0},s=>new Promise(async(i,r)=>{await s.restyle({setHideOnLeave:!1});const o=fn(t,"network-request-failed"),a=pn().setTimeout(()=>{r(o)},gT.get());function l(){pn().clearTimeout(a),i(s)}s.ping(l).then(l,()=>{r(o)})}))}const ET={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},ST=500,IT=600,TT="_blank",kT="http://localhost";class Jh{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function AT(t,e,n,s=ST,i=IT){const r=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let a="";const l={...ET,width:s.toString(),height:i.toString(),top:r,left:o},c=St().toLowerCase();n&&(a=Dg(c)?TT:n),Ng(c)&&(e=e||kT,l.scrollbars="yes");const u=Object.entries(l).reduce((h,[p,m])=>`${h}${p}=${m},`,"");if(aI(c)&&a!=="_self")return xT(e||"",a),new Jh(null);const d=window.open(e||"",a,u);we(d,t,"popup-blocked");try{d.focus()}catch{}return new Jh(d)}function xT(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}const PT="__/auth/handler",RT="emulator/auth/handler",NT=encodeURIComponent("fac");async function Zh(t,e,n,s,i,r){we(t.config.authDomain,t,"auth-domain-config-required"),we(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:Li,eventId:i};if(e instanceof Wg){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Vo(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,d]of Object.entries({}))o[u]=d}if(e instanceof Qr){const u=e.getScopes().filter(d=>d!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await t._getAppCheckToken(),c=l?`#${NT}=${encodeURIComponent(l)}`:"";return`${OT(t)}?${Mi(a).slice(1)}${c}`}function OT({config:t}){return t.emulator?Ru(t,RT):`https://${t.authDomain}/${PT}`}const Ml="webStorageSupport";class DT{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Gg,this._completeRedirectFn=iT,this._overrideRedirectResult=tT}async _openPopup(e,n,s,i){Ln(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const r=await Zh(e,n,s,vc(),i);return AT(e,r,Mu())}async _openRedirect(e,n,s,i){await this._originValidation(e);const r=await Zh(e,n,s,vc(),i);return $I(r),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:r}=this.eventManagers[n];return i?Promise.resolve(i):(Ln(r,"If manager is not set, promise should be"),r)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await CT(e),s=new oT(e);return n.register("authEvent",i=>(we(i?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Ml,{type:Ml},i=>{const r=i?.[0]?.[Ml];r!==void 0&&n(!!r),Mn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=dT(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Bg()||Og()||Ou()}}const MT=DT;var ef="@firebase/auth",tf="1.12.0";class LT{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{e(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){we(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function $T(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function FT(t){Ii(new Hs("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=s.options;we(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ug(t)},c=new fI(s,i,r,l);return _I(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),Ii(new Hs("auth-internal",e=>{const n=el(e.getProvider("auth").getImmediate());return(s=>new LT(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),os(ef,tf,$T(t)),os(ef,tf,"esm2020")}const BT=300,UT=Xp("authIdTokenMaxAge")||BT;let nf=null;const VT=t=>async e=>{const n=e&&await e.getIdTokenResult(),s=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(s&&s>UT)return;const i=n?.token;nf!==i&&(nf=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function HT(t=rm()){const e=Yc(t,"auth");if(e.isInitialized())return e.getImmediate();const n=vI(t,{popupRedirectResolver:MT,persistence:[qI,DI,Gg]}),s=Xp("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(s,location.origin);if(location.origin===r.origin){const o=VT(r.toString());PI(n,o,()=>o(n.currentUser)),xI(n,a=>o(a))}}const i=Yp("auth");return i&&yI(n,`http://${i}`),n}function WT(){return document.getElementsByTagName("head")?.[0]??document}pI({loadJS(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=i=>{const r=fn("internal-error");r.customData=i,n(r)},s.type="text/javascript",s.charset="UTF-8",WT().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});FT("Browser");const jT={apiKey:"AIzaSyAVYqEmdw-AwS1tCElhSaXDLP1Aq35chp0",authDomain:"manowlive-chat.firebaseapp.com",databaseURL:"https://manowlive-chat-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"manowlive-chat"},tw=im(jT),ge=$S(tw),$u=HT(tw);II($u).catch(console.error);function nw(){return{db:ge,auth:$u}}const zT="4.14.0",qT={version:zT},Et=La("system",()=>{const t=j(!1),e=j(""),n=j(0),s=j("..."),i=j(!1),r=j(!1),o=j(!0),a=j(!1),l=j(!0),c=j("AIzaSyBRHQqNNn8lKXic7KILkHkZRnNQ8oBFqnw,AIzaSyDulTIwtePtm9J9RNSfOuoIGaSOWOZRT3w"),u=j(!0),d=j(1),h=j("err"),p=j("ok"),m=j("ok"),w=j(0),C=j(localStorage.getItem("device_id")||`device-${Date.now()}`);localStorage.getItem("device_id")||localStorage.setItem("device_id",C.value);const A=j("v"+qT.version);function W(Z,re){Z==="db"&&(h.value=re),Z==="api"&&(p.value=re),Z==="chat"&&(m.value=re)}function B(){l.value=!l.value}function V(){const Z=pe(ge,"system/hostId");return pt(Z,re=>{const z=re.val();z&&z!==C.value&&a.value&&(a.value=!1,console.log(" Host role taken by another device:",z))})}return{isConnected:t,currentVideoId:e,viewerCount:n,liveTitle:s,isAiCommander:i,isAway:r,isSoundOn:o,isHost:a,isAiEnabled:l,statusDb:h,statusApi:p,statusChat:m,currentKeyIndex:w,myDeviceId:C,version:A,setStatus:W,toggleAi:B,initHostListener:V,googleApiKey:c,useOnlineTts:u,activeKeyIndex:d}});var Fu={};(function t(e,n,s,i){var r=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL),o=typeof Path2D=="function"&&typeof DOMMatrix=="function",a=(function(){if(!e.OffscreenCanvas)return!1;try{var S=new OffscreenCanvas(1,1),y=S.getContext("2d");y.fillRect(0,0,1,1);var P=S.transferToImageBitmap();y.createPattern(P,"no-repeat")}catch{return!1}return!0})();function l(){}function c(S){var y=n.exports.Promise,P=y!==void 0?y:e.Promise;return typeof P=="function"?new P(S):(S(l,l),null)}var u=(function(S,y){return{transform:function(P){if(S)return P;if(y.has(P))return y.get(P);var E=new OffscreenCanvas(P.width,P.height),k=E.getContext("2d");return k.drawImage(P,0,0),y.set(P,E),E},clear:function(){y.clear()}}})(a,new Map),d=(function(){var S=Math.floor(16.666666666666668),y,P,E={},k=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(y=function(q){var oe=Math.random();return E[oe]=requestAnimationFrame(function ae(ye){k===ye||k+S-1<ye?(k=ye,delete E[oe],q()):E[oe]=requestAnimationFrame(ae)}),oe},P=function(q){E[q]&&cancelAnimationFrame(E[q])}):(y=function(q){return setTimeout(q,S)},P=function(q){return clearTimeout(q)}),{frame:y,cancel:P}})(),h=(function(){var S,y,P={};function E(k){function q(oe,ae){k.postMessage({options:oe||{},callback:ae})}k.init=function(ae){var ye=ae.transferControlToOffscreen();k.postMessage({canvas:ye},[ye])},k.fire=function(ae,ye,Me){if(y)return q(ae,null),y;var $e=Math.random().toString(36).slice(2);return y=c(function(We){function g(_){_.data.callback===$e&&(delete P[$e],k.removeEventListener("message",g),y=null,u.clear(),Me(),We())}k.addEventListener("message",g),q(ae,$e),P[$e]=g.bind(null,{data:{callback:$e}})}),y},k.reset=function(){k.postMessage({reset:!0});for(var ae in P)P[ae](),delete P[ae]}}return function(){if(S)return S;if(!s&&r){var k=["var CONFETTI, SIZE = {}, module = {};","("+t.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{S=new Worker(URL.createObjectURL(new Blob([k])))}catch(q){return typeof console<"u"&&typeof console.warn=="function"&&console.warn(" Could not load worker",q),null}E(S)}return S}})(),p={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function m(S,y){return y?y(S):S}function w(S){return S!=null}function C(S,y,P){return m(S&&w(S[y])?S[y]:p[y],P)}function A(S){return S<0?0:Math.floor(S)}function W(S,y){return Math.floor(Math.random()*(y-S))+S}function B(S){return parseInt(S,16)}function V(S){return S.map(Z)}function Z(S){var y=String(S).replace(/[^0-9a-f]/gi,"");return y.length<6&&(y=y[0]+y[0]+y[1]+y[1]+y[2]+y[2]),{r:B(y.substring(0,2)),g:B(y.substring(2,4)),b:B(y.substring(4,6))}}function re(S){var y=C(S,"origin",Object);return y.x=C(y,"x",Number),y.y=C(y,"y",Number),y}function z(S){S.width=document.documentElement.clientWidth,S.height=document.documentElement.clientHeight}function R(S){var y=S.getBoundingClientRect();S.width=y.width,S.height=y.height}function v(S){var y=document.createElement("canvas");return y.style.position="fixed",y.style.top="0px",y.style.left="0px",y.style.pointerEvents="none",y.style.zIndex=S,y}function T(S,y,P,E,k,q,oe,ae,ye){S.save(),S.translate(y,P),S.rotate(q),S.scale(E,k),S.arc(0,0,1,oe,ae,ye),S.restore()}function x(S){var y=S.angle*(Math.PI/180),P=S.spread*(Math.PI/180);return{x:S.x,y:S.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:S.startVelocity*.5+Math.random()*S.startVelocity,angle2D:-y+(.5*P-Math.random()*P),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:S.color,shape:S.shape,tick:0,totalTicks:S.ticks,decay:S.decay,drift:S.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:S.gravity*3,ovalScalar:.6,scalar:S.scalar,flat:S.flat}}function b(S,y){y.x+=Math.cos(y.angle2D)*y.velocity+y.drift,y.y+=Math.sin(y.angle2D)*y.velocity+y.gravity,y.velocity*=y.decay,y.flat?(y.wobble=0,y.wobbleX=y.x+10*y.scalar,y.wobbleY=y.y+10*y.scalar,y.tiltSin=0,y.tiltCos=0,y.random=1):(y.wobble+=y.wobbleSpeed,y.wobbleX=y.x+10*y.scalar*Math.cos(y.wobble),y.wobbleY=y.y+10*y.scalar*Math.sin(y.wobble),y.tiltAngle+=.1,y.tiltSin=Math.sin(y.tiltAngle),y.tiltCos=Math.cos(y.tiltAngle),y.random=Math.random()+2);var P=y.tick++/y.totalTicks,E=y.x+y.random*y.tiltCos,k=y.y+y.random*y.tiltSin,q=y.wobbleX+y.random*y.tiltCos,oe=y.wobbleY+y.random*y.tiltSin;if(S.fillStyle="rgba("+y.color.r+", "+y.color.g+", "+y.color.b+", "+(1-P)+")",S.beginPath(),o&&y.shape.type==="path"&&typeof y.shape.path=="string"&&Array.isArray(y.shape.matrix))S.fill(U(y.shape.path,y.shape.matrix,y.x,y.y,Math.abs(q-E)*.1,Math.abs(oe-k)*.1,Math.PI/10*y.wobble));else if(y.shape.type==="bitmap"){var ae=Math.PI/10*y.wobble,ye=Math.abs(q-E)*.1,Me=Math.abs(oe-k)*.1,$e=y.shape.bitmap.width*y.scalar,We=y.shape.bitmap.height*y.scalar,g=new DOMMatrix([Math.cos(ae)*ye,Math.sin(ae)*ye,-Math.sin(ae)*Me,Math.cos(ae)*Me,y.x,y.y]);g.multiplySelf(new DOMMatrix(y.shape.matrix));var _=S.createPattern(u.transform(y.shape.bitmap),"no-repeat");_.setTransform(g),S.globalAlpha=1-P,S.fillStyle=_,S.fillRect(y.x-$e/2,y.y-We/2,$e,We),S.globalAlpha=1}else if(y.shape==="circle")S.ellipse?S.ellipse(y.x,y.y,Math.abs(q-E)*y.ovalScalar,Math.abs(oe-k)*y.ovalScalar,Math.PI/10*y.wobble,0,2*Math.PI):T(S,y.x,y.y,Math.abs(q-E)*y.ovalScalar,Math.abs(oe-k)*y.ovalScalar,Math.PI/10*y.wobble,0,2*Math.PI);else if(y.shape==="star")for(var I=Math.PI/2*3,L=4*y.scalar,M=8*y.scalar,$=y.x,X=y.y,Q=5,K=Math.PI/Q;Q--;)$=y.x+Math.cos(I)*M,X=y.y+Math.sin(I)*M,S.lineTo($,X),I+=K,$=y.x+Math.cos(I)*L,X=y.y+Math.sin(I)*L,S.lineTo($,X),I+=K;else S.moveTo(Math.floor(y.x),Math.floor(y.y)),S.lineTo(Math.floor(y.wobbleX),Math.floor(k)),S.lineTo(Math.floor(q),Math.floor(oe)),S.lineTo(Math.floor(E),Math.floor(y.wobbleY));return S.closePath(),S.fill(),y.tick<y.totalTicks}function F(S,y,P,E,k){var q=y.slice(),oe=S.getContext("2d"),ae,ye,Me=c(function($e){function We(){ae=ye=null,oe.clearRect(0,0,E.width,E.height),u.clear(),k(),$e()}function g(){s&&!(E.width===i.width&&E.height===i.height)&&(E.width=S.width=i.width,E.height=S.height=i.height),!E.width&&!E.height&&(P(S),E.width=S.width,E.height=S.height),oe.clearRect(0,0,E.width,E.height),q=q.filter(function(_){return b(oe,_)}),q.length?ae=d.frame(g):We()}ae=d.frame(g),ye=We});return{addFettis:function($e){return q=q.concat($e),Me},canvas:S,promise:Me,reset:function(){ae&&d.cancel(ae),ye&&ye()}}}function D(S,y){var P=!S,E=!!C(y||{},"resize"),k=!1,q=C(y,"disableForReducedMotion",Boolean),oe=r&&!!C(y||{},"useWorker"),ae=oe?h():null,ye=P?z:R,Me=S&&ae?!!S.__confetti_initialized:!1,$e=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,We;function g(I,L,M){for(var $=C(I,"particleCount",A),X=C(I,"angle",Number),Q=C(I,"spread",Number),K=C(I,"startVelocity",Number),H=C(I,"decay",Number),de=C(I,"gravity",Number),se=C(I,"drift",Number),le=C(I,"colors",V),me=C(I,"ticks",Number),Ie=C(I,"shapes"),Fe=C(I,"scalar"),Re=!!C(I,"flat"),ct=re(I),ut=$,kt=[],Ft=S.width*ct.x,Cs=S.height*ct.y;ut--;)kt.push(x({x:Ft,y:Cs,angle:X,spread:Q,startVelocity:K,color:le[ut%le.length],shape:Ie[W(0,Ie.length)],ticks:me,decay:H,gravity:de,drift:se,scalar:Fe,flat:Re}));return We?We.addFettis(kt):(We=F(S,kt,ye,L,M),We.promise)}function _(I){var L=q||C(I,"disableForReducedMotion",Boolean),M=C(I,"zIndex",Number);if(L&&$e)return c(function(K){K()});P&&We?S=We.canvas:P&&!S&&(S=v(M),document.body.appendChild(S)),E&&!Me&&ye(S);var $={width:S.width,height:S.height};ae&&!Me&&ae.init(S),Me=!0,ae&&(S.__confetti_initialized=!0);function X(){if(ae){var K={getBoundingClientRect:function(){if(!P)return S.getBoundingClientRect()}};ye(K),ae.postMessage({resize:{width:K.width,height:K.height}});return}$.width=$.height=null}function Q(){We=null,E&&(k=!1,e.removeEventListener("resize",X)),P&&S&&(document.body.contains(S)&&document.body.removeChild(S),S=null,Me=!1)}return E&&!k&&(k=!0,e.addEventListener("resize",X,!1)),ae?ae.fire(I,$,Q):g(I,$,Q)}return _.reset=function(){ae&&ae.reset(),We&&We.reset()},_}var G;function O(){return G||(G=D(null,{useWorker:!0,resize:!0})),G}function U(S,y,P,E,k,q,oe){var ae=new Path2D(S),ye=new Path2D;ye.addPath(ae,new DOMMatrix(y));var Me=new Path2D;return Me.addPath(ye,new DOMMatrix([Math.cos(oe)*k,Math.sin(oe)*k,-Math.sin(oe)*q,Math.cos(oe)*q,P,E])),Me}function ce(S){if(!o)throw new Error("path confetti are not supported in this browser");var y,P;typeof S=="string"?y=S:(y=S.path,P=S.matrix);var E=new Path2D(y),k=document.createElement("canvas"),q=k.getContext("2d");if(!P){for(var oe=1e3,ae=oe,ye=oe,Me=0,$e=0,We,g,_=0;_<oe;_+=2)for(var I=0;I<oe;I+=2)q.isPointInPath(E,_,I,"nonzero")&&(ae=Math.min(ae,_),ye=Math.min(ye,I),Me=Math.max(Me,_),$e=Math.max($e,I));We=Me-ae,g=$e-ye;var L=10,M=Math.min(L/We,L/g);P=[M,0,0,M,-Math.round(We/2+ae)*M,-Math.round(g/2+ye)*M]}return{type:"path",path:y,matrix:P}}function te(S){var y,P=1,E="#000000",k='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof S=="string"?y=S:(y=S.text,P="scalar"in S?S.scalar:P,k="fontFamily"in S?S.fontFamily:k,E="color"in S?S.color:E);var q=10*P,oe=""+q+"px "+k,ae=new OffscreenCanvas(q,q),ye=ae.getContext("2d");ye.font=oe;var Me=ye.measureText(y),$e=Math.ceil(Me.actualBoundingBoxRight+Me.actualBoundingBoxLeft),We=Math.ceil(Me.actualBoundingBoxAscent+Me.actualBoundingBoxDescent),g=2,_=Me.actualBoundingBoxLeft+g,I=Me.actualBoundingBoxAscent+g;$e+=g+g,We+=g+g,ae=new OffscreenCanvas($e,We),ye=ae.getContext("2d"),ye.font=oe,ye.fillStyle=E,ye.fillText(y,_,I);var L=1/P;return{type:"bitmap",bitmap:ae.transferToImageBitmap(),matrix:[L,0,0,L,-$e*L/2,-We*L/2]}}n.exports=function(){return O().apply(this,arguments)},n.exports.reset=function(){O().reset()},n.exports.create=D,n.exports.shapeFromPath=ce,n.exports.shapeFromText=te})((function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}})(),Fu,!1);const sf=Fu.exports;Fu.exports.create;let bc=null,zn=null;async function KT(){try{const t=window.AudioContext||window.webkitAudioContext;if(!t)return;zn=new t;const n=await(await fetch("https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3")).arrayBuffer();bc=await zn.decodeAudioData(n),console.log(" Celebration audio preloaded successfully!")}catch(t){console.warn(" Failed to preload celebration audio:",t)}}KT();function rf(t){const n=Date.now()+1500;if(zn&&bc)try{zn.state==="suspended"&&zn.resume();const i=zn.createBufferSource();i.buffer=bc;const r=zn.createGain();r.gain.value=.2,i.connect(r),r.connect(zn.destination),i.start(0)}catch(i){console.warn("Audio buffer playback error:",i)}else try{const i=new Audio("https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3");i.volume=.2,i.play().catch(r=>console.warn("Fallback audio autoplay blocked"))}catch{}const s=setInterval(function(){const i=n-Date.now();if(i<=0)return clearInterval(s);const r=50*(i/1500);sf({particleCount:r,startVelocity:30,spread:360,origin:{x:Math.random()*.2,y:Math.random()-.2}}),sf({particleCount:r,startVelocity:30,spread:360,origin:{x:Math.random()*.2+.8,y:Math.random()-.2}})},250)}const Hi=La("stock",()=>{const t=j({}),e=j(70),n=j({fifty:!1,eighty:!1}),s=Et();function i(d){const h=pe(ge,`stock/${d}`),p=pt(h,C=>{const A=C.val()||{};if(t.value=A,d&&d!=="demo"){let W=0,B=0;Object.values(A).forEach(z=>{z.owner&&z.price?(W+=parseInt(z.price),B++):z.owner&&B++});const V=e.value>0?e.value:70,Z=B/V*100;Z>=50&&!n.value.fifty&&(rf(),n.value.fifty=!0),Z>=80&&!n.value.eighty&&(rf(),n.value.eighty=!0);const re=pe(ge,`history/${d}`);Gt(re,{totalSales:W,totalItems:B,lastUpdated:Date.now()}).catch(z=>console.error("History Sync Error:",z))}}),m=pe(ge,`settings/${d}/stockSize`),w=pt(m,C=>{const A=C.val();A&&(e.value=A)});return()=>{p(),w()}}async function r(d,h,p,m="manual",w=null,C="manual"){const A=pe(ge,`stock/${s.currentVideoId}/${d}`);try{let W="unknown";return await VS(A,B=>{if(B===null)return W="claimed",{owner:h,uid:p,time:Date.now(),queue:[],source:C,price:w||null};if(B.owner){if(B.owner===h){W="already_owned";return}const V=B.queue||[];if(V.find(Z=>Z.owner===h)){W="already_queued";return}return W="queued",V.push({owner:h,uid:p,time:Date.now()}),B.queue=V,B}else return W="claimed",B.owner=h,B.uid=p,B.time=Date.now(),B.source=C,w&&(B.price=w),B.queue||(B.queue=[]),B}),{success:!0,action:W,error:null}}catch(W){return console.error("Transaction failed: ",W),{success:!1,action:"error",error:W.message}}}async function o(d){const h=t.value[d];if(!h)return null;const p=h.owner;let m=null;try{if(h.queue&&h.queue.length>0){const w=h.queue[0],C=h.queue.slice(1),A={owner:w.owner,uid:w.uid,time:Date.now(),queue:C,source:"queue"};h.price&&(A.price=h.price),await hn(pe(ge,`stock/${s.currentVideoId}/${d}`),A),m=w.owner}else await mi(pe(ge,`stock/${s.currentVideoId}/${d}`));return{success:!0,previousOwner:p,nextOwner:m,error:null}}catch(w){return console.error("Cancel failed: ",w),{success:!1,previousOwner:p,nextOwner:null,error:w.message}}}function a(){mi(pe(ge,`stock/${s.currentVideoId}`)),n.value={fifty:!1,eighty:!1}}function l(d,h){const p=`stock/${s.currentVideoId}/${d}/price`;return Gt(pe(ge),{[p]:h})}function c(d){if(!s.currentVideoId)return;const h=pe(ge,`settings/${s.currentVideoId}/stockSize`);hn(h,d)}async function u(d,h){s.currentVideoId&&(await Gt(pe(ge,`stock/${s.currentVideoId}/${d}`),h),(h.price||h.size)&&await Gt(pe(ge,`overlay/${s.currentVideoId}/current_item`),{id:d,price:h.price||null,size:h.size||null,updatedAt:Date.now()}))}return{stockData:t,stockSize:e,connectToStock:i,processOrder:r,processCancel:o,clearAllStock:a,updateStockPrice:l,updateStockSize:c,updateItemData:u}}),Jr=La("chat",()=>{const t=Lr([]),e=j({}),n=j([]),s=j(null);let i=null,r=null;function o(h){if(e.value[h.id]){console.log(" Duplicate message:",h.id);return}e.value[h.id]=!0,t.push(h),console.log(" Message added, total:",t.length),n.value.push({id:h.id,author:h.authorName,comment:h.text,videoTime:a(h.timestamp),messageTime:new Date(h.timestamp).toLocaleString("en-US"),displayName:h.displayName||h.authorName,realName:h.realName||h.displayName||h.authorName,text:h.text,timestamp:h.timestamp})}function a(h){if(!s.value)return"0:00";const p=h-s.value;if(p<0)return"0:00";const m=Math.floor(p/1e3),w=Math.floor(m/3600),C=Math.floor(m%3600/60),A=m%60;return w>0?`${w}:${C.toString().padStart(2,"0")}:${A.toString().padStart(2,"0")}`:`${C}:${A.toString().padStart(2,"0")}`}function l(){t.splice(0),e.value={},n.value=[],s.value=null,console.log(" Chat & Logs cleared completely")}function c(h){if(n.value.length===0){alert("");return}let p=`\uFEFFId,Author name,Comment,Video time,Message time
`;n.value.forEach(A=>{const W=A.comment?A.comment.replace(/"/g,'""'):"",B=A.author?A.author.replace(/"/g,'""'):"";p+=`${A.id},"${B}","${W}",${A.videoTime},"${A.messageTime}"
`});const m=new Blob([p],{type:"text/csv;charset=utf-8;"}),w=URL.createObjectURL(m),C=document.createElement("a");C.setAttribute("href",w),C.setAttribute("download",`chat_log_${h}.csv`),C.style.visibility="hidden",document.body.appendChild(C),C.click(),document.body.removeChild(C)}function u(h){if(!h){console.warn(" No videoId provided for chat sync");return}if(r&&r!==h&&(console.log(` Switching video from ${r} to ${h}. Clearing chat...`),l()),i&&r!==h){console.log(` Cleaning up old chat listener for ${r}`);const w=pe(ge,`chats/${r}`);Bh(w,"child_added",i),i=null}r=h;const p=pe(ge,`chats/${h}`);console.log(` Starting Firebase chat sync for: ${h}`);const m=SS(p,w=>{const C=w.val();C&&o(C)});return i=m,()=>{console.log(` Cleaning up chat listener for ${h}`),Bh(p,"child_added",m),i=null}}async function d(h,p){if(!h){console.warn(" Cannot send message: No videoId provided");return}try{const m=pe(ge,`chats/${h}`);await yg(m,p)}catch(m){throw console.error(" Error sending message to Firebase:",m),m}}return{messages:t,fullChatLog:n,streamStartTime:s,addMessage:o,clearChat:l,downloadChatCSV:c,syncFromFirebase:u,sendMessageToFirebase:d}}),GT=Object.freeze(Object.defineProperty({__proto__:null,useChatStore:Jr},Symbol.toStringTag,{value:"Module"})),sl={log:(...t)=>{},info:(...t)=>{},warn:(...t)=>{},error:(...t)=>{console.error("%c[ERROR]","color: #e74c3c; font-weight: bold;",...t)},debug:(...t)=>{},system:t=>{console.log(`%c [SYSTEM] ${t}`,"color: #00e676; font-weight: bold; font-size: 12px;")}},YT=La("nickname",()=>{const t=j({}),e={" .":" "," ":" "," ":" "," ":" "};function n(){return pt(pe(ge,"nicknames"),r=>{const o=r.val()||{};t.value=o,sl.debug(" Nicknames updated:",Object.keys(o).length)})}function s(r,o){return t.value[r]?typeof t.value[r]=="object"?t.value[r].nick:t.value[r]:o}function i(r,o){return e[o]?e[o]:t.value[r]?.phonetic?t.value[r].phonetic:o}return{nicknames:t,initNicknameListener:n,getNickname:s,getPhoneticName:i}});window.ttsActiveUtterances=[];class QT{constructor(){this.queue=[],this.isSpeaking=!1,this.voices=[],this.poller=null,this.audioPlayer=new Audio,this.isNativeUnlocked=!1,this.isGoogleUnlocked=!1,this.stuckTimer=null,this.STUCK_TIMEOUT=15e3,this.processQueue=this.processQueue.bind(this),this.loadVoices=this.loadVoices.bind(this),window.speechSynthesis.onvoiceschanged=this.loadVoices,this.loadVoices(),this.poller=setInterval(this.loadVoices,500)}loadVoices(){const e=window.speechSynthesis.getVoices();e.length!==0&&(this.voices=e,this.poller&&(clearInterval(this.poller),this.poller=null),console.log(" Loaded "+this.voices.length+" voices."))}unlockNative(){if(this.isNativeUnlocked)return;console.log(" Unlocking Native TTS...");const e=new SpeechSynthesisUtterance("");e.volume=0,e.onend=()=>{this.isNativeUnlocked=!0},window.speechSynthesis.speak(e)}unlockAudioElement(){if(this.isGoogleUnlocked)return;console.log(" Unlocking Google TTS Audio Element...");const e="UklGRigAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAAABmYWN0BAAAAAAAAABkYXRhAAAAAA==";try{const n=this.base64ToBlob(e,"audio/wav"),s=URL.createObjectURL(n);this.audioPlayer.src=s,this.audioPlayer.play().then(()=>{console.log(" Google TTS Audio Element Unlocked (WAV)"),this.isGoogleUnlocked=!0,setTimeout(()=>URL.revokeObjectURL(s),1e3)}).catch(i=>{console.warn(" Audio unlock failed (User interaction needed):",i),URL.revokeObjectURL(s)})}catch(n){console.error(" Audio unlock setup failed:",n)}}getBestVoice(){if(this.voices.length===0)return this.loadVoices(),null;let e=this.voices.find(n=>n.name.includes("Google")&&(n.name.includes("Thai")||n.name.includes("")));return e||(e=this.voices.find(n=>n.name.includes("Premwadee")||n.name.includes("Pattara")),e)||(e=this.voices.find(n=>n.name.includes("Narisa")),e)||(e=this.voices.find(n=>n.lang.startsWith("th")),e)?e:null}sanitize(e){if(!e)return"";const n=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|\uD83E[\uDD10-\uDDFF]|\uD83F[\uDC00-\uDFFF]|[\u2000-\u26FF])/g;let s=e.replace(n,"");return s=s.replace(/[#*~_]/g,""),s=s.replace(/\s+/g," ").trim(),s.length>500&&(s=s.substring(0,500)),s}base64ToBlob(e,n="audio/mp3"){const s=atob(e),i=new Uint8Array(s.length);for(let r=0;r<s.length;r++)i[r]=s.charCodeAt(r);return new Blob([i],{type:n})}async speakOnline(e){const i=Et().googleApiKey.split(",").map(a=>a.trim()).filter(a=>a);if(i.length===0){console.warn(" No Google API Keys found, falling back to Native TTS"),this.speakNative(e);return}const o=this.sanitize(e).substring(0,200);console.log(` Google Cloud TTS: ${o.substring(0,50)}... (${i.length} keys available)`);for(let a=0;a<i.length;a++){const l=i[a];try{console.log(` Trying key ${a+1}/${i.length}...`);const c=new AbortController,u=setTimeout(()=>c.abort(),3e3),d=await fetch(`https://texttospeech.googleapis.com/v1/text:synthesize?key=${l}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:{text:o},voice:{languageCode:"th-TH",name:"th-TH-Standard-A"},audioConfig:{audioEncoding:"MP3",speakingRate:1,pitch:0}}),signal:c.signal});if(clearTimeout(u),!d.ok)throw new Error(`API Error: ${d.status}`);const h=await d.json(),p=this.base64ToBlob(h.audioContent),m=URL.createObjectURL(p);let w=!1;const C=()=>{w||(w=!0,URL.revokeObjectURL(m),this.clearStuckTimer(),this._currentOnComplete&&(this._currentOnComplete(),this._currentOnComplete=null),this.isSpeaking=!1,this.processQueue())};this.audioPlayer.src=m,this.audioPlayer.onended=C,this.audioPlayer.onerror=W=>{console.error(" Audio playback error:",W),C()},this.audioPlayer.load();try{await this.audioPlayer.play()}catch(W){if(W.name==="NotAllowedError"){console.warn(" iOS blocked background audio. Falling back to Native TTS."),w=!0,URL.revokeObjectURL(m),this.speakNative(e);return}console.error(" Play error:",W),C();return}const A=Et();A.activeKeyIndex=a+1,console.log(` Success with key ${a+1}`);return}catch(c){if(c.name==="AbortError"){console.warn(` Key ${a+1} timed out. Switching to Native for this message.`),this.speakNative(e);return}console.warn(` Key ${a+1} failed: ${c.message}`),a===i.length-1&&(console.error(" All Google Keys failed/exhausted."),this.speakNative(e))}}}speakNative(e){try{const n=this.getBestVoice(),s=new SpeechSynthesisUtterance(e);s.lang="th-TH",s.volume=1,s.rate=1,n&&(s.voice=n),console.log(" Native TTS:",e.substring(0,50)+(e.length>50?"...":"")),window.ttsActiveUtterances.push(s);let i=!1;const r=()=>{if(i)return;i=!0;const o=window.ttsActiveUtterances.indexOf(s);o>-1&&window.ttsActiveUtterances.splice(o,1),this.clearStuckTimer(),this._currentOnComplete&&(this._currentOnComplete(),this._currentOnComplete=null),this.isSpeaking=!1,this.processQueue()};s.onend=r,s.onerror=o=>{o.error!=="interrupted"&&(console.error(" Native TTS Error:",o),r())},window.speechSynthesis.speak(s)}catch(n){console.error(" Native TTS setup failed:",n),this.clearStuckTimer(),this._currentOnComplete&&(this._currentOnComplete(),this._currentOnComplete=null),this.isSpeaking=!1,this.processQueue()}}clearStuckTimer(){this.stuckTimer&&(clearTimeout(this.stuckTimer),this.stuckTimer=null)}startStuckTimer(){this.clearStuckTimer(),this.stuckTimer=setTimeout(()=>{this.isSpeaking&&(console.warn(` TTS stuck for ${this.STUCK_TIMEOUT/1e3}s  auto-resetting queue`),this.isSpeaking=!1,this.processQueue())},this.STUCK_TIMEOUT)}processQueue(){if(this.queue.length===0||this.isSpeaking)return;this.isSpeaking=!0;const e=this.queue.shift(),n=typeof e=="string"?e:e.text;this._currentOnComplete=typeof e=="object"?e.onComplete:null,this.startStuckTimer();const s=Et();s.useOnlineTts&&s.googleApiKey?this.speakOnline(n):this.speakNative(n)}speak(e,n){const s=this.sanitize(n);if(!s)return Promise.resolve();const i=e?`${e} ... ${s}`:s;return new Promise(r=>{this.queue.push({text:i,onComplete:r}),this.processQueue(),setTimeout(()=>r(),2e4)})}reset(){this.clearStuckTimer(),this.audioPlayer&&(this.audioPlayer.onended=null,this.audioPlayer.onerror=null,this.audioPlayer.pause(),this.audioPlayer.currentTime=0,this.audioPlayer.removeAttribute("src")),window.speechSynthesis.cancel(),this.queue.forEach(e=>{typeof e=="object"&&e.onComplete&&e.onComplete()}),this.queue=[],this._currentOnComplete&&(this._currentOnComplete(),this._currentOnComplete=null),this.isSpeaking=!1,window.ttsActiveUtterances=[],console.log(" TTS Reset (Clean)")}}const oi=new QT,po=[];let mo=!1;function Zs(){const t=Et(),e=j(null);j(!1);function n(){e.value||(e.value=new(window.AudioContext||window.webkitAudioContext))}async function s(){if(n(),!e.value)return!1;try{e.value.state==="suspended"&&await e.value.resume()}catch(u){console.warn("Audio resume failed:",u)}if(e.value.state!=="running")return!1;try{const u=e.value.createOscillator(),d=e.value.createGain();return d.gain.value=0,u.connect(d),d.connect(e.value.destination),u.start(),u.stop(e.value.currentTime+.001),oi.unlockNative(),oi.unlockAudioElement(),console.log(" All audio systems unlocked!"),!0}catch(u){return console.error("Silent unlock failed:",u),!1}}function i(u){t.isSoundOn&&oi.speak("",u)}let r=[];function o(u="success"){return new Promise(async d=>{try{if(!t.isSoundOn||(n(),e.value&&e.value.state==="suspended"&&await e.value.resume(),!e.value))return;const h=e.value,p=h.currentTime;if(r.forEach(m=>{try{m.stop(),m.disconnect()}catch{}}),r=[],u==="success"){const m=h.createOscillator(),w=h.createGain();m.type="sine",m.frequency.setValueAtTime(1200,p),w.gain.setValueAtTime(.03,p),w.gain.exponentialRampToValueAtTime(.001,p+.4),m.connect(w),w.connect(h.destination),m.start(p),m.stop(p+.4);const C=h.createOscillator(),A=h.createGain();C.type="sine",C.frequency.setValueAtTime(1600,p),A.gain.setValueAtTime(.02,p),A.gain.exponentialRampToValueAtTime(.001,p+.3),C.connect(A),A.connect(h.destination),C.start(p),C.stop(p+.3),r.push(m,C)}else if(u==="error"){const m=h.createOscillator(),w=h.createGain();m.type="sine",m.frequency.setValueAtTime(250,p),w.gain.setValueAtTime(.04,p),w.gain.exponentialRampToValueAtTime(.001,p+.3),m.connect(w),w.connect(h.destination),m.start(p),m.stop(p+.3),r.push(m)}else if(u==="cancel"){const m=h.createOscillator(),w=h.createGain();m.type="sine",m.frequency.setValueAtTime(600,p),m.frequency.exponentialRampToValueAtTime(300,p+.15),w.gain.setValueAtTime(.04,p),w.gain.exponentialRampToValueAtTime(.001,p+.15),m.connect(w),w.connect(h.destination),m.start(p),m.stop(p+.15),r.push(m)}}catch(h){console.warn(" SFX Playback skipped:",h)}finally{d()}})}function a(){po.length=0,r.forEach(u=>{try{u.stop(),u.disconnect()}catch{}}),r=[],oi.reset(),mo=!1}async function l(){if(mo||po.length===0)return;mo=!0;const u=po.shift();try{if(u.sfxType&&await o(u.sfxType),u.message){const d=oi.speak(u.author,u.message);d instanceof Promise&&await d.catch(h=>console.warn("TTS Error:",h))}}catch(d){console.error("Audio Queue Error:",d)}mo=!1,l()}function c(u,d,h){t.isSoundOn&&(po.push({sfxType:u,author:d,message:h}),l())}return{queueSpeech:i,queueAudio:c,playSfx:o,resetVoice:a,unlockAudio:s}}const XT=[" "," "," "," "," ","  "," "," "," "," "],JT=[" "," "," "," "," "," "," "," "];function ZT(){const t=Et(),{queueSpeech:e}=Zs(),n=j("00:00");let s=null,i=0;function r(c){return c[Math.floor(Math.random()*c.length)]}function o(){if(!t.isAway||!i){n.value="00:00";return}const c=Math.floor((Date.now()-i)/1e3),u=Math.floor(c/3600),d=Math.floor(c%3600/60),h=c%60;u>0?n.value=`${u}:${d.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}`:n.value=`${d.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}`}function a(){hn(pe(ge,"system/awayMode"),{isAway:!1,startTime:null,closedBy:t.myDeviceId,closedAt:Date.now()}).then(()=>{console.log(" Away mode closed by user")}).catch(c=>{console.error("Error closing away mode:",c)})}function l(){const c=pe(ge,"system/awayMode");return pt(c,d=>{const h=d.val(),p=h?.isAway||!1,m=t.isAway;if(console.log(" Away mode changed:",{newState:p,prevState:m,data:h}),p&&!m){t.isAway=!0,i=h?.startTime||Date.now(),s||(o(),s=setInterval(o,1e3));const w=r(XT);e(w)}else if(!p&&m){t.isAway=!1,s&&(clearInterval(s),s=null),n.value="00:00";const w=r(JT);e(w)}})}return Ys(()=>{s&&clearInterval(s)}),{awayTimer:n,closeAwayMode:a,initAwayListener:l}}const _i={CLEANUP:{STARTUP_DELAY_MS:2e4,HISTORY_RETENTION_DAYS:30},YOUTUBE:{VIEWER_POLL_INTERVAL_MS:6e4,DISCONNECT_DELAY_MS:9e4},UI:{TOAST_DURATION_MS:2e3,LONG_TOAST_DURATION_MS:3e3,ERROR_TOAST_DURATION_MS:4e3},VOICE:{RETRY_DELAY_MS:500}};function ek(){const t=Et(),e=j(!1);async function n(){if(!(t.isAiCommander||localStorage.getItem("isAdmin")==="true"))return;console.debug(` Auto Cleanup: Waiting ${_i.CLEANUP.STARTUP_DELAY_MS/1e3}s before check...`);const r=setTimeout(async()=>{await s()},_i.CLEANUP.STARTUP_DELAY_MS);return()=>clearTimeout(r)}async function s(){if(!e.value){e.value=!0;try{console.log(" Auto Cleanup: Checking for old chats...");const i=new Date;i.setDate(i.getDate()-_i.CLEANUP.HISTORY_RETENTION_DAYS);const r=i.getTime();console.log(` Cutoff Date: ${i.toLocaleDateString()} (${r})`);const o=pe(ge,"history"),a=xS(o,AS("timestamp"),TS(r)),l=await li(a);if(!l.exists()){console.log(" Auto Cleanup: No old history found.");return}const c={};let u=0;l.forEach(d=>{const h=d.key,p=d.val();if(p.timestamp<=r){console.log(` Deleting chat for: ${p.title||h} (${new Date(p.timestamp).toLocaleDateString()})`);const m=pe(ge,`chats/${h}`);mi(m).then(()=>console.log(` Deleted chats/${h}`)).catch(w=>console.error(` Failed to delete chats/${h}:`,w)),u++}}),u>0?console.log(` Auto Cleanup: Removed chat history for ${u} old videos.`):console.log(" Auto Cleanup: No chats needed deletion.")}catch(i){console.error(" Auto Cleanup Error:",i)}finally{e.value=!1}}}return{initAutoCleanup:n}}function tk(){let t=0,e=0,n=!1,s=null;const i=150,r=200;function o(){s=document.createElement("div"),s.id="pull-to-refresh-indicator",s.style.cssText=`
      position: fixed;
      top: -80px;
      left: 50%;
      transform: translateX(-50%);
      background: linear-gradient(135deg, #00e676 0%, #00c853 100%);
      color: white;
      padding: 12px 24px;
      border-radius: 0 0 16px 16px;
      font-size: 14px;
      font-weight: 600;
      z-index: 10000;
      transition: top 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 12px rgba(0, 230, 118, 0.3);
      display: flex;
      align-items: center;
      gap: 8px;
      pointer-events: none;
    `,document.body.appendChild(s)}function a(m){if(!s)return;const w=Math.min(m/i,1),C=Math.min(m/r*80,80)-80;m>=i?(s.innerHTML=" ",s.style.background="linear-gradient(135deg, #00e676 0%, #00c853 100%)"):(s.innerHTML=" ",s.style.background=`linear-gradient(135deg, rgba(0, 230, 118, ${w}) 0%, rgba(0, 200, 83, ${w}) 100%)`),s.style.top=`${C}px`,s.style.opacity=w}function l(){s&&(s.style.top="-80px",s.style.opacity="0")}function c(m){let w=m;for(;w&&w!==document.body;){const A=window.getComputedStyle(w).overflowY;if((A==="auto"||A==="scroll")&&w.scrollHeight>w.clientHeight)return w;w=w.parentElement}return null}let u=null;function d(m){u=c(m.target),(u?u.scrollTop===0:window.scrollY===0)&&(t=m.touches[0].clientY,n=!0)}function h(m){if(!n)return;e=m.touches[0].clientY;const w=e-t,C=u?u.scrollTop===0:window.scrollY===0;w>0&&C?(w>10&&m.preventDefault(),a(w)):(n=!1,l())}function p(){if(!n)return;const m=e-t,w=u?u.scrollTop===0:window.scrollY===0;m>=i&&w?(s&&(s.innerHTML=" ...",s.style.top="0px",s.style.opacity="1"),setTimeout(()=>{window.location.reload()},300)):l(),n=!1,t=0,e=0,u=null}return wn(()=>{o(),window.addEventListener("touchstart",d,{passive:!1}),window.addEventListener("touchmove",h,{passive:!1}),window.addEventListener("touchend",p,{passive:!0})}),Pa(()=>{window.removeEventListener("touchstart",d),window.removeEventListener("touchmove",h),window.removeEventListener("touchend",p),s&&s.parentNode&&s.parentNode.removeChild(s)}),{}}const nk="modulepreload",sk=function(t){return"/manowzab-v4/"+t},of={},Cc=function(e,n,s){let i=Promise.resolve();if(n&&n.length>0){let l=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");i=l(n.map(c=>{if(c=sk(c),c in of)return;of[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":nk,u||(h.as="script"),h.crossOrigin="",h.href=c,a&&h.setAttribute("nonce",a),document.head.appendChild(h),u)return new Promise((p,m)=>{h.addEventListener("load",p),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&r(a.reason);return e().catch(r)})};class ik{constructor(e){this.apiKeys=Array.isArray(e)?e:[e],this.currentKeyIndex=0,this.liveChatId=null,this.nextPageToken=null,this.pollingInterval=5e3,this.isPolling=!1,this.seenIds=new Set,this.timeoutId=null,this.onMessage=null,this.onError=null,this.onStatusChange=null,this.onRecovery=null,this.retryCount=0,this.maxRetries=10,this.baseRetryDelay=1e4,this.maxRetryDelay=12e4,this.wasInErrorState=!1}get apiKey(){return this.apiKeys[this.currentKeyIndex]}rotateKey(){return this.currentKeyIndex<this.apiKeys.length-1?(this.currentKeyIndex++,console.warn(` Switching to API Key #${this.currentKeyIndex+1}`),!0):!1}async fetchLiveChatId(e){const n=`https://www.googleapis.com/youtube/v3/videos?part=liveStreamingDetails&id=${e}&key=${this.apiKey}`;try{const i=await(await fetch(n)).json();if(i.error){if(this.rotateKey())return this.fetchLiveChatId(e);throw new Error(i.error.message)}if(!i.items||i.items.length===0)throw new Error("Video not found");const r=i.items[0].liveStreamingDetails;if(!r||!r.activeLiveChatId)throw new Error("No active live chat found (Stream might be offline or chat disabled)");return this.liveChatId=r.activeLiveChatId,this.liveChatId}catch(s){throw this.onError&&this.onError(s),s}}async startPolling(e,n){if(!this.isPolling)try{this.liveChatId||await this.fetchLiveChatId(e),this.isPolling=!0,this.onMessage=n,this.loadChat()}catch(s){console.error("Failed to start polling:",s),this.onError&&this.onError(s),this.onStatusChange&&this.onStatusChange("err")}}stopPolling(){this.isPolling=!1,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}async loadChat(){if(!this.isPolling||!this.liveChatId)return;const e=new URL("https://www.googleapis.com/youtube/v3/liveChat/messages");e.searchParams.append("liveChatId",this.liveChatId),e.searchParams.append("part","snippet,authorDetails"),e.searchParams.append("key",this.apiKey),this.nextPageToken&&e.searchParams.append("pageToken",this.nextPageToken);try{const s=await(await fetch(e.toString())).json();if(s.error){console.error("API Error during poll:",s.error.message,"Code:",s.error.code),this.onStatusChange&&this.onStatusChange("err"),this.wasInErrorState=!0;const i=s.error.code;if(i===403||i===429){if(this.rotateKey()){this.loadChat();return}}else console.warn(` API Error ${i}: Retrying without rotation...`);if(this.retryCount++,this.retryCount>this.maxRetries){console.error(` Max retries (${this.maxRetries}) exceeded. Stopping polling.`),this.onError&&this.onError(new Error(`Polling stopped: ${this.maxRetries} consecutive failures`)),this.stopPolling();return}const o=Math.min(this.baseRetryDelay*Math.pow(2,this.retryCount-1),this.maxRetryDelay);console.warn(` Retry ${this.retryCount}/${this.maxRetries} in ${(o/1e3).toFixed(0)}s...`),this.timeoutId=setTimeout(()=>this.loadChat(),o);return}(this.retryCount>0||this.wasInErrorState)&&(console.log(` Polling recovered after ${this.retryCount} retries`),this.onRecovery&&this.onRecovery(this.retryCount)),this.retryCount=0,this.wasInErrorState=!1,this.onStatusChange&&this.onStatusChange("ok"),s.pollingIntervalMillis&&(this.pollingInterval=s.pollingIntervalMillis),s.nextPageToken&&(this.nextPageToken=s.nextPageToken),s.items&&s.items.length>0&&(s.items.sort((i,r)=>new Date(i.snippet.publishedAt).getTime()-new Date(r.snippet.publishedAt).getTime()),s.items.forEach(i=>{if(!this.seenIds.has(i.id)){if(this.seenIds.add(i.id),this.seenIds.size>1e3){const r=this.seenIds.values();for(let o=0;o<200;o++){const a=r.next().value;this.seenIds.delete(a)}}this.onMessage&&this.onMessage(i)}}))}catch(n){if(console.error("Network error fetching chat:",n),this.onError&&this.onError(n),this.onStatusChange&&this.onStatusChange("err"),this.wasInErrorState=!0,this.retryCount++,this.retryCount>this.maxRetries){console.error(` Max retries (${this.maxRetries}) exceeded. Stopping polling.`),this.stopPolling();return}const s=Math.min(this.baseRetryDelay*Math.pow(2,this.retryCount-1),this.maxRetryDelay);this.timeoutId=setTimeout(()=>this.loadChat(),s);return}this.isPolling&&(this.timeoutId=setTimeout(()=>this.loadChat(),Math.max(this.pollingInterval,1e3)))}}function IR(t){if(t.snippet?.textMessageDetails?.messageText){const e=t.snippet.textMessageDetails.messageText;if(typeof e=="string")return[{text:e}];if(Array.isArray(e))return e.map(n=>n.text?{text:n.text}:n.emoji?{emoji:{emojiId:n.emoji.emojiId,image:n.emoji.image}}:{text:""})}return[{text:t.snippet?.displayMessage||""}]}const rk="AIzaSyAVzYQN51V-kITnyJWGy8IVSktitxrVD8g,AIzaSyBlnw6tpETYu61XSNqd7zXt25Fv_vmbWJU,AIzaSyAX3dwUqBFeCBjjZixVnlcBz56gAfNWzs0,AIzaSyAxjRAs01mpt-NxQiR3yStr6Q-57EiQq64,AIzaSyDDFimNW1OAMm8sOI0xFdKLv2Gk4SzxlFw,AIzaSyCR9yuYfig6jJIhVoWUZGKzY5hkT3DpJmM",To=rk.split(",").map(t=>t.trim()).filter(t=>t);if(To.length===0)throw new Error("Missing YouTube API Keys");function ok(){const t=Et(),{queueAudio:e}=Zs(),n=j(""),s=j(null),i=new ik(To);i.onStatusChange=u=>{t.statusChat=u};let r=null;async function o(u){try{t.statusApi="ok";let h=await(await fetch(u+"&key="+To[t.currentKeyIndex])).json();if(h.error){if(console.error(" API Error:",h.error.message),t.statusApi="warn",t.currentKeyIndex<To.length-1)return t.currentKeyIndex++,o(u);throw t.statusApi="err",new Error("All API keys exhausted")}return h}catch(d){throw t.statusApi="err",d}}async function a(u){try{console.log(" Connecting to video:",u),console.log(" Direct Mode: Fetching YouTube API...");const d=`https://www.googleapis.com/youtube/v3/videos?part=snippet,liveStreamingDetails&id=${u}`,h=await o(d);if(!h.items||h.items.length===0)throw new Error("Invalid Video ID");const p=h.items[0];t.liveTitle=p.snippet.title,console.log(" Video title:",p.snippet.title),u&&u!=="demo"&&hn(pe(ge,`history/${u}`),{title:p.snippet.title,timestamp:Date.now()}).catch(w=>console.error("Error saving history:",w));const m=await Cc(()=>Promise.resolve().then(()=>GT),void 0).then(w=>w.useChatStore());if(p.liveStreamingDetails?.actualStartTime?m.streamStartTime=new Date(p.liveStreamingDetails.actualStartTime).getTime():m.streamStartTime=Date.now(),p.liveStreamingDetails?.activeLiveChatId){n.value=p.liveStreamingDetails.activeLiveChatId,console.log(" Live Chat ID:",n.value);const{useChatProcessor:w}=await Cc(async()=>{const{useChatProcessor:A}=await import("./useChatProcessor-DXJ0_PqH.js");return{useChatProcessor:A}},[]),{processMessage:C}=w();return r=C,i.liveChatId=n.value,i.startPolling(u,async A=>{console.log(" RAW YouTube API Message:",JSON.stringify(A,null,2)),r&&await r(A)}),l(u),s.value=setInterval(()=>l(u),_i.YOUTUBE.VIEWER_POLL_INTERVAL_MS),e(null,"",`  ${p.snippet.title}`),!0}else return console.warn(" No active live chat found"),!1}catch(d){return console.error(" Connect video error:",d),t.statusApi="err",!1}}async function l(u){try{const d=`https://www.googleapis.com/youtube/v3/videos?part=liveStreamingDetails&id=${u}`,p=(await o(d)).items?.[0]?.liveStreamingDetails;if(p&&(p.concurrentViewers&&(t.viewerCount=parseInt(p.concurrentViewers)),p.actualEndTime&&(console.log(" Stream Finished:",p.actualEndTime),s.value))){clearInterval(s.value),s.value=null,e(null,"","");const m=_i.YOUTUBE.DISCONNECT_DELAY_MS/1e3;console.log(` Disconnecting in ${m} seconds...`),setTimeout(()=>{t.isConnected&&(e(null,"",""),c())},_i.YOUTUBE.DISCONNECT_DELAY_MS)}}catch(d){console.error(" Viewer Count Error:",d)}}function c(){console.log(" Disconnecting..."),t.isConnected=!1,i.stopPolling(),s.value&&(clearInterval(s.value),s.value=null),n.value="",r=null}return Ys(()=>{c()}),{activeChatId:n,connectVideo:a,disconnect:c}}function ak(){const t=j(localStorage.getItem("geminiApiKey")||"");async function e(s){if(!t.value)return null;const i=`
Role: You are an AI assistant for a Thai live commerce clothing shop (Manowzab). 
Your task is to extract the user's intent from their chat message.

Key Entities:
- **Product ID**: Usually a number (e.g., 1, 15, 99) or starts with F/CF (e.g., F1, CF10).
- **Price**: A number usually followed by "" or appearing after the ID (e.g., 10=100).

Intents:
1. **buy**: User wants to purchase an item.
   - Pattern: "[ID]", "F[ID]", "CF[ID]", " [ID]", "[ID] [Name]", "[ID]=[Price]".
   - CRITICAL EXCEPTION: If the message contains specific question words (, , , , ) OR specific attribute words (, , , , , ) appearing alongside a number, it is ALWAYS a "question", NOT a "buy".

2. **cancel**: User wants to cancel an order.
   - Pattern: "CC", "cancel", "", "".

3. **question**: User is asking about product details.
   - Keywords: , , , , , , , , , , , , .

4. **shipping**: User wants to ship items.
   - Keywords: "", "", "", "".

5. **spam**: Greetings, chit-chat.

Response Format (JSON only):
{"intent": "buy"|"cancel"|"question"|"shipping"|"spam", "id": number|null, "price": number|null}

Input Message: "${s}"
`;try{const a=(await(await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${t.value}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:i}]}]})})).json()).candidates?.[0]?.content?.parts?.[0]?.text?.match(/\{.*?\}/s);return a?JSON.parse(a[0]):null}catch(r){return console.error("Gemini Error:",r),null}}function n(s){t.value=s,localStorage.setItem("geminiApiKey",s)}return{apiKey:t,analyzeChat:e,setApiKey:n}}function sw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function lk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function af(t,e){return t.get(sw(t,e))}function ck(t,e,n){lk(t,e),e.set(t,n)}function uk(t,e,n){return t.set(sw(t,e),n),n}const dk=100,ue={},hk=()=>{ue.previousActiveElement instanceof HTMLElement?(ue.previousActiveElement.focus(),ue.previousActiveElement=null):document.body&&document.body.focus()},fk=t=>new Promise(e=>{if(!t)return e();const n=window.scrollX,s=window.scrollY;ue.restoreFocusTimeout=setTimeout(()=>{hk(),e()},dk),window.scrollTo(n,s)}),iw="swal2-",pk=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],N=pk.reduce((t,e)=>(t[e]=iw+e,t),{}),mk=["success","warning","info","question","error"],ca=mk.reduce((t,e)=>(t[e]=iw+e,t),{}),rw="SweetAlert2:",Bu=t=>t.charAt(0).toUpperCase()+t.slice(1),It=t=>{console.warn(`${rw} ${typeof t=="object"?t.join(" "):t}`)},ei=t=>{console.error(`${rw} ${t}`)},lf=[],gk=t=>{lf.includes(t)||(lf.push(t),It(t))},ow=(t,e=null)=>{gk(`"${t}" is deprecated and will be removed in the next major release.${e?` Use "${e}" instead.`:""}`)},il=t=>typeof t=="function"?t():t,Uu=t=>t&&typeof t.toPromise=="function",Zr=t=>Uu(t)?t.toPromise():Promise.resolve(t),Vu=t=>t&&Promise.resolve(t)===t,Tt=()=>document.body.querySelector(`.${N.container}`),eo=t=>{const e=Tt();return e?e.querySelector(t):null},Lt=t=>eo(`.${t}`),Pe=()=>Lt(N.popup),Wi=()=>Lt(N.icon),wk=()=>Lt(N["icon-content"]),aw=()=>Lt(N.title),Hu=()=>Lt(N["html-container"]),lw=()=>Lt(N.image),Wu=()=>Lt(N["progress-steps"]),rl=()=>Lt(N["validation-message"]),gn=()=>eo(`.${N.actions} .${N.confirm}`),ji=()=>eo(`.${N.actions} .${N.cancel}`),ti=()=>eo(`.${N.actions} .${N.deny}`),vk=()=>Lt(N["input-label"]),zi=()=>eo(`.${N.loader}`),to=()=>Lt(N.actions),cw=()=>Lt(N.footer),ol=()=>Lt(N["timer-progress-bar"]),ju=()=>Lt(N.close),_k=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,zu=()=>{const t=Pe();if(!t)return[];const e=t.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),n=Array.from(e).sort((r,o)=>{const a=parseInt(r.getAttribute("tabindex")||"0"),l=parseInt(o.getAttribute("tabindex")||"0");return a>l?1:a<l?-1:0}),s=t.querySelectorAll(_k),i=Array.from(s).filter(r=>r.getAttribute("tabindex")!=="-1");return[...new Set(n.concat(i))].filter(r=>xt(r))},qu=()=>xn(document.body,N.shown)&&!xn(document.body,N["toast-shown"])&&!xn(document.body,N["no-backdrop"]),al=()=>{const t=Pe();return t?xn(t,N.toast):!1},yk=()=>{const t=Pe();return t?t.hasAttribute("data-loading"):!1},$t=(t,e)=>{if(t.textContent="",e){const s=new DOMParser().parseFromString(e,"text/html"),i=s.querySelector("head");i&&Array.from(i.childNodes).forEach(o=>{t.appendChild(o)});const r=s.querySelector("body");r&&Array.from(r.childNodes).forEach(o=>{o instanceof HTMLVideoElement||o instanceof HTMLAudioElement?t.appendChild(o.cloneNode(!0)):t.appendChild(o)})}},xn=(t,e)=>{if(!e)return!1;const n=e.split(/\s+/);for(let s=0;s<n.length;s++)if(!t.classList.contains(n[s]))return!1;return!0},bk=(t,e)=>{Array.from(t.classList).forEach(n=>{!Object.values(N).includes(n)&&!Object.values(ca).includes(n)&&!Object.values(e.showClass||{}).includes(n)&&t.classList.remove(n)})},Mt=(t,e,n)=>{if(bk(t,e),!e.customClass)return;const s=e.customClass[n];if(s){if(typeof s!="string"&&!s.forEach){It(`Invalid type of customClass.${n}! Expected string or iterable object, got "${typeof s}"`);return}Ne(t,s)}},ll=(t,e)=>{if(!e)return null;switch(e){case"select":case"textarea":case"file":return t.querySelector(`.${N.popup} > .${N[e]}`);case"checkbox":return t.querySelector(`.${N.popup} > .${N.checkbox} input`);case"radio":return t.querySelector(`.${N.popup} > .${N.radio} input:checked`)||t.querySelector(`.${N.popup} > .${N.radio} input:first-child`);case"range":return t.querySelector(`.${N.popup} > .${N.range} input`);default:return t.querySelector(`.${N.popup} > .${N.input}`)}},uw=t=>{if(t.focus(),t.type!=="file"){const e=t.value;t.value="",t.value=e}},dw=(t,e,n)=>{!t||!e||(typeof e=="string"&&(e=e.split(/\s+/).filter(Boolean)),e.forEach(s=>{Array.isArray(t)?t.forEach(i=>{n?i.classList.add(s):i.classList.remove(s)}):n?t.classList.add(s):t.classList.remove(s)}))},Ne=(t,e)=>{dw(t,e,!0)},Ht=(t,e)=>{dw(t,e,!1)},Zn=(t,e)=>{const n=Array.from(t.children);for(let s=0;s<n.length;s++){const i=n[s];if(i instanceof HTMLElement&&xn(i,e))return i}},Fs=(t,e,n)=>{n===`${parseInt(`${n}`)}`&&(n=parseInt(n)),n||parseInt(`${n}`)===0?t.style.setProperty(e,typeof n=="number"?`${n}px`:n):t.style.removeProperty(e)},lt=(t,e="flex")=>{t&&(t.style.display=e)},mt=t=>{t&&(t.style.display="none")},Ku=(t,e="block")=>{t&&new MutationObserver(()=>{no(t,t.innerHTML,e)}).observe(t,{childList:!0,subtree:!0})},cf=(t,e,n,s)=>{const i=t.querySelector(e);i&&i.style.setProperty(n,s)},no=(t,e,n="flex")=>{e?lt(t,n):mt(t)},xt=t=>!!(t&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)),Ck=()=>!xt(gn())&&!xt(ti())&&!xt(ji()),Ec=t=>t.scrollHeight>t.clientHeight,Ek=(t,e)=>{let n=t;for(;n&&n!==e;){if(Ec(n))return!0;n=n.parentElement}return!1},hw=t=>{const e=window.getComputedStyle(t),n=parseFloat(e.getPropertyValue("animation-duration")||"0"),s=parseFloat(e.getPropertyValue("transition-duration")||"0");return n>0||s>0},Gu=(t,e=!1)=>{const n=ol();n&&xt(n)&&(e&&(n.style.transition="none",n.style.width="100%"),setTimeout(()=>{n.style.transition=`width ${t/1e3}s linear`,n.style.width="0%"},10))},Sk=()=>{const t=ol();if(!t)return;const e=parseInt(window.getComputedStyle(t).width);t.style.removeProperty("transition"),t.style.width="100%";const n=parseInt(window.getComputedStyle(t).width),s=e/n*100;t.style.width=`${s}%`},Ik=()=>typeof window>"u"||typeof document>"u",Tk=`
 <div aria-labelledby="${N.title}" aria-describedby="${N["html-container"]}" class="${N.popup}" tabindex="-1">
   <button type="button" class="${N.close}"></button>
   <ul class="${N["progress-steps"]}"></ul>
   <div class="${N.icon}"></div>
   <img class="${N.image}" />
   <h2 class="${N.title}" id="${N.title}"></h2>
   <div class="${N["html-container"]}" id="${N["html-container"]}"></div>
   <input class="${N.input}" id="${N.input}" />
   <input type="file" class="${N.file}" />
   <div class="${N.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${N.select}" id="${N.select}"></select>
   <div class="${N.radio}"></div>
   <label class="${N.checkbox}">
     <input type="checkbox" id="${N.checkbox}" />
     <span class="${N.label}"></span>
   </label>
   <textarea class="${N.textarea}" id="${N.textarea}"></textarea>
   <div class="${N["validation-message"]}" id="${N["validation-message"]}"></div>
   <div class="${N.actions}">
     <div class="${N.loader}"></div>
     <button type="button" class="${N.confirm}"></button>
     <button type="button" class="${N.deny}"></button>
     <button type="button" class="${N.cancel}"></button>
   </div>
   <div class="${N.footer}"></div>
   <div class="${N["timer-progress-bar-container"]}">
     <div class="${N["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),kk=()=>{const t=Tt();return t?(t.remove(),Ht([document.documentElement,document.body],[N["no-backdrop"],N["toast-shown"],N["has-column"]]),!0):!1},Ts=()=>{ue.currentInstance.resetValidationMessage()},Ak=()=>{const t=Pe(),e=Zn(t,N.input),n=Zn(t,N.file),s=t.querySelector(`.${N.range} input`),i=t.querySelector(`.${N.range} output`),r=Zn(t,N.select),o=t.querySelector(`.${N.checkbox} input`),a=Zn(t,N.textarea);e.oninput=Ts,n.onchange=Ts,r.onchange=Ts,o.onchange=Ts,a.oninput=Ts,s.oninput=()=>{Ts(),i.value=s.value},s.onchange=()=>{Ts(),i.value=s.value}},xk=t=>typeof t=="string"?document.querySelector(t):t,Pk=t=>{const e=Pe();e.setAttribute("role",t.toast?"alert":"dialog"),e.setAttribute("aria-live",t.toast?"polite":"assertive"),t.toast||e.setAttribute("aria-modal","true")},Rk=t=>{window.getComputedStyle(t).direction==="rtl"&&(Ne(Tt(),N.rtl),ue.isRTL=!0)},Nk=t=>{const e=kk();if(Ik()){ei("SweetAlert2 requires document to initialize");return}const n=document.createElement("div");n.className=N.container,e&&Ne(n,N["no-transition"]),$t(n,Tk),n.dataset.swal2Theme=t.theme;const s=xk(t.target);s.appendChild(n),t.topLayer&&(n.setAttribute("popover",""),n.showPopover()),Pk(t),Rk(s),Ak()},Yu=(t,e)=>{t instanceof HTMLElement?e.appendChild(t):typeof t=="object"?Ok(t,e):t&&$t(e,t)},Ok=(t,e)=>{t.jquery?Dk(e,t):$t(e,t.toString())},Dk=(t,e)=>{if(t.textContent="",0 in e)for(let n=0;n in e;n++)t.appendChild(e[n].cloneNode(!0));else t.appendChild(e.cloneNode(!0))},Mk=(t,e)=>{const n=to(),s=zi();!n||!s||(!e.showConfirmButton&&!e.showDenyButton&&!e.showCancelButton?mt(n):lt(n),Mt(n,e,"actions"),Lk(n,s,e),$t(s,e.loaderHtml||""),Mt(s,e,"loader"))};function Lk(t,e,n){const s=gn(),i=ti(),r=ji();!s||!i||!r||($l(s,"confirm",n),$l(i,"deny",n),$l(r,"cancel",n),$k(s,i,r,n),n.reverseButtons&&(n.toast?(t.insertBefore(r,s),t.insertBefore(i,s)):(t.insertBefore(r,e),t.insertBefore(i,e),t.insertBefore(s,e))))}function $k(t,e,n,s){if(!s.buttonsStyling){Ht([t,e,n],N.styled);return}Ne([t,e,n],N.styled),s.confirmButtonColor&&t.style.setProperty("--swal2-confirm-button-background-color",s.confirmButtonColor),s.denyButtonColor&&e.style.setProperty("--swal2-deny-button-background-color",s.denyButtonColor),s.cancelButtonColor&&n.style.setProperty("--swal2-cancel-button-background-color",s.cancelButtonColor),Ll(t),Ll(e),Ll(n)}function Ll(t){const e=window.getComputedStyle(t);if(e.getPropertyValue("--swal2-action-button-focus-box-shadow"))return;const n=e.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");t.style.setProperty("--swal2-action-button-focus-box-shadow",e.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${n}`))}function $l(t,e,n){const s=Bu(e);no(t,n[`show${s}Button`],"inline-block"),$t(t,n[`${e}ButtonText`]||""),t.setAttribute("aria-label",n[`${e}ButtonAriaLabel`]||""),t.className=N[e],Mt(t,n,`${e}Button`)}const Fk=(t,e)=>{const n=ju();n&&($t(n,e.closeButtonHtml||""),Mt(n,e,"closeButton"),no(n,e.showCloseButton),n.setAttribute("aria-label",e.closeButtonAriaLabel||""))},Bk=(t,e)=>{const n=Tt();n&&(Uk(n,e.backdrop),Vk(n,e.position),Hk(n,e.grow),Mt(n,e,"container"))};function Uk(t,e){typeof e=="string"?t.style.background=e:e||Ne([document.documentElement,document.body],N["no-backdrop"])}function Vk(t,e){e&&(e in N?Ne(t,N[e]):(It('The "position" parameter is not valid, defaulting to "center"'),Ne(t,N.center)))}function Hk(t,e){e&&Ne(t,N[`grow-${e}`])}var qe={innerParams:new WeakMap,domCache:new WeakMap};const Wk=["input","file","range","select","radio","checkbox","textarea"],jk=(t,e)=>{const n=Pe();if(!n)return;const s=qe.innerParams.get(t),i=!s||e.input!==s.input;Wk.forEach(r=>{const o=Zn(n,N[r]);o&&(Kk(r,e.inputAttributes),o.className=N[r],i&&mt(o))}),e.input&&(i&&zk(e),Gk(e))},zk=t=>{if(!t.input)return;if(!Ze[t.input]){ei(`Unexpected type of input! Expected ${Object.keys(Ze).join(" | ")}, got "${t.input}"`);return}const e=fw(t.input);if(!e)return;const n=Ze[t.input](e,t);lt(e),t.inputAutoFocus&&setTimeout(()=>{uw(n)})},qk=t=>{for(let e=0;e<t.attributes.length;e++){const n=t.attributes[e].name;["id","type","value","style"].includes(n)||t.removeAttribute(n)}},Kk=(t,e)=>{const n=Pe();if(!n)return;const s=ll(n,t);if(s){qk(s);for(const i in e)s.setAttribute(i,e[i])}},Gk=t=>{if(!t.input)return;const e=fw(t.input);e&&Mt(e,t,"input")},Qu=(t,e)=>{!t.placeholder&&e.inputPlaceholder&&(t.placeholder=e.inputPlaceholder)},so=(t,e,n)=>{if(n.inputLabel){const s=document.createElement("label"),i=N["input-label"];s.setAttribute("for",t.id),s.className=i,typeof n.customClass=="object"&&Ne(s,n.customClass.inputLabel),s.innerText=n.inputLabel,e.insertAdjacentElement("beforebegin",s)}},fw=t=>{const e=Pe();if(e)return Zn(e,N[t]||N.input)},ua=(t,e)=>{["string","number"].includes(typeof e)?t.value=`${e}`:Vu(e)||It(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof e}"`)},Ze={};Ze.text=Ze.email=Ze.password=Ze.number=Ze.tel=Ze.url=Ze.search=Ze.date=Ze["datetime-local"]=Ze.time=Ze.week=Ze.month=(t,e)=>(ua(t,e.inputValue),so(t,t,e),Qu(t,e),t.type=e.input,t);Ze.file=(t,e)=>(so(t,t,e),Qu(t,e),t);Ze.range=(t,e)=>{const n=t.querySelector("input"),s=t.querySelector("output");return ua(n,e.inputValue),n.type=e.input,ua(s,e.inputValue),so(n,t,e),t};Ze.select=(t,e)=>{if(t.textContent="",e.inputPlaceholder){const n=document.createElement("option");$t(n,e.inputPlaceholder),n.value="",n.disabled=!0,n.selected=!0,t.appendChild(n)}return so(t,t,e),t};Ze.radio=t=>(t.textContent="",t);Ze.checkbox=(t,e)=>{const n=ll(Pe(),"checkbox");n.value="1",n.checked=!!e.inputValue;const s=t.querySelector("span");return $t(s,e.inputPlaceholder||e.inputLabel),n};Ze.textarea=(t,e)=>{ua(t,e.inputValue),Qu(t,e),so(t,t,e);const n=s=>parseInt(window.getComputedStyle(s).marginLeft)+parseInt(window.getComputedStyle(s).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const s=parseInt(window.getComputedStyle(Pe()).width),i=()=>{if(!document.body.contains(t))return;const r=t.offsetWidth+n(t);r>s?Pe().style.width=`${r}px`:Fs(Pe(),"width",e.width)};new MutationObserver(i).observe(t,{attributes:!0,attributeFilter:["style"]})}}),t};const Yk=(t,e)=>{const n=Hu();n&&(Ku(n),Mt(n,e,"htmlContainer"),e.html?(Yu(e.html,n),lt(n,"block")):e.text?(n.textContent=e.text,lt(n,"block")):mt(n),jk(t,e))},Qk=(t,e)=>{const n=cw();n&&(Ku(n),no(n,!!e.footer,"block"),e.footer&&Yu(e.footer,n),Mt(n,e,"footer"))},Xk=(t,e)=>{const n=qe.innerParams.get(t),s=Wi();if(!s)return;if(n&&e.icon===n.icon){df(s,e),uf(s,e);return}if(!e.icon&&!e.iconHtml){mt(s);return}if(e.icon&&Object.keys(ca).indexOf(e.icon)===-1){ei(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${e.icon}"`),mt(s);return}lt(s),df(s,e),uf(s,e),Ne(s,e.showClass&&e.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",pw)},uf=(t,e)=>{for(const[n,s]of Object.entries(ca))e.icon!==n&&Ht(t,s);Ne(t,e.icon&&ca[e.icon]),e1(t,e),pw(),Mt(t,e,"icon")},pw=()=>{const t=Pe();if(!t)return;const e=window.getComputedStyle(t).getPropertyValue("background-color"),n=t.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let s=0;s<n.length;s++)n[s].style.backgroundColor=e},Jk=t=>`
  ${t.animation?'<div class="swal2-success-circular-line-left"></div>':""}
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div>
  ${t.animation?'<div class="swal2-success-fix"></div>':""}
  ${t.animation?'<div class="swal2-success-circular-line-right"></div>':""}
`,Zk=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,df=(t,e)=>{if(!e.icon&&!e.iconHtml)return;let n=t.innerHTML,s="";e.iconHtml?s=hf(e.iconHtml):e.icon==="success"?(s=Jk(e),n=n.replace(/ style=".*?"/g,"")):e.icon==="error"?s=Zk:e.icon&&(s=hf({question:"?",warning:"!",info:"i"}[e.icon])),n.trim()!==s.trim()&&$t(t,s)},e1=(t,e)=>{if(e.iconColor){t.style.color=e.iconColor,t.style.borderColor=e.iconColor;for(const n of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])cf(t,n,"background-color",e.iconColor);cf(t,".swal2-success-ring","border-color",e.iconColor)}},hf=t=>`<div class="${N["icon-content"]}">${t}</div>`,t1=(t,e)=>{const n=lw();if(n){if(!e.imageUrl){mt(n);return}lt(n,""),n.setAttribute("src",e.imageUrl),n.setAttribute("alt",e.imageAlt||""),Fs(n,"width",e.imageWidth),Fs(n,"height",e.imageHeight),n.className=N.image,Mt(n,e,"image")}};let Xu=!1,mw=0,gw=0,ww=0,vw=0;const n1=t=>{t.addEventListener("mousedown",da),document.body.addEventListener("mousemove",ha),t.addEventListener("mouseup",fa),t.addEventListener("touchstart",da),document.body.addEventListener("touchmove",ha),t.addEventListener("touchend",fa)},s1=t=>{t.removeEventListener("mousedown",da),document.body.removeEventListener("mousemove",ha),t.removeEventListener("mouseup",fa),t.removeEventListener("touchstart",da),document.body.removeEventListener("touchmove",ha),t.removeEventListener("touchend",fa)},da=t=>{const e=Pe();if(t.target===e||Wi().contains(t.target)){Xu=!0;const n=_w(t);mw=n.clientX,gw=n.clientY,ww=parseInt(e.style.insetInlineStart)||0,vw=parseInt(e.style.insetBlockStart)||0,Ne(e,"swal2-dragging")}},ha=t=>{const e=Pe();if(Xu){let{clientX:n,clientY:s}=_w(t);const i=n-mw;e.style.insetInlineStart=`${ww+(ue.isRTL?-i:i)}px`,e.style.insetBlockStart=`${vw+(s-gw)}px`}},fa=()=>{const t=Pe();Xu=!1,Ht(t,"swal2-dragging")},_w=t=>{let e=0,n=0;return t.type.startsWith("mouse")?(e=t.clientX,n=t.clientY):t.type.startsWith("touch")&&(e=t.touches[0].clientX,n=t.touches[0].clientY),{clientX:e,clientY:n}},i1=(t,e)=>{const n=Tt(),s=Pe();if(!(!n||!s)){if(e.toast){Fs(n,"width",e.width),s.style.width="100%";const i=zi();i&&s.insertBefore(i,Wi())}else Fs(s,"width",e.width);Fs(s,"padding",e.padding),e.color&&(s.style.color=e.color),e.background&&(s.style.background=e.background),mt(rl()),r1(s,e),e.draggable&&!e.toast?(Ne(s,N.draggable),n1(s)):(Ht(s,N.draggable),s1(s))}},r1=(t,e)=>{const n=e.showClass||{};t.className=`${N.popup} ${xt(t)?n.popup:""}`,e.toast?(Ne([document.documentElement,document.body],N["toast-shown"]),Ne(t,N.toast)):Ne(t,N.modal),Mt(t,e,"popup"),typeof e.customClass=="string"&&Ne(t,e.customClass),e.icon&&Ne(t,N[`icon-${e.icon}`])},o1=(t,e)=>{const n=Wu();if(!n)return;const{progressSteps:s,currentProgressStep:i}=e;if(!s||s.length===0||i===void 0){mt(n);return}lt(n),n.textContent="",i>=s.length&&It("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),s.forEach((r,o)=>{const a=a1(r);if(n.appendChild(a),o===i&&Ne(a,N["active-progress-step"]),o!==s.length-1){const l=l1(e);n.appendChild(l)}})},a1=t=>{const e=document.createElement("li");return Ne(e,N["progress-step"]),$t(e,t),e},l1=t=>{const e=document.createElement("li");return Ne(e,N["progress-step-line"]),t.progressStepsDistance&&Fs(e,"width",t.progressStepsDistance),e},c1=(t,e)=>{const n=aw();n&&(Ku(n),no(n,!!(e.title||e.titleText),"block"),e.title&&Yu(e.title,n),e.titleText&&(n.innerText=e.titleText),Mt(n,e,"title"))},yw=(t,e)=>{i1(t,e),Bk(t,e),o1(t,e),Xk(t,e),t1(t,e),c1(t,e),Fk(t,e),Yk(t,e),Mk(t,e),Qk(t,e);const n=Pe();typeof e.didRender=="function"&&n&&e.didRender(n),ue.eventEmitter.emit("didRender",n)},u1=()=>xt(Pe()),bw=()=>{var t;return(t=gn())===null||t===void 0?void 0:t.click()},d1=()=>{var t;return(t=ti())===null||t===void 0?void 0:t.click()},h1=()=>{var t;return(t=ji())===null||t===void 0?void 0:t.click()},qi=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),Cw=t=>{t.keydownTarget&&t.keydownHandlerAdded&&(t.keydownTarget.removeEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!1)},f1=(t,e,n)=>{Cw(t),e.toast||(t.keydownHandler=s=>m1(e,s,n),t.keydownTarget=e.keydownListenerCapture?window:Pe(),t.keydownListenerCapture=e.keydownListenerCapture,t.keydownTarget.addEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!0)},Sc=(t,e)=>{var n;const s=zu();if(s.length){t=t+e,t===-2&&(t=s.length-1),t===s.length?t=0:t===-1&&(t=s.length-1),s[t].focus();return}(n=Pe())===null||n===void 0||n.focus()},Ew=["ArrowRight","ArrowDown"],p1=["ArrowLeft","ArrowUp"],m1=(t,e,n)=>{t&&(e.isComposing||e.keyCode===229||(t.stopKeydownPropagation&&e.stopPropagation(),e.key==="Enter"?g1(e,t):e.key==="Tab"?w1(e):[...Ew,...p1].includes(e.key)?v1(e.key):e.key==="Escape"&&_1(e,t,n)))},g1=(t,e)=>{if(!il(e.allowEnterKey))return;const n=ll(Pe(),e.input);if(t.target&&n&&t.target instanceof HTMLElement&&t.target.outerHTML===n.outerHTML){if(["textarea","file"].includes(e.input))return;bw(),t.preventDefault()}},w1=t=>{const e=t.target,n=zu();let s=-1;for(let i=0;i<n.length;i++)if(e===n[i]){s=i;break}t.shiftKey?Sc(s,-1):Sc(s,1),t.stopPropagation(),t.preventDefault()},v1=t=>{const e=to(),n=gn(),s=ti(),i=ji();if(!e||!n||!s||!i)return;const r=[n,s,i];if(document.activeElement instanceof HTMLElement&&!r.includes(document.activeElement))return;const o=Ew.includes(t)?"nextElementSibling":"previousElementSibling";let a=document.activeElement;if(a){for(let l=0;l<e.children.length;l++){if(a=a[o],!a)return;if(a instanceof HTMLButtonElement&&xt(a))break}a instanceof HTMLButtonElement&&a.focus()}},_1=(t,e,n)=>{t.preventDefault(),il(e.allowEscapeKey)&&n(qi.esc)};var Pi={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const y1=()=>{const t=Tt();Array.from(document.body.children).forEach(n=>{n.contains(t)||(n.hasAttribute("aria-hidden")&&n.setAttribute("data-previous-aria-hidden",n.getAttribute("aria-hidden")||""),n.setAttribute("aria-hidden","true"))})},Sw=()=>{Array.from(document.body.children).forEach(e=>{e.hasAttribute("data-previous-aria-hidden")?(e.setAttribute("aria-hidden",e.getAttribute("data-previous-aria-hidden")||""),e.removeAttribute("data-previous-aria-hidden")):e.removeAttribute("aria-hidden")})},Iw=typeof window<"u"&&!!window.GestureEvent,b1=()=>{if(Iw&&!xn(document.body,N.iosfix)){const t=document.body.scrollTop;document.body.style.top=`${t*-1}px`,Ne(document.body,N.iosfix),C1()}},C1=()=>{const t=Tt();if(!t)return;let e;t.ontouchstart=n=>{e=E1(n)},t.ontouchmove=n=>{e&&(n.preventDefault(),n.stopPropagation())}},E1=t=>{const e=t.target,n=Tt(),s=Hu();return!n||!s||S1(t)||I1(t)?!1:e===n||!Ec(n)&&e instanceof HTMLElement&&!Ek(e,s)&&e.tagName!=="INPUT"&&e.tagName!=="TEXTAREA"&&!(Ec(s)&&s.contains(e))},S1=t=>t.touches&&t.touches.length&&t.touches[0].touchType==="stylus",I1=t=>t.touches&&t.touches.length>1,T1=()=>{if(xn(document.body,N.iosfix)){const t=parseInt(document.body.style.top,10);Ht(document.body,N.iosfix),document.body.style.top="",document.body.scrollTop=t*-1}},k1=()=>{const t=document.createElement("div");t.className=N["scrollbar-measure"],document.body.appendChild(t);const e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e};let yi=null;const A1=t=>{yi===null&&(document.body.scrollHeight>window.innerHeight||t==="scroll")&&(yi=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${yi+k1()}px`)},x1=()=>{yi!==null&&(document.body.style.paddingRight=`${yi}px`,yi=null)};function Tw(t,e,n,s){al()?ff(t,s):(fk(n).then(()=>ff(t,s)),Cw(ue)),Iw?(e.setAttribute("style","display:none !important"),e.removeAttribute("class"),e.innerHTML=""):e.remove(),qu()&&(x1(),T1(),Sw()),P1()}function P1(){Ht([document.documentElement,document.body],[N.shown,N["height-auto"],N["no-backdrop"],N["toast-shown"]])}function es(t){t=N1(t);const e=Pi.swalPromiseResolve.get(this),n=R1(this);this.isAwaitingPromise?t.isDismissed||(io(this),e(t)):n&&e(t)}const R1=t=>{const e=Pe();if(!e)return!1;const n=qe.innerParams.get(t);if(!n||xn(e,n.hideClass.popup))return!1;Ht(e,n.showClass.popup),Ne(e,n.hideClass.popup);const s=Tt();return Ht(s,n.showClass.backdrop),Ne(s,n.hideClass.backdrop),O1(t,e,n),!0};function kw(t){const e=Pi.swalPromiseReject.get(this);io(this),e&&e(t)}const io=t=>{t.isAwaitingPromise&&(delete t.isAwaitingPromise,qe.innerParams.get(t)||t._destroy())},N1=t=>typeof t>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},t),O1=(t,e,n)=>{var s;const i=Tt(),r=hw(e);typeof n.willClose=="function"&&n.willClose(e),(s=ue.eventEmitter)===null||s===void 0||s.emit("willClose",e),r?D1(t,e,i,n.returnFocus,n.didClose):Tw(t,i,n.returnFocus,n.didClose)},D1=(t,e,n,s,i)=>{ue.swalCloseEventFinishedCallback=Tw.bind(null,t,n,s,i);const r=function(o){if(o.target===e){var a;(a=ue.swalCloseEventFinishedCallback)===null||a===void 0||a.call(ue),delete ue.swalCloseEventFinishedCallback,e.removeEventListener("animationend",r),e.removeEventListener("transitionend",r)}};e.addEventListener("animationend",r),e.addEventListener("transitionend",r)},ff=(t,e)=>{setTimeout(()=>{var n;typeof e=="function"&&e.bind(t.params)(),(n=ue.eventEmitter)===null||n===void 0||n.emit("didClose"),t._destroy&&t._destroy()})},Ri=t=>{let e=Pe();if(e||new ve,e=Pe(),!e)return;const n=zi();al()?mt(Wi()):M1(e,t),lt(n),e.setAttribute("data-loading","true"),e.setAttribute("aria-busy","true"),e.focus()},M1=(t,e)=>{const n=to(),s=zi();!n||!s||(!e&&xt(gn())&&(e=gn()),lt(n),e&&(mt(e),s.setAttribute("data-button-to-replace",e.className),n.insertBefore(s,e)),Ne([t,n],N.loading))},L1=(t,e)=>{e.input==="select"||e.input==="radio"?V1(t,e):["text","email","number","tel","textarea"].some(n=>n===e.input)&&(Uu(e.inputValue)||Vu(e.inputValue))&&(Ri(gn()),H1(t,e))},$1=(t,e)=>{const n=t.getInput();if(!n)return null;switch(e.input){case"checkbox":return F1(n);case"radio":return B1(n);case"file":return U1(n);default:return e.inputAutoTrim?n.value.trim():n.value}},F1=t=>t.checked?1:0,B1=t=>t.checked?t.value:null,U1=t=>t.files&&t.files.length?t.getAttribute("multiple")!==null?t.files:t.files[0]:null,V1=(t,e)=>{const n=Pe();if(!n)return;const s=i=>{e.input==="select"?W1(n,pa(i),e):e.input==="radio"&&j1(n,pa(i),e)};Uu(e.inputOptions)||Vu(e.inputOptions)?(Ri(gn()),Zr(e.inputOptions).then(i=>{t.hideLoading(),s(i)})):typeof e.inputOptions=="object"?s(e.inputOptions):ei(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof e.inputOptions}`)},H1=(t,e)=>{const n=t.getInput();n&&(mt(n),Zr(e.inputValue).then(s=>{n.value=e.input==="number"?`${parseFloat(s)||0}`:`${s}`,lt(n),n.focus(),t.hideLoading()}).catch(s=>{ei(`Error in inputValue promise: ${s}`),n.value="",lt(n),n.focus(),t.hideLoading()}))};function W1(t,e,n){const s=Zn(t,N.select);if(!s)return;const i=(r,o,a)=>{const l=document.createElement("option");l.value=a,$t(l,o),l.selected=Aw(a,n.inputValue),r.appendChild(l)};e.forEach(r=>{const o=r[0],a=r[1];if(Array.isArray(a)){const l=document.createElement("optgroup");l.label=o,l.disabled=!1,s.appendChild(l),a.forEach(c=>i(l,c[1],c[0]))}else i(s,a,o)}),s.focus()}function j1(t,e,n){const s=Zn(t,N.radio);if(!s)return;e.forEach(r=>{const o=r[0],a=r[1],l=document.createElement("input"),c=document.createElement("label");l.type="radio",l.name=N.radio,l.value=o,Aw(o,n.inputValue)&&(l.checked=!0);const u=document.createElement("span");$t(u,a),u.className=N.label,c.appendChild(l),c.appendChild(u),s.appendChild(c)});const i=s.querySelectorAll("input");i.length&&i[0].focus()}const pa=t=>{const e=[];return t instanceof Map?t.forEach((n,s)=>{let i=n;typeof i=="object"&&(i=pa(i)),e.push([s,i])}):Object.keys(t).forEach(n=>{let s=t[n];typeof s=="object"&&(s=pa(s)),e.push([n,s])}),e},Aw=(t,e)=>!!e&&e.toString()===t.toString(),z1=t=>{const e=qe.innerParams.get(t);t.disableButtons(),e.input?xw(t,"confirm"):Zu(t,!0)},q1=t=>{const e=qe.innerParams.get(t);t.disableButtons(),e.returnInputValueOnDeny?xw(t,"deny"):Ju(t,!1)},K1=(t,e)=>{t.disableButtons(),e(qi.cancel)},xw=(t,e)=>{const n=qe.innerParams.get(t);if(!n.input){ei(`The "input" parameter is needed to be set when using returnInputValueOn${Bu(e)}`);return}const s=t.getInput(),i=$1(t,n);n.inputValidator?G1(t,i,e):s&&!s.checkValidity()?(t.enableButtons(),t.showValidationMessage(n.validationMessage||s.validationMessage)):e==="deny"?Ju(t,i):Zu(t,i)},G1=(t,e,n)=>{const s=qe.innerParams.get(t);t.disableInput(),Promise.resolve().then(()=>Zr(s.inputValidator(e,s.validationMessage))).then(r=>{t.enableButtons(),t.enableInput(),r?t.showValidationMessage(r):n==="deny"?Ju(t,e):Zu(t,e)})},Ju=(t,e)=>{const n=qe.innerParams.get(t||void 0);n.showLoaderOnDeny&&Ri(ti()),n.preDeny?(t.isAwaitingPromise=!0,Promise.resolve().then(()=>Zr(n.preDeny(e,n.validationMessage))).then(i=>{i===!1?(t.hideLoading(),io(t)):t.close({isDenied:!0,value:typeof i>"u"?e:i})}).catch(i=>Pw(t||void 0,i))):t.close({isDenied:!0,value:e})},pf=(t,e)=>{t.close({isConfirmed:!0,value:e})},Pw=(t,e)=>{t.rejectPromise(e)},Zu=(t,e)=>{const n=qe.innerParams.get(t||void 0);n.showLoaderOnConfirm&&Ri(),n.preConfirm?(t.resetValidationMessage(),t.isAwaitingPromise=!0,Promise.resolve().then(()=>Zr(n.preConfirm(e,n.validationMessage))).then(i=>{xt(rl())||i===!1?(t.hideLoading(),io(t)):pf(t,typeof i>"u"?e:i)}).catch(i=>Pw(t||void 0,i))):pf(t,e)};function ma(){const t=qe.innerParams.get(this);if(!t)return;const e=qe.domCache.get(this);mt(e.loader),al()?t.icon&&lt(Wi()):Y1(e),Ht([e.popup,e.actions],N.loading),e.popup.removeAttribute("aria-busy"),e.popup.removeAttribute("data-loading"),e.confirmButton.disabled=!1,e.denyButton.disabled=!1,e.cancelButton.disabled=!1}const Y1=t=>{const e=t.popup.getElementsByClassName(t.loader.getAttribute("data-button-to-replace"));e.length?lt(e[0],"inline-block"):Ck()&&mt(t.actions)};function Rw(){const t=qe.innerParams.get(this),e=qe.domCache.get(this);return e?ll(e.popup,t.input):null}function Nw(t,e,n){const s=qe.domCache.get(t);e.forEach(i=>{s[i].disabled=n})}function Ow(t,e){const n=Pe();if(!(!n||!t))if(t.type==="radio"){const s=n.querySelectorAll(`[name="${N.radio}"]`);for(let i=0;i<s.length;i++)s[i].disabled=e}else t.disabled=e}function Dw(){Nw(this,["confirmButton","denyButton","cancelButton"],!1)}function Mw(){Nw(this,["confirmButton","denyButton","cancelButton"],!0)}function Lw(){Ow(this.getInput(),!1)}function $w(){Ow(this.getInput(),!0)}function Fw(t){const e=qe.domCache.get(this),n=qe.innerParams.get(this);$t(e.validationMessage,t),e.validationMessage.className=N["validation-message"],n.customClass&&n.customClass.validationMessage&&Ne(e.validationMessage,n.customClass.validationMessage),lt(e.validationMessage);const s=this.getInput();s&&(s.setAttribute("aria-invalid","true"),s.setAttribute("aria-describedby",N["validation-message"]),uw(s),Ne(s,N.inputerror))}function Bw(){const t=qe.domCache.get(this);t.validationMessage&&mt(t.validationMessage);const e=this.getInput();e&&(e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),Ht(e,N.inputerror))}const bi={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},Q1=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],X1={allowEnterKey:void 0},J1=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],Uw=t=>Object.prototype.hasOwnProperty.call(bi,t),Vw=t=>Q1.indexOf(t)!==-1,Hw=t=>X1[t],Z1=t=>{Uw(t)||It(`Unknown parameter "${t}"`)},eA=t=>{J1.includes(t)&&It(`The parameter "${t}" is incompatible with toasts`)},tA=t=>{const e=Hw(t);e&&ow(t,e)},Ww=t=>{t.backdrop===!1&&t.allowOutsideClick&&It('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),t.theme&&!["light","dark","auto","minimal","borderless","bootstrap-4","bootstrap-4-light","bootstrap-4-dark","bootstrap-5","bootstrap-5-light","bootstrap-5-dark","material-ui","material-ui-light","material-ui-dark","embed-iframe","bulma","bulma-light","bulma-dark"].includes(t.theme)&&It(`Invalid theme "${t.theme}"`);for(const e in t)Z1(e),t.toast&&eA(e),tA(e)};function jw(t){const e=Tt(),n=Pe(),s=qe.innerParams.get(this);if(!n||xn(n,s.hideClass.popup)){It("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const i=nA(t),r=Object.assign({},s,i);Ww(r),e.dataset.swal2Theme=r.theme,yw(this,r),qe.innerParams.set(this,r),Object.defineProperties(this,{params:{value:Object.assign({},this.params,t),writable:!1,enumerable:!0}})}const nA=t=>{const e={};return Object.keys(t).forEach(n=>{Vw(n)?e[n]=t[n]:It(`Invalid parameter to update: ${n}`)}),e};function zw(){const t=qe.domCache.get(this),e=qe.innerParams.get(this);if(!e){qw(this);return}t.popup&&ue.swalCloseEventFinishedCallback&&(ue.swalCloseEventFinishedCallback(),delete ue.swalCloseEventFinishedCallback),typeof e.didDestroy=="function"&&e.didDestroy(),ue.eventEmitter.emit("didDestroy"),sA(this)}const sA=t=>{qw(t),delete t.params,delete ue.keydownHandler,delete ue.keydownTarget,delete ue.currentInstance},qw=t=>{t.isAwaitingPromise?(Fl(qe,t),t.isAwaitingPromise=!0):(Fl(Pi,t),Fl(qe,t),delete t.isAwaitingPromise,delete t.disableButtons,delete t.enableButtons,delete t.getInput,delete t.disableInput,delete t.enableInput,delete t.hideLoading,delete t.disableLoading,delete t.showValidationMessage,delete t.resetValidationMessage,delete t.close,delete t.closePopup,delete t.closeModal,delete t.closeToast,delete t.rejectPromise,delete t.update,delete t._destroy)},Fl=(t,e)=>{for(const n in t)t[n].delete(e)};var iA=Object.freeze({__proto__:null,_destroy:zw,close:es,closeModal:es,closePopup:es,closeToast:es,disableButtons:Mw,disableInput:$w,disableLoading:ma,enableButtons:Dw,enableInput:Lw,getInput:Rw,handleAwaitingPromise:io,hideLoading:ma,rejectPromise:kw,resetValidationMessage:Bw,showValidationMessage:Fw,update:jw});const rA=(t,e,n)=>{t.toast?oA(t,e,n):(lA(e),cA(e),uA(t,e,n))},oA=(t,e,n)=>{e.popup.onclick=()=>{t&&(aA(t)||t.timer||t.input)||n(qi.close)}},aA=t=>!!(t.showConfirmButton||t.showDenyButton||t.showCancelButton||t.showCloseButton);let ga=!1;const lA=t=>{t.popup.onmousedown=()=>{t.container.onmouseup=function(e){t.container.onmouseup=()=>{},e.target===t.container&&(ga=!0)}}},cA=t=>{t.container.onmousedown=e=>{e.target===t.container&&e.preventDefault(),t.popup.onmouseup=function(n){t.popup.onmouseup=()=>{},(n.target===t.popup||n.target instanceof HTMLElement&&t.popup.contains(n.target))&&(ga=!0)}}},uA=(t,e,n)=>{e.container.onclick=s=>{if(ga){ga=!1;return}s.target===e.container&&il(t.allowOutsideClick)&&n(qi.backdrop)}},dA=t=>typeof t=="object"&&t.jquery,mf=t=>t instanceof Element||dA(t),hA=t=>{const e={};return typeof t[0]=="object"&&!mf(t[0])?Object.assign(e,t[0]):["title","html","icon"].forEach((n,s)=>{const i=t[s];typeof i=="string"||mf(i)?e[n]=i:i!==void 0&&ei(`Unexpected type of ${n}! Expected "string" or "Element", got ${typeof i}`)}),e};function fA(...t){return new this(...t)}function pA(t){class e extends this{_main(s,i){return super._main(s,Object.assign({},t,i))}}return e}const mA=()=>ue.timeout&&ue.timeout.getTimerLeft(),Kw=()=>{if(ue.timeout)return Sk(),ue.timeout.stop()},Gw=()=>{if(ue.timeout){const t=ue.timeout.start();return Gu(t),t}},gA=()=>{const t=ue.timeout;return t&&(t.running?Kw():Gw())},wA=t=>{if(ue.timeout){const e=ue.timeout.increase(t);return Gu(e,!0),e}},vA=()=>!!(ue.timeout&&ue.timeout.isRunning());let gf=!1;const Ic={};function _A(t="data-swal-template"){Ic[t]=this,gf||(document.body.addEventListener("click",yA),gf=!0)}const yA=t=>{for(let e=t.target;e&&e!==document;e=e.parentNode)for(const n in Ic){const s=e.getAttribute(n);if(s){Ic[n].fire({template:s});return}}};class bA{constructor(){this.events={}}_getHandlersByEventName(e){return typeof this.events[e]>"u"&&(this.events[e]=[]),this.events[e]}on(e,n){const s=this._getHandlersByEventName(e);s.includes(n)||s.push(n)}once(e,n){const s=(...i)=>{this.removeListener(e,s),n.apply(this,i)};this.on(e,s)}emit(e,...n){this._getHandlersByEventName(e).forEach(s=>{try{s.apply(this,n)}catch(i){console.error(i)}})}removeListener(e,n){const s=this._getHandlersByEventName(e),i=s.indexOf(n);i>-1&&s.splice(i,1)}removeAllListeners(e){this.events[e]!==void 0&&(this.events[e].length=0)}reset(){this.events={}}}ue.eventEmitter=new bA;const CA=(t,e)=>{ue.eventEmitter.on(t,e)},EA=(t,e)=>{ue.eventEmitter.once(t,e)},SA=(t,e)=>{if(!t){ue.eventEmitter.reset();return}e?ue.eventEmitter.removeListener(t,e):ue.eventEmitter.removeAllListeners(t)};var IA=Object.freeze({__proto__:null,argsToParams:hA,bindClickHandler:_A,clickCancel:h1,clickConfirm:bw,clickDeny:d1,enableLoading:Ri,fire:fA,getActions:to,getCancelButton:ji,getCloseButton:ju,getConfirmButton:gn,getContainer:Tt,getDenyButton:ti,getFocusableElements:zu,getFooter:cw,getHtmlContainer:Hu,getIcon:Wi,getIconContent:wk,getImage:lw,getInputLabel:vk,getLoader:zi,getPopup:Pe,getProgressSteps:Wu,getTimerLeft:mA,getTimerProgressBar:ol,getTitle:aw,getValidationMessage:rl,increaseTimer:wA,isDeprecatedParameter:Hw,isLoading:yk,isTimerRunning:vA,isUpdatableParameter:Vw,isValidParameter:Uw,isVisible:u1,mixin:pA,off:SA,on:CA,once:EA,resumeTimer:Gw,showLoading:Ri,stopTimer:Kw,toggleTimer:gA});class TA{constructor(e,n){this.callback=e,this.remaining=n,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(e){const n=this.running;return n&&this.stop(),this.remaining+=e,n&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const Yw=["swal-title","swal-html","swal-footer"],kA=t=>{const e=typeof t.template=="string"?document.querySelector(t.template):t.template;if(!e)return{};const n=e.content;return MA(n),Object.assign(AA(n),xA(n),PA(n),RA(n),NA(n),OA(n),DA(n,Yw))},AA=t=>{const e={};return Array.from(t.querySelectorAll("swal-param")).forEach(s=>{Gs(s,["name","value"]);const i=s.getAttribute("name"),r=s.getAttribute("value");!i||!r||(typeof bi[i]=="boolean"?e[i]=r!=="false":typeof bi[i]=="object"?e[i]=JSON.parse(r):e[i]=r)}),e},xA=t=>{const e={};return Array.from(t.querySelectorAll("swal-function-param")).forEach(s=>{const i=s.getAttribute("name"),r=s.getAttribute("value");!i||!r||(e[i]=new Function(`return ${r}`)())}),e},PA=t=>{const e={};return Array.from(t.querySelectorAll("swal-button")).forEach(s=>{Gs(s,["type","color","aria-label"]);const i=s.getAttribute("type");!i||!["confirm","cancel","deny"].includes(i)||(e[`${i}ButtonText`]=s.innerHTML,e[`show${Bu(i)}Button`]=!0,s.hasAttribute("color")&&(e[`${i}ButtonColor`]=s.getAttribute("color")),s.hasAttribute("aria-label")&&(e[`${i}ButtonAriaLabel`]=s.getAttribute("aria-label")))}),e},RA=t=>{const e={},n=t.querySelector("swal-image");return n&&(Gs(n,["src","width","height","alt"]),n.hasAttribute("src")&&(e.imageUrl=n.getAttribute("src")||void 0),n.hasAttribute("width")&&(e.imageWidth=n.getAttribute("width")||void 0),n.hasAttribute("height")&&(e.imageHeight=n.getAttribute("height")||void 0),n.hasAttribute("alt")&&(e.imageAlt=n.getAttribute("alt")||void 0)),e},NA=t=>{const e={},n=t.querySelector("swal-icon");return n&&(Gs(n,["type","color"]),n.hasAttribute("type")&&(e.icon=n.getAttribute("type")),n.hasAttribute("color")&&(e.iconColor=n.getAttribute("color")),e.iconHtml=n.innerHTML),e},OA=t=>{const e={},n=t.querySelector("swal-input");n&&(Gs(n,["type","label","placeholder","value"]),e.input=n.getAttribute("type")||"text",n.hasAttribute("label")&&(e.inputLabel=n.getAttribute("label")),n.hasAttribute("placeholder")&&(e.inputPlaceholder=n.getAttribute("placeholder")),n.hasAttribute("value")&&(e.inputValue=n.getAttribute("value")));const s=Array.from(t.querySelectorAll("swal-input-option"));return s.length&&(e.inputOptions={},s.forEach(i=>{Gs(i,["value"]);const r=i.getAttribute("value");if(!r)return;const o=i.innerHTML;e.inputOptions[r]=o})),e},DA=(t,e)=>{const n={};for(const s in e){const i=e[s],r=t.querySelector(i);r&&(Gs(r,[]),n[i.replace(/^swal-/,"")]=r.innerHTML.trim())}return n},MA=t=>{const e=Yw.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(t.children).forEach(n=>{const s=n.tagName.toLowerCase();e.includes(s)||It(`Unrecognized element <${s}>`)})},Gs=(t,e)=>{Array.from(t.attributes).forEach(n=>{e.indexOf(n.name)===-1&&It([`Unrecognized attribute "${n.name}" on <${t.tagName.toLowerCase()}>.`,`${e.length?`Allowed attributes are: ${e.join(", ")}`:"To set the value, use HTML within the element."}`])})},Qw=10,LA=t=>{const e=Tt(),n=Pe();typeof t.willOpen=="function"&&t.willOpen(n),ue.eventEmitter.emit("willOpen",n);const i=window.getComputedStyle(document.body).overflowY;BA(e,n,t),setTimeout(()=>{$A(e,n)},Qw),qu()&&(FA(e,t.scrollbarPadding,i),y1()),!al()&&!ue.previousActiveElement&&(ue.previousActiveElement=document.activeElement),typeof t.didOpen=="function"&&setTimeout(()=>t.didOpen(n)),ue.eventEmitter.emit("didOpen",n)},wa=t=>{const e=Pe();if(t.target!==e)return;const n=Tt();e.removeEventListener("animationend",wa),e.removeEventListener("transitionend",wa),n.style.overflowY="auto",Ht(n,N["no-transition"])},$A=(t,e)=>{hw(e)?(t.style.overflowY="hidden",e.addEventListener("animationend",wa),e.addEventListener("transitionend",wa)):t.style.overflowY="auto"},FA=(t,e,n)=>{b1(),e&&n!=="hidden"&&A1(n),setTimeout(()=>{t.scrollTop=0})},BA=(t,e,n)=>{Ne(t,n.showClass.backdrop),n.animation?(e.style.setProperty("opacity","0","important"),lt(e,"grid"),setTimeout(()=>{Ne(e,n.showClass.popup),e.style.removeProperty("opacity")},Qw)):lt(e,"grid"),Ne([document.documentElement,document.body],N.shown),n.heightAuto&&n.backdrop&&!n.toast&&Ne([document.documentElement,document.body],N["height-auto"])};var wf={email:(t,e)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid email address"),url:(t,e)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid URL")};function UA(t){t.inputValidator||(t.input==="email"&&(t.inputValidator=wf.email),t.input==="url"&&(t.inputValidator=wf.url))}function VA(t){(!t.target||typeof t.target=="string"&&!document.querySelector(t.target)||typeof t.target!="string"&&!t.target.appendChild)&&(It('Target parameter is not valid, defaulting to "body"'),t.target="body")}function HA(t){UA(t),t.showLoaderOnConfirm&&!t.preConfirm&&It(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),VA(t),typeof t.title=="string"&&(t.title=t.title.split(`
`).join("<br />")),Nk(t)}let ln;var go=new WeakMap;class tt{constructor(...e){if(ck(this,go,void 0),typeof window>"u")return;ln=this;const n=Object.freeze(this.constructor.argsToParams(e));this.params=n,this.isAwaitingPromise=!1,uk(go,this,this._main(ln.params))}_main(e,n={}){if(Ww(Object.assign({},n,e)),ue.currentInstance){const r=Pi.swalPromiseResolve.get(ue.currentInstance),{isAwaitingPromise:o}=ue.currentInstance;ue.currentInstance._destroy(),o||r({isDismissed:!0}),qu()&&Sw()}ue.currentInstance=ln;const s=jA(e,n);HA(s),Object.freeze(s),ue.timeout&&(ue.timeout.stop(),delete ue.timeout),clearTimeout(ue.restoreFocusTimeout);const i=zA(ln);return yw(ln,s),qe.innerParams.set(ln,s),WA(ln,i,s)}then(e){return af(go,this).then(e)}finally(e){return af(go,this).finally(e)}}const WA=(t,e,n)=>new Promise((s,i)=>{const r=o=>{t.close({isDismissed:!0,dismiss:o,isConfirmed:!1,isDenied:!1})};Pi.swalPromiseResolve.set(t,s),Pi.swalPromiseReject.set(t,i),e.confirmButton.onclick=()=>{z1(t)},e.denyButton.onclick=()=>{q1(t)},e.cancelButton.onclick=()=>{K1(t,r)},e.closeButton.onclick=()=>{r(qi.close)},rA(n,e,r),f1(ue,n,r),L1(t,n),LA(n),qA(ue,n,r),KA(e,n),setTimeout(()=>{e.container.scrollTop=0})}),jA=(t,e)=>{const n=kA(t),s=Object.assign({},bi,e,n,t);return s.showClass=Object.assign({},bi.showClass,s.showClass),s.hideClass=Object.assign({},bi.hideClass,s.hideClass),s.animation===!1&&(s.showClass={backdrop:"swal2-noanimation"},s.hideClass={}),s},zA=t=>{const e={popup:Pe(),container:Tt(),actions:to(),confirmButton:gn(),denyButton:ti(),cancelButton:ji(),loader:zi(),closeButton:ju(),validationMessage:rl(),progressSteps:Wu()};return qe.domCache.set(t,e),e},qA=(t,e,n)=>{const s=ol();mt(s),e.timer&&(t.timeout=new TA(()=>{n("timer"),delete t.timeout},e.timer),e.timerProgressBar&&(lt(s),Mt(s,e,"timerProgressBar"),setTimeout(()=>{t.timeout&&t.timeout.running&&Gu(e.timer)})))},KA=(t,e)=>{if(!e.toast){if(!il(e.allowEnterKey)){ow("allowEnterKey"),QA();return}GA(t)||YA(t,e)||Sc(-1,1)}},GA=t=>{const e=Array.from(t.popup.querySelectorAll("[autofocus]"));for(const n of e)if(n instanceof HTMLElement&&xt(n))return n.focus(),!0;return!1},YA=(t,e)=>e.focusDeny&&xt(t.denyButton)?(t.denyButton.focus(),!0):e.focusCancel&&xt(t.cancelButton)?(t.cancelButton.focus(),!0):e.focusConfirm&&xt(t.confirmButton)?(t.confirmButton.focus(),!0):!1,QA=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};tt.prototype.disableButtons=Mw;tt.prototype.enableButtons=Dw;tt.prototype.getInput=Rw;tt.prototype.disableInput=$w;tt.prototype.enableInput=Lw;tt.prototype.hideLoading=ma;tt.prototype.disableLoading=ma;tt.prototype.showValidationMessage=Fw;tt.prototype.resetValidationMessage=Bw;tt.prototype.close=es;tt.prototype.closePopup=es;tt.prototype.closeModal=es;tt.prototype.closeToast=es;tt.prototype.rejectPromise=kw;tt.prototype.update=jw;tt.prototype._destroy=zw;Object.assign(tt,IA);Object.keys(iA).forEach(t=>{tt[t]=function(...e){return ln&&ln[t]?ln[t](...e):null}});tt.DismissReason=qi;tt.version="11.26.10";const ve=tt;ve.default=ve;typeof document<"u"&&(function(t,e){var n=t.createElement("style");if(t.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=e);else try{n.innerHTML=e}catch{n.innerText=e}})(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.15s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border: 1px solid #d9d9d9;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.2s, box-shadow 0.2s;--swal2-input-hover-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-focus-border: 1px solid #b4dbed;--swal2-input-focus-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-footer-border-color: #eee;--swal2-footer-background: transparent;--swal2-footer-color: inherit;--swal2-timer-progress-bar-background: rgba(0, 0, 0, 0.3);--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.2s, box-shadow 0.2s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-actions-justify-content: center;--swal2-actions-width: auto;--swal2-actions-margin: 1.25em auto 0;--swal2-actions-padding: 0;--swal2-actions-border-radius: 0;--swal2-actions-background: transparent;--swal2-action-button-transition: background-color 0.2s, box-shadow 0.2s;--swal2-action-button-hover: black 10%;--swal2-action-button-active: black 10%;--swal2-confirm-button-box-shadow: none;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-confirm-button-color: #fff;--swal2-deny-button-box-shadow: none;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-deny-button-color: #fff;--swal2-cancel-button-box-shadow: none;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-cancel-button-color: #fff;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white);--swal2-timer-progress-bar-background: rgba(255, 255, 255, 0.7)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white);--swal2-timer-progress-bar-background: rgba(255, 255, 255, 0.7)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;overflow-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:var(--swal2-actions-justify-content);width:var(--swal2-actions-width);margin:var(--swal2-actions-margin);padding:var(--swal2-actions-padding);border-radius:var(--swal2-actions-border-radius);background:var(--swal2-actions-background)}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-action-button-transition);border:none;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);box-shadow:var(--swal2-confirm-button-box-shadow);color:var(--swal2-confirm-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):hover{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):active{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);box-shadow:var(--swal2-deny-button-box-shadow);color:var(--swal2-deny-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):hover{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):active{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);box-shadow:var(--swal2-cancel-button-box-shadow);color:var(--swal2-cancel-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):hover{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):active{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-styled)[disabled]:not(.swal2-loading){opacity:.4}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);background:var(--swal2-footer-background);color:var(--swal2-footer-color);font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:var(--swal2-timer-progress-bar-background)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;overflow-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:var(--swal2-input-border);border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):hover,div:where(.swal2-container) input:where(.swal2-file):hover,div:where(.swal2-container) textarea:where(.swal2-textarea):hover{box-shadow:var(--swal2-input-hover-box-shadow)}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:var(--swal2-input-focus-border);outline:none;box-shadow:var(--swal2-input-focus-box-shadow)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:translate3d(0, -50px, 0) scale(0.9);opacity:0}100%{transform:translate3d(0, 0, 0) scale(1);opacity:1}}@keyframes swal2-hide{0%{transform:translate3d(0, 0, 0) scale(1);opacity:1}100%{transform:translate3d(0, -50px, 0) scale(0.9);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');const XA={class:"header"},JA={class:"header-controls"},ZA={class:"status-cluster"},e2=["title"],t2=["title"],n2=["title"],s2=["title"],i2=["disabled"],r2=["title"],o2={key:0,class:"ml-2 text-lg font-bold font-mono drop-shadow-sm"},a2={class:"header-info"},l2={class:"live-viewers"},c2={class:"live-title"},u2=["title"],d2={__name:"Header",setup(t){const e={log:(...E)=>{},warn:(...E)=>{},error:(...E)=>{console.error(...E)}},n=Et(),s=Jr(),i=Hi(),{connectVideo:r,disconnect:o}=ok(),{setApiKey:a}=ak(),{queueSpeech:l,unlockAudio:c}=Zs(),u=Ms("openDashboard"),d=Ms("openHistory"),h=j(""),p=j(!1),m=j(!1),w=j(!1),C=j({}),A=j(null),W=j({});let B=null;Ot(()=>n.currentVideoId,E=>{E&&E!=="demo"&&E!==h.value&&(h.value=E)});const V=Ge(()=>{const E=C.value[n.currentVideoId]||{},k=new Set;return Object.keys(i.stockData).forEach(q=>{i.stockData[q]?.uid&&k.add(i.stockData[q].uid)}),Object.keys(E).filter(q=>E[q]?.ready&&k.has(q)).length});function Z(E){const k={db:{ok:"  Firebase ",warn:" Firebase ",err:"  Firebase"},api:{ok:" YouTube API ",warn:" API Key  Quota",err:" YouTube API "},chat:{ok:" ",warn:" ",err:" ",idle:" "}},q=E==="db"?n.statusDb:E==="api"?n.statusApi:E==="chat"?n.statusChat:"idle";return k[E]?.[q]||k[E]?.idle||""}function re(E){if(E.preventDefault(),E.stopPropagation(),!p.value){const q=E.currentTarget.getBoundingClientRect();W.value={position:"fixed",top:`${q.bottom+5}px`,right:`${window.innerWidth-q.right}px`,zIndex:"9999"}}p.value=!p.value}function z(E){p.value&&(p.value=!1)}function R(){const E=!n.isAiCommander;Gt(pe(ge,"system/aiCommander"),{enabled:E?n.myDeviceId:null}).then(()=>{n.isAiCommander=E,l(E?" AI Commander":" AI Commander")}).catch(k=>e.error("Error toggling AI:",k))}function v(E){if(!E)return"";const k=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=|live\/|shorts\/)([^#&?]*).*/,q=E.match(k);return q&&q[2].length===11?q[2]:E}async function T(){if(n.isConnected){o(),n.isConnected=!1,n.statusChat="idle",n.statusApi="idle",l("");return}const E=v(h.value);if(E!==h.value&&(h.value=E),!h.value.trim()){ve.fire({icon:"error",title:"Error",text:" Video ID ",timer:2e3});return}w.value=!0,n.isConnected=!0,n.currentVideoId=h.value,i.connectToStock(h.value),c(),fetch("https://peng24-manowzab-price-detector.hf.space/docs",{method:"GET"}).then(k=>{if(k.ok||k.status===404)console.log("%c Hugging Face Server is Awake and Ready!","color: #22c55e; font-size: 14px; font-weight: bold; text-shadow: 0 0 8px rgba(34,197,94,0.4);");else throw new Error(`Status: ${k.status}`)}).catch(k=>{console.log("%c Failed to wake up Hugging Face Server","color: #ef4444; font-size: 14px; font-weight: bold;",k.message)}),hn(pe(ge,"system/activeVideo"),h.value).catch(k=>console.error("Sync Error:",k));try{await r(h.value)?(n.statusChat="ok",l(" "),ve.fire({icon:"success",title:"",text:" YouTube Live",timer:2e3,showConfirmButton:!1})):(n.statusChat="warn",ve.fire({icon:"info",title:"",text:" ()",timer:3e3}))}catch(k){e.error("Connection error:",k),n.isConnected=!1,n.statusApi="err",n.statusChat="err",ve.fire({icon:"error",title:"",text:k.message,timer:3e3})}finally{w.value=!1}}function x(){if(s.fullChatLog.length===0){ve.fire({icon:"warning",title:"",text:"",timer:2e3}),p.value=!1;return}s.downloadChatCSV(n.currentVideoId),ve.fire({icon:"success",title:"",text:" CSV ",timer:1500,showConfirmButton:!1}),p.value=!1}function b(){c(),l("     "),p.value=!1}function F(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen().catch(E=>{e.error("Fullscreen error:",E),ve.fire({icon:"error",title:"",timer:2e3})}),p.value=!1}function D(){const E=n.isAway,k=pe(ge,"system/awayMode");E?hn(k,{isAway:!1,startTime:null,closedBy:n.myDeviceId}).then(()=>{}):hn(k,{isAway:!0,startTime:Date.now(),deviceId:n.myDeviceId}).then(()=>{ve.fire({icon:"info",title:"",text:"",timer:2e3,showConfirmButton:!1})}),p.value=!1}async function G(){if(m.value=!m.value,m.value){const{useChatProcessor:E}=await Cc(async()=>{const{useChatProcessor:q}=await import("./useChatProcessor-DXJ0_PqH.js");return{useChatProcessor:q}},[]),{processMessage:k}=E();ve.fire({icon:"info",title:"",text:"...",timer:1500,showConfirmButton:!1}),B=setInterval(()=>{const q=Math.floor(Math.random()*i.stockSize)+1,oe=[`F${q}`,`${q}`,` ${q}`,` ${q}`,`CF${q}`],ae=oe[Math.floor(Math.random()*oe.length)];k({id:"sim-"+Date.now(),snippet:{displayMessage:ae,publishedAt:new Date().toISOString()},authorDetails:{channelId:"sim-"+Math.random().toString(36).substr(2,9),displayName:"SimUser"+Math.floor(Math.random()*100),profileImageUrl:""}})},2e3)}else B&&(clearInterval(B),B=null),ve.fire({icon:"success",title:"",timer:1500,showConfirmButton:!1});p.value=!1}function O(){const E=localStorage.getItem("geminiApiKey")||"";ve.fire({title:" Gemini API Key",html:'<a href="https://aistudio.google.com/" target="_blank" style="color:#29b6f6"> Key </a>',input:"text",inputValue:E,inputPlaceholder:" API Key ",showCancelButton:!0,confirmButtonText:"",cancelButtonText:""}).then(k=>{k.isConfirmed&&k.value&&(a(k.value),ve.fire({icon:"success",title:"",text:"API Key ",timer:1500,showConfirmButton:!1}))}),p.value=!1}function U(){window.open(window.location.origin+window.location.pathname+"?mode=voice","_blank"),p.value=!1}function ce(){window.open(window.location.origin+window.location.pathname+"?mode=overlay","_blank"),p.value=!1}function te(){ve.fire({title:"?",text:"",icon:"question",showCancelButton:!0,confirmButtonText:", ",cancelButtonText:"",confirmButtonColor:"#00e676"}).then(E=>{E.isConfirmed&&(localStorage.removeItem("app_version"),window.location.reload(!0))}),p.value=!1}function S(){return`Manowzab Command Center ${n.version}`}function y(){n.useOnlineTts=!n.useOnlineTts;const E=n.useOnlineTts?"Google Cloud TTS":"Native TTS";l(` ${E}`)}function P(){ve.fire({title:` ${n.version} Patch Notes`,html:`<div style="text-align: left; font-size: 0.9em; line-height: 1.6;">
        <h4 style="color: #00e676; margin-bottom: 5px;">  (Voice Upgrade)</h4>
        <ul>
          <li> <b>Smart Hunter Logic</b> (+ 300%)</li>
          <li> <b>Advanced Cleaning</b> (/)</li>
          <li> <b>Implicit Numbering</b> (  680 -> #6  80)</li>
        </ul>
        </div>`,background:"#1e1e1e",color:"#fff",confirmButtonText:"!",confirmButtonColor:"#00e676",width:600})}return wn(()=>{pt(pe(ge,"shipping"),k=>{C.value=k.val()||{}}),document.addEventListener("click",z);const E=localStorage.getItem("lastVideoId");E&&(h.value=E)}),Pa(()=>{document.removeEventListener("click",z),B&&clearInterval(B),h.value&&localStorage.setItem("lastVideoId",h.value)}),(E,k)=>(J(),ee("div",XA,[f("div",JA,[f("div",ZA,[f("span",{class:_e(["status-item",ie(n).statusDb]),title:Z("db")},[...k[4]||(k[4]=[f("i",{class:"fa-solid fa-database"},null,-1)])],10,e2),f("span",{class:_e(["status-item",ie(n).statusApi]),title:Z("api")},[...k[5]||(k[5]=[f("i",{class:"fa-brands fa-youtube"},null,-1)])],10,t2),f("span",{class:_e(["status-item",ie(n).statusChat]),title:Z("chat")},[...k[6]||(k[6]=[f("i",{class:"fa-solid fa-comments"},null,-1)])],10,n2),f("span",{class:"key-indicator",title:` API Key #${ie(n).currentKeyIndex+1}`},[k[7]||(k[7]=f("i",{class:"fa-solid fa-key"},null,-1)),ke(" "+ne(ie(n).currentKeyIndex+1),1)],8,s2)]),f("button",{class:_e(["btn","btn-ai",ie(n).isAiCommander?"active":"inactive"]),onClick:R},"  AI: "+ne(ie(n).isAiCommander?"":""),3),f("button",{class:"btn btn-dark",onClick:k[0]||(k[0]=(...q)=>ie(d)&&ie(d)(...q))},""),f("button",{class:_e(["btn","btn-shipping",V.value>0?"":"empty"]),onClick:k[1]||(k[1]=(...q)=>ie(u)&&ie(u)(...q))},"  ("+ne(V.value)+") ",3),kn(f("input",{type:"text","onUpdate:modelValue":k[2]||(k[2]=q=>h.value=q),class:"input-id",placeholder:"Video ID",onKeyup:Iy(T,["enter"])},null,544),[[ss,h.value]]),f("button",{class:_e(["btn",ie(n).isConnected?"btn-dark":"btn-primary"]),onClick:T,disabled:w.value},ne(ie(n).isConnected?"DISCONNECT":w.value?"...":"CONNECT"),11,i2),f("button",{class:_e(["btn","relative","border-0","text-white"]),style:dn({background:ie(n).useOnlineTts?"linear-gradient(135deg, #00C6FF 0%, #0072FF 100%)":"linear-gradient(135deg, #4B5563 0%, #374151 100%)",boxShadow:ie(n).useOnlineTts?"0 4px 15px rgba(0, 114, 255, 0.4)":"none"}),onClick:y,title:ie(n).useOnlineTts?`Google Cloud TTS - Key #${ie(n).activeKeyIndex} Active`:"Native TTS (Offline)"},[f("i",{class:_e(["text-lg drop-shadow-sm",ie(n).useOnlineTts?"fa-solid fa-cloud":"fa-solid fa-robot"])},null,2),ie(n).useOnlineTts?(J(),ee("span",o2,ne(ie(n).activeKeyIndex),1)):Ae("",!0)],12,r2),f("div",{class:"dropdown",ref_key:"dropdownRef",ref:A},[f("button",{class:"btn btn-sim",onClick:hs(re,["stop"])},[...k[8]||(k[8]=[ke("  Tools ",-1),f("i",{class:"fa-solid fa-caret-down"},null,-1)])]),(J(),Qn(Fc,{to:"body"},[p.value?(J(),ee("div",{key:0,class:"dropdown-content",style:dn(W.value),onClick:k[3]||(k[3]=hs(()=>{},["stop"]))},[f("a",{onClick:x,class:"menu-csv"},[...k[9]||(k[9]=[f("i",{class:"fa-solid fa-file-csv"},null,-1),ke("  (CSV) ",-1)])]),f("a",{onClick:b,class:"menu-voice"},[...k[10]||(k[10]=[f("i",{class:"fa-solid fa-volume-high"},null,-1),ke("  ",-1)])]),f("a",{onClick:F,class:"menu-screen"},[...k[11]||(k[11]=[f("i",{class:"fa-solid fa-expand"},null,-1),ke("  (iPad) ",-1)])]),f("a",{onClick:D,class:"menu-away"},[...k[12]||(k[12]=[f("i",{class:"fa-solid fa-moon"},null,-1),ke("  ",-1)])]),f("a",{onClick:G,class:"menu-sim"},[f("i",{class:_e(m.value?"fa-solid fa-stop":"fa-solid fa-bolt")},null,2),ke(" "+ne(m.value?"":""),1)]),f("a",{onClick:O,class:"menu-key"},[...k[13]||(k[13]=[f("i",{class:"fa-solid fa-key"},null,-1),ke("  API Key ",-1)])]),f("a",{onClick:U,class:"menu-voice-page"},[...k[14]||(k[14]=[f("i",{class:"fa-solid fa-microphone"},null,-1),ke("  ",-1)])]),f("a",{onClick:ce,class:"menu-overlay"},[...k[15]||(k[15]=[f("i",{class:"fa-solid fa-layer-group"},null,-1),ke("  Overlay (OBS) ",-1)])]),f("a",{onClick:te,class:"menu-update"},[...k[16]||(k[16]=[f("i",{class:"fa-solid fa-rotate"},null,-1),ke("  ",-1)])])],4)):Ae("",!0)]))],512)]),f("div",a2,[f("div",{class:_e(["status-dot",ie(n).isConnected?"online":""])},null,2),f("div",l2,"  "+ne(ie(n).viewerCount.toLocaleString()),1),f("div",c2,ne(ie(n).liveTitle),1),f("div",{class:"version-badge",title:S(),onClick:P,style:{cursor:"pointer"}},ne(ie(n).version),9,u2)])]))}},Ki=(t,e)=>{const n=t.__vccOpts||t;for(const[s,i]of e)n[s]=i;return n},h2={class:"stock-panel"},f2={class:"stock-header"},p2={class:"stock-input-group"},m2={class:"header-center stock-stats"},g2={class:"stat-sold"},w2={style:{opacity:"0.5"}},v2={key:0},_2={key:1},y2=["onClick","id"],b2={class:"stock-num"},C2={key:0,class:"stock-price"},E2={key:1,class:"queue-badge"},S2={class:"queue-modal"},I2={class:"queue-header"},T2={class:"text-success"},k2={class:"queue-body"},A2={class:"flex-center gap-10 mb-10 p-10",style:{background:"#2a2a2a","border-radius":"8px"}},x2={class:"queue-list"},P2={key:0,class:"text-center p-10 text-secondary"},R2=["onDragstart","onDrop"],N2={class:"flex-center gap-10",style:{flex:"1"}},O2={class:"queue-rank"},D2=["onUpdate:modelValue"],M2={id:"buyer-options"},L2=["value"],$2={class:"queue-actions"},F2=["onClick"],B2=!1,vf=80,U2={__name:"StockGrid",setup(t){const e={log:(...P)=>B2},n=Hi(),{playSfx:s,queueSpeech:i}=Zs(),r=j(null),o=j(null),a=j(new Set),l=j(!1),c=j(!1),u=j(0);let d=0,h=!1;const p=j(n.stockSize||100);Ot(()=>n.stockSize,P=>{P&&P!==p.value&&(p.value=P)},{immediate:!0});const m=j(!1),w=j(null),C=j(0),A=j([]);let W=null;const B=Ge(()=>Object.values(n.stockData).filter(P=>P.owner).length),V=Ge(()=>n.stockSize===0?0:Math.round(B.value/n.stockSize*100));Ge(()=>{const P=V.value;return P===0||P<=20?" !":P<=50?" !":P<=80?" !":P<100?" !":"  !"}),Ge(()=>{const P=V.value;return P<=30?"linear-gradient(90deg, #ff6b35 0%, #ff4500 100%)":P<=60?"linear-gradient(90deg, #fbbf24 0%, #f59e0b 100%)":"linear-gradient(90deg, #10b981 0%, #059669 100%)"});const Z=Ge(()=>{const P=new Set;return Object.values(n.stockData).forEach(E=>{E.owner&&P.add(E.owner)}),Array.from(P).sort()});function re(P){return n.stockData[P]||{}}function z(P){const E=n.stockData[P];return E&&E.queue?E.queue.length:0}function R(P){return a.value.has(P)}function v(){const P=parseInt(p.value);if(!P||P<1){ve.fire({icon:"error",title:"",text:" 0",toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3});return}n.updateStockSize(P),ve.fire({icon:"success",title:"",text:`: ${P}`,toast:!0,position:"top-end",showConfirmButton:!1,timer:1500})}Ot(()=>n.stockData,(P,E)=>{Object.keys(P).forEach(k=>{const q=parseInt(k),oe=P[k],ae=E?.[k];oe.owner&&(!ae||!ae.owner)&&(a.value.add(q),setTimeout(()=>a.value.delete(q),15e3),T(q))})},{deep:!0});function T(P){ns(()=>{const E=document.getElementById(`stock-${P}`);E&&E.scrollIntoView({behavior:"smooth",block:"center"})})}function x(P){const E=re(P);w.value=P,C.value=E.price||0,A.value=[],E.owner&&A.value.push({owner:E.owner,uid:E.uid||"manual",time:E.time,source:E.source}),E.queue&&A.value.push(...JSON.parse(JSON.stringify(E.queue))),m.value=!0}function b(){m.value=!1}function F(P){W=P}function D(P){const E=A.value[W];A.value.splice(W,1),A.value.splice(P,0,E),W=null}function G(P){A.value.splice(P,1)}function O(){A.value.push({owner:"",uid:"manual-"+Date.now(),time:Date.now(),source:"manual"})}async function U(){const P=w.value,E=re(P),k=A.value.length>0?A.value[0].owner:null,q=E.owner;let oe=null;if(A.value.length>0){const ae=A.value[0],ye=A.value.slice(1);oe={owner:ae.owner,uid:ae.uid,time:ae.time||Date.now(),source:ae.source||"manual",price:C.value>0?C.value:null,queue:ye}}q&&!k?(s(),i(` ${P} `)):q&&k&&q!==k&&(s(),E.uid===oe.uid||i(`${q}  ${k}`)),oe?await n.updateItemData(P,oe):C.value>0?(await n.updateItemData(P,{price:C.value,owner:null,uid:null,queue:null,time:null,source:null}),s()):await n.processCancel(P),b(),ve.fire({icon:"success",title:"",toast:!0,position:"top-end",showConfirmButton:!1,timer:1500})}function ce(P){const E=r.value;E&&(h=E.scrollTop===0,h&&(d=P.touches[0].clientY))}function te(P){if(!h||c.value)return;const k=P.touches[0].clientY-d;k>0&&(l.value=!0,u.value=Math.min(k*.5,120),u.value>10&&P.preventDefault())}async function S(){!l.value||c.value||(l.value=!1,u.value>=vf?(c.value=!0,await y(),setTimeout(()=>{c.value=!1,u.value=0},500)):u.value=0,h=!1)}async function y(){try{s(),e.log(" Stock refreshed")}catch(P){console.error("Error refreshing stock:",P)}}return(P,E)=>(J(),ee("div",h2,[f("div",f2,[f("div",p2,[E[3]||(E[3]=ke(" : ",-1)),kn(f("input",{type:"number","onUpdate:modelValue":E[0]||(E[0]=k=>p.value=k),class:"edit-input",style:{width:"70px","text-align":"center","font-size":"1.1em","font-weight":"bold"},onChange:v},null,544),[[ss,p.value,void 0,{lazy:!0}]])]),f("div",m2,[E[4]||(E[4]=f("span",{class:"stats-label"},":",-1)),f("span",g2,ne(B.value),1),f("span",w2,"/"+ne(ie(n).stockSize),1)]),E[5]||(E[5]=f("div",null,null,-1))]),f("div",{class:_e(["pull-indicator",{pulling:l.value,refreshing:c.value}]),style:dn({height:u.value+"px"})},[f("i",{class:_e(["fa-solid fa-sync",{spinning:c.value}])},null,2),u.value>vf?(J(),ee("span",v2,"")):l.value?(J(),ee("span",_2,"")):Ae("",!0)],6),f("div",{class:"stock-grid",ref_key:"gridContainer",ref:r,onTouchstart:ce,onTouchmove:te,onTouchend:S},[et(Up,{name:"stock-list"},{default:Fr(()=>[(J(!0),ee(Le,null,Xt(ie(n).stockSize,k=>(J(),ee("div",{key:k,class:_e(["stock-item",re(k).owner?"sold":"",R(k)?"new-order":"",o.value===k?"highlight":""]),onClick:q=>x(k),id:`stock-${k}`},[f("div",b2,ne(k),1),f("div",{class:_e(["stock-status",{empty:!re(k).owner}])},ne(re(k).owner||""),3),re(k).price?(J(),ee("div",C2,ne(re(k).price)+"  ",1)):Ae("",!0),z(k)>0?(J(),ee("div",E2," +"+ne(z(k)),1)):Ae("",!0)],10,y2))),128))]),_:1})],544),(J(),Qn(Fc,{to:"body"},[m.value?(J(),ee("div",{key:0,class:"queue-modal-overlay",onClick:hs(b,["self"])},[f("div",S2,[f("div",I2,[f("h3",T2,[E[6]||(E[6]=f("i",{class:"fa-solid fa-list-ol"},null,-1)),ke("  "+ne(w.value),1)]),f("button",{class:"btn btn-dark",onClick:b},[...E[7]||(E[7]=[f("i",{class:"fa-solid fa-xmark"},null,-1)])])]),f("div",k2,[f("div",A2,[E[8]||(E[8]=f("span",null,":",-1)),kn(f("input",{type:"number","onUpdate:modelValue":E[1]||(E[1]=k=>C.value=k),class:"edit-input",style:{width:"100px"}},null,512),[[ss,C.value]]),E[9]||(E[9]=f("span",null,"",-1))]),f("div",x2,[A.value.length===0?(J(),ee("div",P2,"  ")):Ae("",!0),(J(!0),ee(Le,null,Xt(A.value,(k,q)=>(J(),ee("div",{key:q,class:_e(["queue-item",{active:q===0}]),draggable:"true",onDragstart:oe=>F(q),onDragover:E[2]||(E[2]=hs(()=>{},["prevent"])),onDrop:oe=>D(q)},[f("div",N2,[E[10]||(E[10]=f("div",{class:"drag-handle"},[f("i",{class:"fa-solid fa-grip-vertical"})],-1)),f("span",O2,"#"+ne(q+1),1),kn(f("input",{type:"text","onUpdate:modelValue":oe=>k.owner=oe,class:"queue-input",list:"buyer-options"},null,8,D2),[[ss,k.owner]]),f("datalist",M2,[(J(!0),ee(Le,null,Xt(Z.value,oe=>(J(),ee("option",{key:oe,value:oe},null,8,L2))),128))])]),f("div",$2,[f("button",{class:"btn btn-dark btn-sm",onClick:oe=>G(q),title:""},[...E[11]||(E[11]=[f("i",{class:"fa-solid fa-trash text-error"},null,-1)])],8,F2)])],42,R2))),128))])]),f("div",{class:"queue-header",style:{"justify-content":"flex-end",gap:"10px"}},[f("button",{class:"btn btn-dark",onClick:O},[...E[12]||(E[12]=[f("i",{class:"fa-solid fa-plus"},null,-1),ke("  ",-1)])]),f("button",{class:"btn btn-success",onClick:U},[...E[13]||(E[13]=[f("i",{class:"fa-solid fa-save"},null,-1),ke("  ",-1)])])])])])):Ae("",!0)]))]))}},V2=Ki(U2,[["__scopeId","data-v-d73cc824"]]),H2={class:"chat-panel"},W2={class:"tools-bar"},j2={class:"chat-controls"},z2={key:0},q2={key:1},K2={class:"avatar-container"},G2=["src"],Y2={class:"chat-bubble-container"},Q2={class:"chat-meta"},X2={class:"chat-time"},J2=["onClick"],Z2={key:1,class:"status-emoji-only"},ex={key:2,class:"real-name"},tx={class:"chat-bubble"},nx={class:"chat-text"},sx={key:0},ix=["src","alt"],rx={key:0,class:"force-process-btn"},ox=["onClick"],_f=80,ax={__name:"ChatPanel",setup(t){const e=Jr(),n=Hi(),s=Et(),{resetVoice:i}=Zs(),r=j(null),o=j(!1),a=j(200);let l=!1;const c=j(!1),u=j(!1),d=j(0);let h=0,p=!1;const m=Ge(()=>{const D=e.messages.length,G=Math.max(0,D-a.value);return e.messages.slice(G)}),w=Ge(()=>e.messages.length>a.value);function C(D){switch(D){case"buy":return{icon:"",label:"",class:"badge-buy"};case"cancel":return{icon:"",label:"",class:"badge-cancel"};case"shipping":return{icon:"",label:"",class:"badge-shipping"};case"question":return{icon:"",label:"",class:"badge-question"};default:return null}}function A(D){return D?new Date(D).toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"}):""}async function W(D){const{value:G}=await ve.fire({title:"",input:"text",inputLabel:`: ${D.realName}`,inputValue:D.displayName,showCancelButton:!0,confirmButtonText:"",cancelButtonText:""});if(G&&G.trim()!==""){const O={};O[`nicknames/${D.uid}`]={nick:G.trim(),realName:D.realName,updatedAt:Date.now()},Gt(pe(ge),O).then(()=>{ve.fire({icon:"success",title:"",toast:!0,position:"top-end",showConfirmButton:!1,timer:1500})}).catch(U=>{console.error(U),ve.fire("Error","","error")})}}function B(){const D=r.value;if(!D)return;l=D.scrollHeight-D.scrollTop-D.clientHeight>100,o.value=l}function V(){const D=r.value;D&&(setTimeout(()=>{D.scrollTo({top:D.scrollHeight+1e3,behavior:"smooth"})},100),o.value=!1,l=!1)}function Z(){const D=r.value;if(!D)return;const G=D.scrollHeight;a.value+=200,ns(()=>{const U=D.scrollHeight-G;D.scrollTop+=U})}Ot(()=>e.messages.length,async()=>{await ns(),l?o.value=!0:V()}),wn(()=>{V(),s.currentVideoId&&(e.syncFromFirebase(s.currentVideoId),console.log(" Chat sync initialized for:",s.currentVideoId))}),Ot(()=>s.currentVideoId,(D,G)=>{D&&D!==G&&(console.log(` Video ID changed from ${G} to ${D}, re-syncing chat...`),e.syncFromFirebase(D))});async function re(D){const{value:G}=await ve.fire({title:"",html:'<input id="swal-input1" class="swal2-input" placeholder=" ( 1)" value=""><input id="swal-input2" class="swal2-input" placeholder=" ()" value="">',focusConfirm:!1,showCancelButton:!0,preConfirm:()=>[document.getElementById("swal-input1").value,document.getElementById("swal-input2").value]});if(G){const[O,U]=G;if(!O)return;await n.processOrder(parseInt(O),D.displayName,D.uid,"manual-force",U?parseInt(U):null,"manual"),ve.fire("",` ${O}  ${D.displayName} `,"success")}}function z(){s.isSoundOn=!s.isSoundOn}function R(){i(),ve.fire({icon:"success",title:"",toast:!0,position:"top-end",showConfirmButton:!1,timer:1e3})}function v(){if(e.fullChatLog.length===0){ve.fire({icon:"warning",title:"",text:"",timer:1500});return}e.downloadChatCSV(s.currentVideoId||"chat-log"),ve.fire({icon:"success",title:" CSV ",timer:1500,showConfirmButton:!1})}function T(D){const G=r.value;G&&(p=G.scrollTop===0,p&&(h=D.touches[0].clientY))}function x(D){if(!p||u.value)return;const O=D.touches[0].clientY-h;O>0&&(c.value=!0,d.value=Math.min(O*.5,120),d.value>10&&D.preventDefault())}async function b(){!c.value||u.value||(c.value=!1,d.value>=_f?(u.value=!0,await F(),setTimeout(()=>{u.value=!1,d.value=0},500)):d.value=0,p=!1)}async function F(){try{s.currentVideoId&&await e.syncFromFirebase(s.currentVideoId),await ns(),V(),playSfx()}catch(D){console.error("Error refreshing chat:",D)}}return(D,G)=>(J(),ee("div",H2,[f("div",W2,[G[3]||(G[3]=f("h3",{style:{color:"#fff",margin:"0","font-size":"1.1em"}},[f("i",{class:"fa-solid fa-comments"}),ke(" Live Chat ")],-1)),f("div",j2,[f("button",{class:_e(["btn-tool",{muted:!ie(s).isSoundOn}]),onClick:z},[f("i",{class:_e(ie(s).isSoundOn?"fa-solid fa-volume-high":"fa-solid fa-volume-xmark")},null,2),ke(" "+ne(ie(s).isSoundOn?": ":": "),1)],2),f("button",{class:"btn-tool",onClick:R},[...G[1]||(G[1]=[f("i",{class:"fa-solid fa-stop"},null,-1),ke("  ",-1)])]),f("button",{class:"btn-tool btn-csv",onClick:v},[...G[2]||(G[2]=[f("i",{class:"fa-solid fa-file-csv"},null,-1),ke(" CSV ",-1)])])])]),f("div",{class:_e(["pull-indicator",{pulling:c.value,refreshing:u.value}]),style:dn({height:d.value+"px"})},[f("i",{class:_e(["fa-solid fa-sync",{spinning:u.value}])},null,2),d.value>_f?(J(),ee("span",z2,"")):c.value?(J(),ee("span",q2,"")):Ae("",!0)],6),f("div",{id:"chat-viewport",ref_key:"chatViewport",ref:r,onScroll:B,onTouchstart:T,onTouchmove:x,onTouchend:b},[w.value?(J(),ee("button",{key:0,class:"load-more-btn",onClick:Z},"   ("+ne(ie(e).messages.length-a.value)+" ) ",1)):Ae("",!0),et(Up,{name:"chat-list",tag:"div",id:"chat-list"},{default:Fr(()=>[(J(!0),ee(Le,null,Xt(m.value,O=>(J(),ee("div",{key:O.id,class:_e(["chat-row",O.isAdmin?"admin":"",O.type])},[f("div",K2,[f("img",{src:O.avatar,class:"avatar",loading:"lazy",onError:G[0]||(G[0]=U=>U.target.style.display="none")},null,40,G2),f("div",{class:"avatar-fallback",style:dn({backgroundColor:O.color})},ne(O.displayName?.[0]||"?"),5)]),f("div",Y2,[f("div",Q2,[f("span",X2,ne(A(O.timestamp)),1),f("span",{class:"chat-name",style:dn({backgroundColor:O.color}),onClick:U=>W(O),title:""},ne(O.displayName),13,J2),C(O.type)?(J(),ee("span",{key:0,class:_e(["status-badge",C(O.type).class])},ne(C(O.type).icon)+" "+ne(C(O.type).label),3)):O.type==="spam"?(J(),ee("span",Z2,"")):Ae("",!0),O.realName!==O.displayName?(J(),ee("span",ex," ("+ne(O.realName)+") ",1)):Ae("",!0)]),f("div",tx,[f("div",nx,[O.messageRuns&&O.messageRuns.length>0?(J(!0),ee(Le,{key:0},Xt(O.messageRuns,(U,ce)=>(J(),ee(Le,{key:ce},[U.text?(J(),ee("span",sx,ne(U.text),1)):U.emoji&&U.emoji.image?(J(),ee("img",{key:1,src:U.emoji.image.thumbnails?.[0]?.url||U.emoji.image.url,alt:U.emoji.emojiId||"emoji",class:"emoji-image",loading:"lazy"},null,8,ix)):Ae("",!0)],64))),128)):(J(),ee(Le,{key:1},[ke(ne(O.text),1)],64))]),O.isAdmin||ie(s).isAiCommander?(J(),ee("div",rx,[f("button",{onClick:U=>re(O),class:"btn-mini"},[...G[4]||(G[4]=[f("i",{class:"fa-solid fa-bolt"},null,-1)])],8,ox)])):Ae("",!0)])])],2))),128))]),_:1})],544),o.value?(J(),ee("button",{key:0,class:"new-msg-btn",onClick:V},"   ")):Ae("",!0)]))}},lx=Ki(ax,[["__scopeId","data-v-efa21e99"]]),cx={class:"dashboard-content"},ux={class:"dashboard-header"},dx={class:"stats-section"},hx={class:"stat-card"},fx={class:"stat-value-row"},px={class:"main-number"},mx={class:"progress-track"},gx={style:{"overflow-x":"auto",flex:"1"}},wx={class:"shipping-table"},vx={key:0},_x={colspan:"6",style:{"text-align":"center",padding:"10px",background:"#2a2a2a"}},yx={style:{display:"flex",gap:"10px","justify-content":"center","align-items":"center"}},bx=["value"],Cx=["disabled"],Ex={key:1},Sx=["onUpdate:modelValue","onChange"],Ix={style:{"font-size":"0.9em"}},Tx={style:{"text-align":"center"}},kx=["onClick"],Ax={style:{color:"#ffd700","font-weight":"bold"}},xx={style:{"text-align":"center"}},Px=["onClick"],Rx={key:2},Nx={class:"chat-history-content"},Ox={class:"chat-history-header"},Dx={class:"user-info"},Mx=["src"],Lx={class:"chat-history-body",id:"history-body"},$x={key:0,style:{"text-align":"center",color:"#555","margin-top":"50px"}},Fx={class:"chat-bubble-time"},Bx={class:"chat-bubble-text"},Ux={__name:"Dashboard",emits:["close"],setup(t,{emit:e}){const n=Hi(),s=Et(),i=Jr(),r=j(""),o=j({}),a=j({}),l=j(null),c=j({}),u=j([]),d=Ge(()=>{const R={};return Object.keys(n.stockData).forEach(v=>{const T=n.stockData[v];if(T?.uid){R[T.uid]||(R[T.uid]={name:T.owner,uid:T.uid,items:[],totalPrice:0});const x=T.price?parseInt(T.price):0;R[T.uid].items.push({num:v,price:x}),R[T.uid].totalPrice+=x}}),R}),h=Ge(()=>{const R=o.value[s.currentVideoId]||{};return Object.keys(d.value).filter(v=>R[v]?.ready).map(v=>{const T=d.value[v],x=T.items.map(b=>`#${b.num}${b.price>0?`(${b.price})`:""}`).join(", ");return{uid:v,name:a.value[v]?.nick||T.name,editableName:a.value[v]?.nick||T.name,itemsText:x,totalPrice:T.totalPrice}})}),p=Ge(()=>{const R=o.value[s.currentVideoId]||{};return Object.keys(d.value).filter(v=>!R[v]?.ready).map(v=>({uid:v,name:a.value[v]?.nick||d.value[v].name,itemCount:d.value[v].items.length}))}),m=Ge(()=>Object.values(n.stockData).filter(R=>R?.owner).length),w=Ge(()=>n.stockSize||0),C=Ge(()=>w.value===0?0:m.value/w.value*100),A=Ge(()=>{const R=C.value;return R===0||R<=20?"":R<=50?"":R<=80?"":""}),W=Ge(()=>{const R=C.value;return R<=20?"color-low":R<=50?"color-medium":R<=80?"color-high":"color-complete"});function B(){if(!r.value)return;const R=`shipping/${s.currentVideoId}/${r.value}`;Gt(pe(ge,R),{ready:!0,timestamp:Date.now()}).then(()=>{ve.fire({icon:"success",title:"",timer:1500,showConfirmButton:!1}),r.value=""}).catch(v=>{console.error("Error adding to shipping:",v),ve.fire("Error","","error")})}function V(R){ve.fire({title:"?",text:"?",icon:"warning",showCancelButton:!0,confirmButtonText:"",cancelButtonText:"",confirmButtonColor:"#d32f2f"}).then(v=>{if(v.isConfirmed){const T=`shipping/${s.currentVideoId}/${R}`;Gt(pe(ge,T),{ready:null}).then(()=>{ve.fire({icon:"success",title:"",timer:1500,showConfirmButton:!1})}).catch(x=>{console.error("Error removing from shipping:",x),ve.fire("Error","","error")})}})}function Z(R,v){!v||!v.trim()||Gt(pe(ge,`nicknames/${R}`),{nick:v.trim()}).then(()=>{console.log(" Updated nickname:",v)}).catch(T=>{console.error("Error updating nickname:",T)})}async function re(R,v){l.value=R,c.value={name:v.name,avatar:null};const T=i.messages.find(b=>b.uid===R);T&&(c.value.avatar=T.avatar);const x=pe(ge,`shipping/${s.currentVideoId}/${R}/history`);try{const b=await li(x);if(b.exists()){const F=b.val();u.value=Object.values(F).sort((D,G)=>D.timestamp-G.timestamp)}else u.value=[];setTimeout(()=>{const F=document.getElementById("history-body");F&&(F.scrollTop=F.scrollHeight)},100)}catch(b){console.error("Error loading chat history:",b)}}function z(){if(!l.value)return;const R=i.messages.filter(x=>x.uid===l.value);if(R.length===0){ve.fire("","","info");return}let v=0;const T=pe(ge,`shipping/${s.currentVideoId}/${l.value}/history`);R.forEach(x=>{u.value.some(F=>F.text===x.text&&Math.abs(F.timestamp-x.timestamp)<5e3)||(yg(T,{text:x.text,timestamp:x.timestamp,type:"user"}),v++)}),v>0?(re(l.value,c.value),ve.fire("Success",`Sync  ${v} `,"success")):ve.fire("Up to date"," Sync","info")}return wn(()=>{pt(pe(ge,"shipping"),R=>{o.value=R.val()||{}}),pt(pe(ge,"nicknames"),R=>{a.value=R.val()||{}})}),(R,v)=>(J(),ee(Le,null,[f("div",{class:"dashboard-overlay",onClick:v[2]||(v[2]=hs(T=>R.$emit("close"),["self"]))},[f("div",cx,[f("div",ux,[v[5]||(v[5]=f("div",{class:"dash-title"},"  ()",-1)),f("button",{class:"btn btn-dark",onClick:v[0]||(v[0]=T=>R.$emit("close"))},"")]),f("div",dx,[f("div",hx,[f("div",fx,[v[7]||(v[7]=f("span",{class:"stat-label-inline"},":",-1)),f("span",px,ne(m.value)+"/"+ne(w.value),1),f("div",mx,[f("div",{class:"progress-fill",style:dn({width:C.value+"%"})},[...v[6]||(v[6]=[f("div",{class:"shimmer"},null,-1)])],4)]),f("div",{class:_e(["percent-text",W.value])},ne(Math.round(C.value))+"% "+ne(A.value),3)])])]),f("div",gx,[f("table",wx,[v[14]||(v[14]=f("thead",null,[f("tr",null,[f("th",null,""),f("th",null," ()"),f("th",null,""),f("th",null,""),f("th",null,""),f("th",null,"")])],-1)),f("tbody",null,[p.value.length>0?(J(),ee("tr",vx,[f("td",_x,[f("div",yx,[v[9]||(v[9]=f("i",{class:"fa-solid fa-user-plus"},null,-1)),kn(f("select",{"onUpdate:modelValue":v[1]||(v[1]=T=>r.value=T),style:{padding:"5px","border-radius":"4px",background:"#444",color:"#fff",border:"1px solid #555","max-width":"200px"}},[v[8]||(v[8]=f("option",{value:""},"--  --",-1)),(J(!0),ee(Le,null,Xt(p.value,T=>(J(),ee("option",{key:T.uid,value:T.uid},ne(T.name)+" ("+ne(T.itemCount)+" ) ",9,bx))),128))],512),[[by,r.value]]),f("button",{class:"btn btn-success",onClick:B,style:{padding:"4px 10px","font-size":"0.9em"},disabled:!r.value},"  ",8,Cx)])])])):Ae("",!0),h.value.length===0&&p.value.length===0?(J(),ee("tr",Ex,[...v[10]||(v[10]=[f("td",{colspan:"6",style:{"text-align":"center",color:"#888",padding:"20px"}},"  ",-1)])])):Ae("",!0),(J(!0),ee(Le,null,Xt(h.value,(T,x)=>(J(),ee("tr",{key:T.uid},[f("td",null,ne(x+1),1),f("td",null,[kn(f("input",{class:"edit-input","onUpdate:modelValue":b=>T.editableName=b,onChange:b=>Z(T.uid,T.editableName),placeholder:" Enter"},null,40,Sx),[[ss,T.editableName]])]),f("td",Ix,ne(T.itemsText),1),f("td",Tx,[f("button",{class:"btn-icon-chat",onClick:b=>re(T.uid,T),title:""},[...v[11]||(v[11]=[f("i",{class:"fa-solid fa-comments"},null,-1)])],8,kx)]),f("td",Ax," "+ne(T.totalPrice.toLocaleString()),1),f("td",xx,[f("button",{class:"btn btn-dark",style:{background:"#d32f2f",color:"white",padding:"4px 8px","font-size":"0.8em"},onClick:b=>V(T.uid)},[...v[12]||(v[12]=[f("i",{class:"fa-solid fa-trash"},null,-1)])],8,Px)])]))),128)),h.value.length>0&&p.value.length===0?(J(),ee("tr",Rx,[...v[13]||(v[13]=[f("td",{colspan:"6",style:{"text-align":"center",color:"#00e676",padding:"10px"}},"   ",-1)])])):Ae("",!0)])])])])]),l.value?(J(),ee("div",{key:0,class:"chat-history-modal",onClick:v[4]||(v[4]=hs(T=>l.value=null,["self"]))},[f("div",Nx,[f("div",Ox,[f("div",Dx,[f("img",{src:c.value.avatar||"https://www.gstatic.com/youtube/img/creator/avatars/sample_avatar.png",class:"avatar-small"},null,8,Mx),f("div",null,[f("h3",null,ne(c.value.name),1),v[15]||(v[15]=f("div",{class:"sub-text"},"/",-1))])]),f("button",{class:"btn-close",onClick:v[3]||(v[3]=T=>l.value=null)},[...v[16]||(v[16]=[f("i",{class:"fa-solid fa-times"},null,-1)])])]),f("div",Lx,[u.value.length===0?(J(),ee("div",$x," -  - ")):Ae("",!0),(J(!0),ee(Le,null,Xt(u.value,(T,x)=>(J(),ee("div",{key:x,class:"chat-bubble-row"},[f("div",Fx,ne(new Date(T.timestamp).toLocaleTimeString("th-TH")),1),f("div",Bx,ne(T.text),1)]))),128))]),f("div",{class:"chat-history-footer"},[f("button",{class:"btn-sync-chat",onClick:z},[...v[17]||(v[17]=[f("i",{class:"fa-solid fa-rotate"},null,-1),ke("  (Sync) ",-1)])])])])])):Ae("",!0)],64))}},Vx=Ki(Ux,[["__scopeId","data-v-17de2b81"]]);function Hx(){const t=j([]),e=j(!1);async function n(){e.value=!0,t.value=[];try{const a=pe(ge,"history"),l=await li(a);if(l.exists()){const c=l.val(),u=Object.keys(c).map(d=>({videoId:d,...c[d]}));u.sort((d,h)=>(h.timestamp||0)-(d.timestamp||0)),t.value=u}}catch(a){console.error(" Fetch History Error:",a)}finally{e.value=!1}}async function s(a){if(!a)return{orders:{},stockSize:70};try{const l=pe(ge,`stock/${a}`),c=pe(ge,`settings/${a}/stockSize`),[u,d]=await Promise.all([li(l),li(c)]);return{orders:u.exists()?u.val():{},stockSize:d.exists()?d.val():70}}catch(l){return console.error(" Fetch History Details Error:",l),{orders:{},stockSize:70}}}async function i(a,l,c){if(!(!a||!l))try{const u=pe(ge,`stock/${a}/${l}`);if(c){const d={...c,updatedAt:Date.now()};!d.time&&!d.updatedAt&&(d.time=Date.now()),await Gt(u,d)}else await mi(u)}catch(u){throw console.error(" Update Item Error:",u),u}}async function r(a){if(a)try{await mi(vs(pe(ge,"history"),a)),await mi(vs(pe(ge,"chats"),a)),await n()}catch(l){throw console.error(" Delete History Error:",l),l}}async function o(){if(t.value.length){e.value=!0;try{for(const a of t.value){const l=pe(ge,`stock/${a.videoId}`),c=await li(l);if(c.exists()){const u=c.val();let d=0,h=0;Object.values(u).forEach(p=>{p.owner&&p.price&&(d+=parseInt(p.price),h++)}),await Gt(pe(ge,`history/${a.videoId}`),{totalSales:d,totalItems:h})}}return await n(),!0}catch(a){throw console.error(" Recalculate Error:",a),a}finally{e.value=!1}}}return{historyList:t,isLoading:e,fetchHistoryList:n,fetchHistoryDetails:s,updateHistoryItem:i,deleteHistory:r,recalculateAllHistory:o}}const Wx={class:"history-modal-container"},jx={class:"modal-header"},zx={class:"modal-body"},qx={class:"sidebar"},Kx={class:"sidebar-header"},Gx={class:"flex gap-1"},Yx={key:0,class:"text-center p-10 text-muted"},Qx={key:1,class:"sidebar-list"},Xx=["onClick"],Jx={class:"item-title"},Zx={class:"item-date"},eP={class:"item-meta"},tP={key:0,class:"text-center p-10 text-muted"},nP={class:"main-content"},sP={key:0,class:"empty-state"},iP={key:1,class:"content-wrapper"},rP={class:"stats-bar"},oP={key:0,class:"flex items-center justify-center p-4 w-full text-muted"},aP={class:"stat-box"},lP={class:"stat-value text-success"},cP={class:"stat-box"},uP={class:"stat-value"},dP={class:"controls-bar"},hP={class:"search-wrapper"},fP={class:"view-toggles flex gap-2 ml-4"},pP={key:0,class:"table-container"},mP={class:"data-table"},gP={key:0},wP=["onClick"],vP={class:"text-muted"},_P={class:"font-bold"},yP={class:"customer-name"},bP={class:"customer-uid text-sm text-muted"},CP={class:"text-right font-mono"},EP={class:"text-center"},SP={class:"text-sm text-muted"},IP={key:0,class:"fullscreen-header"},TP={class:"grid-content"},kP=["onClick"],AP={class:"item-num"},xP={class:"item-status"},PP={key:0,class:"item-price"},RP={class:"bg-[#1e293b] p-6 rounded-lg w-[90%] max-w-sm shadow-2xl border border-slate-600"},NP={class:"text-xl text-white mb-4 flex items-center gap-2"},OP={class:"space-y-4"},DP={__name:"HistoryModal",emits:["close"],setup(t,{emit:e}){const n=Hx(),s=j(null),i=j(null),r=j(""),o=j("list"),a=j(!1),l=j(!1),c=j(!1),u=j(null),d=j({owner:"",price:0});wn(()=>{n.fetchHistoryList()});async function h(x){s.value=x.videoId,i.value={...x},r.value="",l.value=!0;const{orders:b,stockSize:F}=await n.fetchHistoryDetails(x.videoId);i.value.orders=b,i.value.stockSize=F,l.value=!1}const p=Ge(()=>!i.value||!i.value.orders?[]:Object.keys(i.value.orders).map(x=>({stockId:x,...i.value.orders[x]})).sort((x,b)=>(x.timestamp||0)-(b.timestamp||0))),m=Ge(()=>{if(!r.value)return p.value;const x=r.value.toLowerCase();return p.value.filter(b=>b.stockId.toString().includes(x)||b.owner&&b.owner.toLowerCase().includes(x))}),w=Ge(()=>{if(!i.value)return[];const x=i.value.stockSize||70,b=i.value.orders||{},F=[];for(let D=1;D<=x;D++){const G=b[D];F.push({id:D,...G,isEmpty:!G||!G.owner})}if(r.value){const D=r.value.toLowerCase();return F.filter(G=>G.id.toString().includes(D)||G.owner&&G.owner.toLowerCase().includes(D))}return F}),C=Ge(()=>m.value.reduce((x,b)=>x+(b.price||0),0));function A(x){return x?new Date(x).toLocaleDateString("th-TH",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}function W(x){return x?new Date(x).toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"}):"-"}function B(x){return new Intl.NumberFormat("th-TH").format(x)}async function V(){(await ve.fire({title:"?",text:` "${i.value.title}" ?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"",cancelButtonText:""})).isConfirmed&&(await n.deleteHistory(s.value),s.value=null,i.value=null,ve.fire("","","success"))}function Z(){if(m.value.length===0){ve.fire("","","warning");return}let x=`\uFEFFDate,Time,Stock ID,Customer Name,Price,Source
`;const b=A(i.value.timestamp).split(" ")[0];m.value.forEach(O=>{const U=W(O.timestamp),ce=O.owner?O.owner.replace(/"/g,'""'):"";x+=`"${b}","${U}",${O.stockId},"${ce}",${O.price||0},"${O.method||"unknown"}"
`});const F=new Blob([x],{type:"text/csv;charset=utf-8;"}),D=URL.createObjectURL(F),G=document.createElement("a");G.setAttribute("href",D),G.setAttribute("download",`sales_history_${s.value}.csv`),document.body.appendChild(G),G.click(),document.body.removeChild(G)}function re(x){u.value={...x},d.value={owner:x.owner||"",price:x.price||0},c.value=!0}function z(){c.value=!1,u.value=null}async function R(){if(!u.value)return;const x={owner:d.value.owner,price:d.value.price,uid:u.value.uid||"manual-"+Date.now(),method:u.value.method||"manual-edit"};i.value.orders||(i.value.orders={}),i.value.orders[u.value.id]={...x,timestamp:u.value.timestamp||Date.now()},await n.updateHistoryItem(s.value,u.value.id,x),z()}async function v(){if(!u.value)return;(await ve.fire({title:"?",text:` ${u.value.id} ?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"",cancelButtonText:""})).isConfirmed&&(i.value.orders&&delete i.value.orders[u.value.id],await n.updateHistoryItem(s.value,u.value.id,null),z())}async function T(){(await ve.fire({title:"?",text:" ()",icon:"info",showCancelButton:!0,confirmButtonText:"",cancelButtonText:""})).isConfirmed&&(await n.recalculateAllHistory(),ve.fire("","","success"))}return(x,b)=>(J(),ee(Le,null,[f("div",{class:"dashboard-overlay",onClick:b[7]||(b[7]=hs(F=>x.$emit("close"),["self"]))},[f("div",Wx,[f("div",jx,[b[11]||(b[11]=f("h2",null,[f("i",{class:"fa-solid fa-clock-rotate-left"}),ke("  (History)")],-1)),f("button",{class:"btn-close",onClick:b[0]||(b[0]=F=>x.$emit("close"))},[...b[10]||(b[10]=[f("i",{class:"fa-solid fa-xmark"},null,-1)])])]),f("div",zx,[f("div",qx,[f("div",Kx,[b[14]||(b[14]=f("span",null,"",-1)),f("div",Gx,[f("button",{class:"btn-icon-sm",onClick:T,title:" (Fix Data)"},[...b[12]||(b[12]=[f("i",{class:"fa-solid fa-wrench"},null,-1)])]),f("button",{class:"btn-icon-sm",onClick:b[1]||(b[1]=(...F)=>ie(n).fetchHistoryList&&ie(n).fetchHistoryList(...F)),title:""},[...b[13]||(b[13]=[f("i",{class:"fa-solid fa-rotate-right"},null,-1)])])])]),ie(n).isLoading.value?(J(),ee("div",Yx,[...b[15]||(b[15]=[f("i",{class:"fa-solid fa-spinner fa-spin"},null,-1),ke(" ... ",-1)])])):(J(),ee("div",Qx,[(J(!0),ee(Le,null,Xt(ie(n).historyList.value,F=>(J(),ee("div",{key:F.videoId,class:_e(["sidebar-item",{active:s.value===F.videoId}]),onClick:D=>h(F)},[f("div",Jx,ne(F.title||""),1),f("div",Zx,[b[16]||(b[16]=f("i",{class:"fa-regular fa-calendar"},null,-1)),ke(" "+ne(A(F.timestamp)),1)]),f("div",eP," : "+ne(B(F.totalSales||0)),1)],10,Xx))),128)),ie(n).historyList.value.length===0?(J(),ee("div",tP,"  ")):Ae("",!0)]))]),f("div",nP,[i.value?(J(),ee("div",iP,[f("div",rP,[l.value?(J(),ee("div",oP,[...b[18]||(b[18]=[f("i",{class:"fa-solid fa-spinner fa-spin mr-2"},null,-1),ke(" ... ",-1)])])):(J(),ee(Le,{key:1},[f("div",aP,[b[19]||(b[19]=f("div",{class:"stat-label"},"",-1)),f("div",lP,ne(B(C.value)),1)]),f("div",cP,[b[20]||(b[20]=f("div",{class:"stat-label"},"",-1)),f("div",uP,ne(m.value.length)+" ",1)]),f("div",{class:"stat-actions"},[f("button",{class:"btn btn-danger",onClick:V},[...b[21]||(b[21]=[f("i",{class:"fa-solid fa-trash"},null,-1),ke("  ",-1)])]),f("button",{class:"btn btn-success",onClick:Z},[...b[22]||(b[22]=[f("i",{class:"fa-solid fa-file-csv"},null,-1),ke(" Export CSV ",-1)])])])],64))]),f("div",dP,[f("div",hP,[b[23]||(b[23]=f("i",{class:"fa-solid fa-magnifying-glass search-icon"},null,-1)),kn(f("input",{"onUpdate:modelValue":b[2]||(b[2]=F=>r.value=F),type:"text",class:"search-input",placeholder:", ..."},null,512),[[ss,r.value]])]),f("div",fP,[f("button",{class:_e(["btn btn-sm",o.value==="list"?"btn-primary":"btn-outline"]),onClick:b[3]||(b[3]=F=>o.value="list"),title:"List View"},[...b[24]||(b[24]=[f("i",{class:"fa-solid fa-list"},null,-1)])],2),f("button",{class:_e(["btn btn-sm",o.value==="grid"?"btn-primary":"btn-outline"]),onClick:b[4]||(b[4]=F=>o.value="grid"),title:"Grid View"},[...b[25]||(b[25]=[f("i",{class:"fa-solid fa-th"},null,-1)])],2),o.value==="grid"?(J(),ee("button",{key:0,class:"btn btn-sm btn-outline",onClick:b[5]||(b[5]=F=>a.value=!a.value),title:"Full Screen"},[...b[26]||(b[26]=[f("i",{class:"fa-solid fa-expand"},null,-1)])])):Ae("",!0)])]),o.value==="list"?(J(),ee("div",pP,[f("table",mP,[b[28]||(b[28]=f("thead",null,[f("tr",null,[f("th",{width:"80"},""),f("th",{width:"100"},""),f("th",null,""),f("th",{width:"120",class:"text-right"},""),f("th",{width:"100",class:"text-center"},""),f("th",{width:"120"},"")])],-1)),f("tbody",null,[m.value.length===0?(J(),ee("tr",gP,[...b[27]||(b[27]=[f("td",{colspan:"6",class:"text-center py-20 text-muted"},"",-1)])])):Ae("",!0),(J(!0),ee(Le,null,Xt(m.value,(F,D)=>(J(),ee("tr",{key:F.stockId,onClick:G=>re({id:F.stockId,...F}),class:"cursor-pointer hover:bg-slate-700"},[f("td",vP,"#"+ne(D+1),1),f("td",_P,ne(F.stockId),1),f("td",null,[f("div",yP,ne(F.owner),1),f("div",bP,ne(F.uid),1)]),f("td",CP,ne(B(F.price||0)),1),f("td",EP,[f("span",{class:_e(["badge",F.method==="manual-force"?"badge-warn":"badge-info"])},ne(F.method||"System"),3)]),f("td",SP,ne(W(F.timestamp)),1)],8,wP))),128))])])])):(J(),ee("div",{key:1,class:_e(["grid-container",{"fullscreen-grid":a.value}])},[a.value?(J(),ee("div",IP,[f("h2",null," "+ne(i.value.title),1),f("button",{class:"btn btn-danger",onClick:b[6]||(b[6]=F=>a.value=!1)},[...b[29]||(b[29]=[f("i",{class:"fa-solid fa-compress"},null,-1),ke("  ",-1)])])])):Ae("",!0),f("div",TP,[(J(!0),ee(Le,null,Xt(w.value,F=>(J(),ee("div",{key:F.id,class:_e(["grid-item cursor-pointer hover:border-blue-400",{empty:F.isEmpty,sold:!F.isEmpty}]),onClick:D=>re(F)},[f("div",AP,ne(F.id),1),f("div",xP,ne(F.isEmpty?"--":F.owner),1),!F.isEmpty&&F.price?(J(),ee("div",PP,ne(F.price),1)):Ae("",!0)],10,kP))),128))])],2))])):(J(),ee("div",sP,[...b[17]||(b[17]=[f("i",{class:"fa-solid fa-arrow-left"},null,-1),f("p",null,"",-1)])]))])])])]),(J(),Qn(Fc,{to:"body"},[c.value?(J(),ee("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-[10000]",onClick:hs(z,["self"])},[f("div",RP,[f("h3",NP,[b[30]||(b[30]=f("i",{class:"fa-solid fa-pen-to-square"},null,-1)),ke("  "+ne(u.value?.id),1)]),f("div",OP,[f("div",null,[b[31]||(b[31]=f("label",{class:"block text-slate-400 text-sm mb-1"},"",-1)),kn(f("input",{"onUpdate:modelValue":b[8]||(b[8]=F=>d.value.owner=F),type:"text",class:"w-full bg-[#0f172a] border border-slate-600 rounded p-2 text-white",placeholder:""},null,512),[[ss,d.value.owner]])]),f("div",null,[b[32]||(b[32]=f("label",{class:"block text-slate-400 text-sm mb-1"},"",-1)),kn(f("input",{"onUpdate:modelValue":b[9]||(b[9]=F=>d.value.price=F),type:"number",class:"w-full bg-[#0f172a] border border-slate-600 rounded p-2 text-white"},null,512),[[ss,d.value.price,void 0,{number:!0}]])])]),f("div",{class:"mt-6 flex gap-2 justify-end"},[f("button",{class:"btn btn-danger mr-auto",onClick:v},[...b[33]||(b[33]=[f("i",{class:"fa-solid fa-eraser"},null,-1),ke("  ",-1)])]),f("button",{class:"btn btn-outline",onClick:z},""),f("button",{class:"btn btn-success",onClick:R},[...b[34]||(b[34]=[f("i",{class:"fa-solid fa-save"},null,-1),ke("  ",-1)])])])])])):Ae("",!0)]))],64))}},MP=Ki(DP,[["__scopeId","data-v-d81895c4"]]),ks=j([]);function LP(){function t(s){const i=new Date().toLocaleTimeString("th-TH",{hour12:!1});ks.value.push({timestamp:i,...s}),ks.value.length>500&&ks.value.shift()}function e(){if(ks.value.length===0){alert(" No logs to download yet.");return}const i=`voice-logs-${new Date().toISOString().slice(0,10)}.json`,r=JSON.stringify(ks.value,null,2),o=new Blob([r],{type:"application/json"}),a=URL.createObjectURL(o),l=document.createElement("a");l.href=a,l.download=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)}function n(){ks.value=[]}return{logs:ks,logEvent:t,downloadLogs:e,clearLogs:n}}const Wt={ranges:{bust:{min:30,max:70},length:{min:15,max:60},id:{min:1,max:1e3}},patterns:{wordToDigit:[{from:/||/g,to:"100"},{from://g,to:"120"},{from://g,to:"150"},{from://g,to:"80"},{from://g,to:"60"},{from://g,to:"50"},{from://g,to:"40"},{from://g,to:"30"},{from://g,to:"20"}],anchors:{id:/(?:||||)\s*(\d+)/i,price:/(?:|||||)\s*(\d+)|(\d+)\s*(?:|.-)/i,freebie:/(?:|)/i}}};async function yf(t){return null}function $P(){const t=Hi(),e=Et(),{playSfx:n}=Zs(),{logEvent:s}=LP(),i=j(!1),r=j(""),o=j(""),a=j(!1),l=j("standby"),c=j(!1),u=j(" Auto Agent: Standby..."),d=j(!1);let h=null,p=0;const m=j(null);let w=null,C=null;if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const z=window.SpeechRecognition||window.webkitSpeechRecognition;C=new z,C.continuous=!0,C.lang="th-TH",C.onstart=()=>{i.value=!0,a.value=!1,l.value="listening",c.value?(p=0,C.interimResults=!0,d.value||(u.value=" Auto Agent: Listening...")):C.interimResults=!1},C.onend=()=>{if(i.value=!1,c.value)try{C.start()}catch{}else a.value?l.value="standby":setTimeout(()=>{try{C.start()}catch{}},500)},C.onresult=async R=>{if(c.value)A(R);else{const v=R.results[R.results.length-1][0].transcript.trim();await W(v)}},C.onerror=R=>{if(R.error==="aborted"){console.debug("[SpeechRecognition] Session recycled (aborted)");return}console.warn("Speech Recognition Error:",R.error),(R.error==="not-allowed"||R.error==="service-not-allowed")&&(i.value=!1,a.value=!0,c.value&&(c.value=!1,u.value=" Error: Mic not allowed"))}}else o.value=" Browser not supported",u.value=" Auto Agent: Not supported in this browser.";function A(z){if(!c.value||d.value)return;let R="";for(let T=p;T<z.results.length;++T)R+=z.results[T][0].transcript+" ";/|||/.test(R)&&(h&&clearTimeout(h),u.value=" Auto Agent: ...",h=setTimeout(async()=>{d.value=!0,u.value=" Auto Agent:  ...";let T="";for(let x=p;x<z.results.length;++x)T+=z.results[x][0].transcript+" ";p=z.results.length,T.length>400&&(T="..."+T.slice(-400));try{const x=await yf(T.trim());x&&x.id&&x.price?(await t.updateItemData(x.id,{price:x.price,size:x.size||null}),u.value=` Auto Agent:   ${x.id} ${x.price}`):u.value=" Auto Agent:  "}catch(x){console.error("Auto Agent Error:",x),u.value=" Auto Agent:  "}finally{d.value=!1,setTimeout(()=>{c.value&&!d.value&&(u.value=" Auto Agent: Listening...")},3e3)}},1500))}Ot(c,z=>{z?(C&&i.value&&(a.value=!0,C.stop()),setTimeout(()=>{a.value=!1,p=0;try{C?.start()}catch{}},300)):(C&&(a.value=!0,C.stop()),d.value=!1,h&&clearTimeout(h),u.value=" Auto Agent: Standby...")});async function W(z){l.value="processing",w&&(clearTimeout(w),w=null);let R=z;Wt.patterns.wordToDigit.forEach(te=>{R=R.replace(te.from,te.to)}),R=R.replace(/\s+/g," ").trim();let v=R,T={id:null,price:null,sizeParts:[],logic:"Unknown"};const x=v.match(/(?:||)\s*(?:|||-)?\s*(\d{2,3})/i);if(x){const te=parseInt(x[1]);te>=Wt.ranges.bust.min&&te<=Wt.ranges.bust.max&&(T.sizeParts.push(` ${te}`),v=v.replace(x[0],""))}const b=v.match(/(?:|)\s*(?:|||-)?\s*(\d{2})/i);if(b){const te=parseInt(b[1]);te>=Wt.ranges.length.min&&te<=Wt.ranges.length.max&&(T.sizeParts.push(` ${te}`),v=v.replace(b[0],""))}const F={:"S",:"M",:"L",:"L",:"XL",:"XL",:"2XL",:"2XL",:"2XL",:"3XL",:"3XL",:"3XL",:"4XL",:"4XL",:"Free Size",:"Oversize"},D=/(?:\s*)?(XXL|XL|L|M|S|XS|2XL|3XL|4XL|5XL||||||||||||||||)/i,G=v.match(D);if(G){let te=G[1];F[te]?te=F[te]:te=te.toUpperCase(),T.sizeParts.push(te),v=v.replace(G[0],"")}const O=v.match(/\b(|||||||||||)\b/i);if(O&&(T.sizeParts.push(O[1]),v=v.replace(O[0],"")),Wt.patterns.anchors.freebie.test(v))T.price=0,v=v.replace(Wt.patterns.anchors.freebie,"");else{const te=v.match(Wt.patterns.anchors.price);if(te){const S=parseInt(te[1]||te[2]);V(S)&&(T.price=S,v=v.replace(te[0],""))}}const U=v.match(Wt.patterns.anchors.id);if(U){const te=parseInt(U[1]);B(te)&&(T.id=te,v=v.replace(U[0],""),T.logic=T.price!==null?"Explicit-Both":"Explicit-ID")}const ce=[...v.matchAll(/\b(\d+)\b/g)].map(te=>parseInt(te[1]));if(ce.length>0){if(T.id===null&&T.price===null&&ce.length>=2){const[te,S]=ce;B(te)&&V(S)&&(T.id=te,T.price=S,T.logic="Implicit-Pair")}else if(T.id!==null&&T.price===null){const te=ce.filter(V);te.length>0&&(T.price=te[te.length-1],T.logic="Explicit-ID + Implicit-Price")}else if(T.price!==null&&T.id===null){const te=ce.filter(B);te.length>0&&(T.id=te[0],T.logic="Implicit-ID + Explicit-Price")}}if(T.id===null&&z.length>5&&e.isAiEnabled){w=setTimeout(async()=>{if(i.value){o.value=" ...";try{const te=await yf(z);if(te&&te.id!==null){T.id=typeof te.id=="string"?parseInt(te.id):te.id,te.price!==null&&te.price!==void 0&&(T.price=te.price),T.logic=`Cloud-API:${te.method}`,Z(z,R,T);return}o.value=" AI ",l.value="error",setTimeout(()=>{l.value=i.value?"listening":"standby"},1500)}catch(te){console.error("AI Fallback Error:",te),o.value=" AI ",l.value="error",setTimeout(()=>{l.value=i.value?"listening":"standby"},1500)}}},800);return}else if(T.id===null&&z.length>5&&!e.isAiEnabled){s({raw:z,cleaned:R,output:null,logic:"AI-Disabled",status:"IGNORED"});return}Z(z,R,T)}function B(z){return z>=Wt.ranges.id.min&&z<=Wt.ranges.id.max}function V(z){return z===0?!0:z<10||z>2e3?!1:!!(z%10===0||z%10===9||[55,65,85,95].includes(z))}function Z(z,R,v){const T=R.match(/(?:|||)\s*(?:)?\s*(\d+)/i);if(T){const x=parseInt(T[1]);if(t.stockData[x]){t.processCancel(x),o.value=`  #${x}`,n("ding"),s({raw:z,cleaned:R,output:{action:"CANCEL",id:x},logic:"Admin-Cancel",status:"MATCHED"});return}}if(v.id){if(v.id>t.stockSize||v.id<1){o.value=`  #${v.id}`,l.value="error",setTimeout(()=>{l.value=i.value?"listening":"standby"},1500);return}const x={};if(v.sizeParts&&v.sizeParts.length>0&&(x.size=v.sizeParts.join(" ")),v.price!==null&&(x.price=v.price),Object.keys(x).length>0){t.updateItemData(v.id,x),m.value=v.id;let b=` #${v.id}`;x.size&&(b+=` | ${x.size}`),x.price!==void 0&&(b+=` | ${x.price}.-`),o.value=b,r.value=R,n("ding"),s({raw:z,cleaned:R,output:{id:v.id,...x},logic:v.logic,status:"MATCHED"}),l.value="success",setTimeout(()=>{l.value=i.value?"listening":"standby"},1500)}else o.value=`  #${v.id}`,l.value=i.value?"listening":"standby"}}function re(){if(C){if(c.value){c.value=!1;return}if(i.value)a.value=!0,l.value="standby",C.stop();else{a.value=!1;try{C.start()}catch(z){console.error(z)}}}}return Ys(()=>{C&&(a.value=!0,c.value=!1,C.stop()),h&&clearTimeout(h),w&&clearTimeout(w)}),{isListening:i,transcript:r,lastAction:o,toggleMic:re,engineStatus:l,isAutoAgentEnabled:c,autoAgentStatus:u,isAutoAgentProcessing:d}}const FP={class:"voice-price-page"},BP={class:"header-bar"},UP={class:"left-info"},VP={class:"header-badges"},HP={class:"badge version"},WP={class:"center-controls"},jP={class:"right-info"},zP={class:"clock"},qP={class:"main-content"},KP={class:"card-grid"},GP={class:"col-item id-col"},YP={class:"col-item size-col"},QP={class:"col-item price-col"},XP={class:"visualizer-area"},JP={class:"mic-zone"},ZP={key:0,class:"auto-agent-bar"},eR={key:0,class:"hearing-status"},tR={class:"log-transcript"},nR={key:0,class:"mic-ripple"},sR={key:1,class:"mic-ripple delay"},iR={class:"mic-label"},rR={__name:"VoicePricePage",setup(t){const e=Et(),{isListening:n,transcript:s,lastAction:i,toggleMic:r,engineStatus:o,isAutoAgentEnabled:a,autoAgentStatus:l,isAutoAgentProcessing:c}=$P(),u=Ge(()=>{const O={standby:{icon:"fa-solid fa-bolt",text:"Smart Hunter V3"},listening:{icon:"fa-solid fa-headphones",text:"..."},processing:{icon:"fa-solid fa-magnifying-glass",text:"..."},success:{icon:"fa-solid fa-circle-check",text:""},error:{icon:"fa-solid fa-triangle-exclamation",text:""}};return O[o.value]||O.standby}),d=j(!1),h=j("");let p,m=null;const w=j({id:null,price:null,size:null}),C=j(!1),A=j(null);let W=null,B=null,V=null,Z=null,re=null,z=0;Ot(i,O=>{if(O&&O.startsWith("")){let U=null,ce=null,te=null;const S=O.match(/(?:#||)\s*(\d+)/);S&&(U=S[1]),O.split("|").slice(1).map(P=>P.trim()).forEach(P=>{P.endsWith(".-")?ce=P.replace(".-","").trim():te=P}),U&&(w.value={id:U,price:ce,size:te},C.value=!0,setTimeout(()=>C.value=!1,600))}}),Ot(n,O=>{O?R():v()});async function R(){if(!W&&A.value)try{B||(B=new(window.AudioContext||window.webkitAudioContext)),B.state==="suspended"&&await B.resume();const O=await navigator.mediaDevices.getUserMedia({audio:!0});V=B.createAnalyser(),V.fftSize=256,re=B.createMediaStreamSource(O),re.connect(V);const U=V.frequencyBinCount;Z=new Uint8Array(U),b(),x()}catch(O){console.error("Visualizer Error:",O)}}function v(){W&&(cancelAnimationFrame(W),W=null),re&&(re.disconnect(),re.mediaStream.getTracks().forEach(O=>O.stop()),re=null),A.value&&A.value.getContext("2d").clearRect(0,0,A.value.width,A.value.height)}function T(O,U,ce,te,S,y,P){O.beginPath(),O.strokeStyle=te,O.lineWidth=2.5,O.lineJoin="round",O.lineCap="round";for(let E=0;E<U;E++){const k=E,q=ce/2+Math.sin(E*y+z+S)*P*Math.sin(E/U*Math.PI);E===0?O.moveTo(k,q):O.lineTo(k,q)}O.stroke()}function x(){if(!A.value||!V)return;const O=A.value,U=O.getContext("2d"),ce=O.width,te=O.height;V.getByteFrequencyData(Z);let S=0;const y=Z.length;for(let oe=0;oe<y;oe++)S+=Z[oe];const P=S/y,E=5,k=P/255*100,q=E+k;U.clearRect(0,0,ce,te),T(U,ce,te,"rgba(34, 211, 238, 0.6)",0,.01,q),T(U,ce,te,"rgba(167, 139, 250, 0.5)",2,.015,q*.9),T(U,ce,te,"rgba(52, 211, 153, 0.5)",4,.008,q*.8),z+=.04,W=requestAnimationFrame(x)}function b(){if(A.value){const O=A.value.parentElement;A.value.width=O.clientWidth*window.devicePixelRatio,A.value.height=O.clientHeight*window.devicePixelRatio}}async function F(){try{"wakeLock"in navigator&&(m=await navigator.wakeLock.request("screen"))}catch(O){console.error(`WakeLock: ${O.name}`)}}async function D(){m!==null&&document.visibilityState==="visible"&&await F()}function G(){h.value=new Date().toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"})}return wn(()=>{G(),p=setInterval(G,1e3),F(),document.addEventListener("visibilitychange",D),window.addEventListener("resize",b),ns(()=>{b()});const O=pe(nw().db,".info/connected");pt(O,U=>d.value=U.val()===!0)}),Ys(()=>{v(),B&&B.close(),clearInterval(p),m!==null&&m.release().then(()=>m=null),document.removeEventListener("visibilitychange",D),window.removeEventListener("resize",b)}),(O,U)=>(J(),ee("div",FP,[f("header",BP,[f("div",UP,[U[2]||(U[2]=f("h1",{class:"page-title"}," ",-1)),f("div",VP,[f("span",{class:_e(["badge",{connected:d.value}])},ne(d.value?"ONLINE":"OFFLINE"),3),f("span",HP,ne(ie(e).version),1)])]),f("div",WP,[f("div",{class:_e(["agent-toggle",{active:ie(a),processing:ie(c)}]),onClick:U[0]||(U[0]=ce=>a.value=!ie(a))},[U[3]||(U[3]=f("i",{class:"fa-solid fa-robot"},null,-1)),U[4]||(U[4]=f("span",null,"Auto Agent",-1)),f("div",{class:_e(["toggle-dot",{on:ie(a)}])},null,2)],2)]),f("div",jP,[f("div",zP,ne(h.value),1)])]),f("main",qP,[f("div",{class:_e(["result-card",{flash:C.value}])},[f("div",KP,[f("div",GP,[U[5]||(U[5]=f("div",{class:"label"},"",-1)),f("div",{class:_e(["value",{"has-data":w.value.id}])},ne(w.value.id||""),3)]),f("div",YP,[U[6]||(U[6]=f("div",{class:"label"},"",-1)),f("div",{class:_e(["value",{"has-data":w.value.size}])},ne(w.value.size||""),3)]),f("div",QP,[U[7]||(U[7]=f("div",{class:"label"},"",-1)),f("div",{class:_e(["value",{"has-data":w.value.price}])},ne(w.value.price?`${w.value.price}`:""),3)])])],2),f("div",XP,[f("canvas",{ref_key:"canvasRef",ref:A,class:"wave-canvas"},null,512),f("div",JP,[et(Mp,{name:"fade"},{default:Fr(()=>[ie(a)?(J(),ee("div",ZP,[f("span",{class:_e(["agent-text",{pulsing:ie(c)}])},ne(ie(l)),3)])):Ae("",!0)]),_:1}),ie(a)?Ae("",!0):(J(),ee("div",eR,[f("div",{class:_e(["v3-badge",`status-${ie(o)}`])},[f("i",{class:_e([u.value.icon,"badge-icon"])},null,2),ke(" "+ne(u.value.text),1)],2),f("div",tR,'"'+ne(ie(s)||"...")+'"',1),f("div",{class:_e(["log-status",{error:ie(i)&&(ie(i).startsWith("")||ie(i).startsWith("")),success:ie(i)&&ie(i).startsWith("")}])},ne(ie(i)||"..."),3)])),f("button",{class:_e(["mic-btn",{active:ie(n),"agent-active":ie(a)&&ie(n)}]),onClick:U[1]||(U[1]=(...ce)=>ie(r)&&ie(r)(...ce))},[ie(n)?(J(),ee("span",nR)):Ae("",!0),ie(n)?(J(),ee("span",sR)):Ae("",!0),U[8]||(U[8]=f("i",{class:"fa-solid fa-microphone"},null,-1))],2),f("div",iR,ne(ie(a)?ie(n)?"Agent ...":" Agent":ie(n)?"...":""),1)])])])]))}},oR=Ki(rR,[["__scopeId","data-v-7b8e7324"]]),aR={class:"live-overlay-container"},lR={key:0,class:"overlay-grid"},cR={class:"col-item"},uR={class:"value-id"},dR={class:"col-item"},hR={class:"value-size"},fR={class:"col-item"},pR={class:"value-price"},mR={__name:"LiveOverlay",setup(t){const e=Et(),{db:n}=nw(),s=j({id:null,price:null,size:null});wn(()=>{const o=new URLSearchParams(window.location.search).get("vid")||e.currentVideoId;if(o)i(o);else{const a=pe(n,"system/activeVideo");pt(a,l=>{const c=l.val();c&&c!=="demo"&&i(c)})}});function i(r){const o=pe(n,`overlay/${r}/current_item`);pt(o,a=>{const l=a.val();l&&(s.value=l)})}return(r,o)=>(J(),ee("div",aR,[et(Mp,{name:"fade-slide"},{default:Fr(()=>[s.value.id?(J(),ee("div",lR,[f("div",cR,[o[0]||(o[0]=f("div",{class:"label"},"",-1)),f("div",uR,ne(s.value.id),1)]),f("div",dR,[o[1]||(o[1]=f("div",{class:"label"},"",-1)),f("div",hR,ne(s.value.size||"-"),1)]),f("div",fR,[o[2]||(o[2]=f("div",{class:"label"},"",-1)),f("div",pR,ne(s.value.price||"-"),1)])])):Ae("",!0)]),_:1})]))}},gR=Ki(mR,[["__scopeId","data-v-dfed0caf"]]),wR={class:"app-container"},vR={key:0,class:"away-banner"},_R={class:"away-content"},yR={class:"away-timer"},bR={class:"main-container"},CR={__name:"App",setup(t){const e=Et(),n=Hi();Jr();const s=YT();Ot(()=>e.isSoundOn,w=>{w||(console.log(" Sound turned OFF - Silencing immediately (App Singleton)."),oi.reset())});const i=new URLSearchParams(window.location.search),r=i.get("mode")==="voice",o=i.get("mode")==="overlay",{unlockAudio:a}=Zs(),{awayTimer:l,closeAwayMode:c,initAwayListener:u}=ZT(),{initAutoCleanup:d}=ek(),h=j(!1),p=j(!1);Wl("openDashboard",()=>h.value=!0),Wl("openHistory",()=>p.value=!0);async function m(){await a()&&(document.removeEventListener("click",m),document.removeEventListener("touchstart",m))}return wn(async()=>{console.log(" App mounted"),tk(),fetch("https://peng24-manowzab-price-detector.hf.space/health").then(D=>{if(D.ok)console.log("%c Hugging Face AI Connected","color: #34d399; font-size: 12px; font-weight: bold; padding: 2px 0;");else throw new Error(`Status: ${D.status}`)}).catch(()=>{console.log("%c Hugging Face AI Unreachable or Sleeping","color: #fbbf24; font-size: 12px; font-weight: bold; padding: 2px 0;")}),document.addEventListener("click",m),document.addEventListener("touchstart",m),document.addEventListener("keydown",m);const w=[];w.push(()=>{document.removeEventListener("click",m),document.removeEventListener("touchstart",m),document.removeEventListener("keydown",m)});const C=s.initNicknameListener();C&&w.push(C);const A=n.connectToStock("demo");A&&w.push(A);const W=u();W&&w.push(W),d().then(D=>{D&&w.push(D)});const B=e.initHostListener();B&&w.push(B),e.isConnected=!1,e.statusApi="idle",e.statusChat="idle";const V=j(!1),Z=j(!1);function re(){if(V.value&&Z.value){const D=pe(ge,`presence/${e.myDeviceId}`);hn(D,{online:!0,lastSeen:Date.now()}).catch(G=>console.error("Presence error:",G)),ES(D).remove(),console.log(" Presence setup complete")}}let z=!1;const R=pe(ge,".info/connected"),v=pt(R,D=>{D.val()===!0?(z=!0,e.statusDb="ok",V.value=!0,re()):(e.statusDb="err",V.value=!1,z||console.debug(" Connecting to Firebase..."))});w.push(v);const T=RI($u,D=>{Z.value=!!D,console.log(` Auth state changed: ${D?"authenticated":"not authenticated"}`),re()});w.push(T);const x=pt(pe(ge,"system/activeVideo"),D=>{const G=D.val();G&&G!=="demo"&&(e.currentVideoId=G,n.connectToStock(G))});w.push(x);const b=pt(pe(ge,"settings/"+e.currentVideoId+"/stockSize"),D=>{const G=D.val();G&&(n.stockSize=G)});w.push(b);const F=pt(pe(ge,"system/aiCommander"),D=>{const G=D.val();G&&typeof G=="object"&&G.enabled?e.isAiCommander=G.enabled===e.myDeviceId:G===e.myDeviceId?e.isAiCommander=!0:e.isAiCommander=!1});w.push(F),Ys(()=>{console.log(" Cleaning up App.vue listeners..."),w.forEach(D=>D&&D())})}),(w,C)=>(J(),ee("div",wR,[r?(J(),Qn(oR,{key:0})):o?(J(),Qn(gR,{key:1})):(J(),ee(Le,{key:2},[et(d2),ie(e).isAway?(J(),ee("div",vR,[f("div",_R,[C[4]||(C[4]=f("div",{class:"away-icon"},"",-1)),C[5]||(C[5]=f("div",{class:"away-text"},[f("div",{class:"away-title"},""),f("div",{class:"away-subtitle"},"   ")],-1)),f("span",yR,ne(ie(l)),1),f("button",{class:"away-btn",onClick:C[0]||(C[0]=(...A)=>ie(c)&&ie(c)(...A))},[...C[3]||(C[3]=[f("i",{class:"fa-solid fa-check"},null,-1),ke("  ",-1)])])])])):Ae("",!0),f("div",bR,[et(V2),et(lx),h.value?(J(),Qn(Vx,{key:0,onClose:C[1]||(C[1]=A=>h.value=!1)})):Ae("",!0),p.value?(J(),Qn(MP,{key:1,onClose:C[2]||(C[2]=A=>p.value=!1)})):Ae("",!0)])],64))]))}};function ER(t,e,n){console.group(" Global Error Handler"),console.error("Error:",t),console.error("Vue Info:",n),console.groupEnd();const s=t.message||"An unexpected error occurred.";ve.fire({icon:"error",title:"Error Occurred",text:s,toast:!0,position:"top-end",showConfirmButton:!1,timer:4e3,timerProgressBar:!0,didOpen:i=>{i.addEventListener("mouseenter",ve.stopTimer),i.addEventListener("mouseleave",ve.resumeTimer)}})}let Tc=!1;function Ni(){if(Tc)return;if("speechSynthesis"in window){const e=new SpeechSynthesisUtterance("");e.volume=0,window.speechSynthesis.speak(e)}const t=window.AudioContext||window.webkitAudioContext;if(t){const e=new t,n=e.createBufferSource();n.buffer=e.createBuffer(1,1,22050),n.connect(e.destination),n.start(0),e.state==="suspended"&&e.resume()}Tc=!0,document.removeEventListener("touchstart",Ni),document.removeEventListener("click",Ni),console.log(" iOS/iPad Audio System Unlocked successfully")}document.addEventListener("touchstart",Ni,{once:!0,passive:!0});document.addEventListener("click",Ni,{once:!0,passive:!0});document.addEventListener("visibilitychange",()=>{if(document.visibilityState==="visible"){const t=window.AudioContext||window.webkitAudioContext;t&&new t().state==="suspended"&&(Tc=!1,document.addEventListener("touchstart",Ni,{once:!0,passive:!0}),document.addEventListener("click",Ni,{once:!0,passive:!0}),console.warn(" AudioContext suspended on return. Awaiting user interaction to unlock."))}});const ed=Ay(CR);ed.use(Ry());ed.config.errorHandler=ER;window.addEventListener("unhandledrejection",t=>{sl.warn("Unhandled Promise Rejection:",t.reason)});sl.system("Booting Manowzab v4...");ed.mount("#app");sl.system("App initialized");export{ve as S,Jr as a,Et as b,YT as c,Zs as d,pe as e,ge as f,IR as g,Gt as h,sl as l,pt as o,yg as p,j as r,Hi as u,Ot as w};
